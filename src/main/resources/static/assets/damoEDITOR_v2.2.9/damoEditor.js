/**
 * damo EDITOR v2.2.8 (우 클릭)
 * Copyright (c) 2016, Damonet Inc. All rights reserved.
 */

var ReleaseVer="20201216028";var C_PX="px";var damoUtil={isChrome:/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),isEdge:window.navigator.userAgent.indexOf("Edge/")>0,detectIE:function(){var b=window.navigator.userAgent;if(b.indexOf("MSIE ")>0||b.indexOf("Trident/")>0||b.indexOf("Edge/")>0){return true}return false},getIEVersion:function(){var e=window.navigator.userAgent;var f=-1;if(e.indexOf("Edge/")>0){f=12}else{if(navigator.appName=="Microsoft Internet Explorer"){var d=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})");if(d.exec(e)!=null){f=parseFloat(RegExp.$1)}}else{if(navigator.appName=="Netscape"){var d=new RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})");if(d.exec(e)!=null){f=parseFloat(RegExp.$1)}}}}return f},isMobile:function(){if(/Android|webOS|iPhone|iPad|iPod|pocket|psp|kindle|avantgo|blazer|midori|Palm|maemo|plucker|phone|BlackBerry|symbian|IEMobile|mobile|ZuneWP7|Windows Phone|Opera Mini/i.test(navigator.userAgent)){return true}return false},isBootstrap:function(b){return this.getStyle(b,"box-sizing")==="border-box"},getElm:function(b){return document.getElementById(b)},createElement:function(j,o,l,h,m,n){var k=document.createElement(j);if(o){o.appendChild(k)}if(l){this.addClass(k,l)}if(h){this.addEvent(k,h,m,n)}return k},removeAllChild:function(b){while(b.firstChild){b.removeChild(b.firstChild)}},addEvent:function(h,f,g,e){if(h.addEventListener){h.addEventListener(f,g,false);if(e){h.addEventListener("mousedown",this.preventEvent,false)}}else{h.attachEvent("on"+f,g);if(e){h.attachEvent("onmousedown"+f,this.preventEvent)}}},removeEvent:function(d,e,f){if(d.removeEventListener){d.removeEventListener(e,f)}else{if(x.detachEvent){d.detachEvent("on"+e,f)}}},addEventByClass:function(j,g,h,k){var f=document.getElementsByClassName(j);if(f[0]){this.addEvent(f[0],g,h,k)}},preventEvent:function(c){var d=c||window.event;if(d.preventDefault&&d.stopPropagation){d.preventDefault();d.stopPropagation()}return false},hasClass:function(c,d){return c.className.indexOf(d)>0},addClass:function(c,d){if(!this.hasClass(c,d)){if(c.className!==""){c.className+=" "}c.className+=d}},toggleClass:function(c,d){if(this.hasClass(c,d)){this.removeClass(c,d)}else{this.addClass(c,d)}},removeClass:function(c,d){c.className=c.className.replace(d,"")},setStyle:function(g,h){var f=g.style;for(var e in h){f[e]=h[e]}},setStyleNremoveA:function(g,h){var f=g.style;for(var e in h){f[e]=h[e];g.removeAttribute(e)}},getStyle:function(c,d){if(document.defaultView&&document.defaultView.getComputedStyle){return document.defaultView.getComputedStyle(c,null).getPropertyValue(d)}else{if(c.currentStyle){return c.currentStyle[d]}}return null},getStyleI:function(c,d){return parseInt(this.getStyle(c,d))},getStyleF:function(c,d){return parseFloat(this.getStyle(c,d))},getStyleA:function(c,d){if(c.getAttribute(d)){return c.getAttribute(d)}if(c.style[d]){return c.style[d]}return this.getStyle(c,d)},getStyleAI:function(f,d){var e=this.getStyleA(f,d);if(e){return parseInt(e)}return""},setSelection:function(h,f,e,g){if(!h){return}if(window.getSelection){f.setStart(e,g);f.collapse(true);h.removeAllRanges();h.addRange(f)}else{f.select()}h=f=null},setSelection2:function(f,e,d){if(!e){return}if(window.getSelection){e.setStartBefore(d);e.setEndAfter(d);f.removeAllRanges();f.addRange(e)}else{e.select()}f=e=null},setSelectionControl:function(g){if(document.body.createControlRange){var e=document.body.createControlRange();e.add(g);e.select()}else{var h=this.getSelection();var f=this.getRange();f.collapsed=true;this.setSelection2(h,f,g)}},setSelectText:function(h,j,k,f){if(!k&&k!==0){k=0;if(j.data){f=j.data.length}}var g=document.createRange();g.setStart(j,k);g.setEnd(j,f);h.removeAllRanges();h.addRange(g)},getSelection:function(){return(window.getSelection)?window.getSelection():document.selection},getRange:function(){var c,d;if(window.getSelection){c=window.getSelection();if(c.getRangeAt&&c.rangeCount){d=c.getRangeAt(0);return d}}else{if(document.selection&&document.selection.type!=="Control"){return document.selection.createRange()}}},getRangeCreate:function(){var b=this.getRange();if(!b){b=document.createRange()}return b},getElementFromSibling:function(d){if(!d){return}if(d.collapsed){return d.startContainer}var c=d.startContainer;if(!c){return null}while(c&&c.nodeType===3){c=c.nextSibling}return c},getElementFromHierarchy:function(){var b=damoUtil.getRange();if(!b){return}if(b.collapsed){return b.startContainer}if(b.startContainer&&b.startContainer.firstChild){b=b.startContainer.firstChild}else{if(b.endContainer&&b.endContainer.firstChild){b=b.endContainer.firstChild}else{b=b.startContainer}}while(b&&b.nodeType===3){b=b.parentNode}return b},onlyNumber:function(f){var d=f||window.event;var e=window.event?d.keyCode:d.which;if((d.shiftKey===false)&&((e>47&&e<58)||(e>95&&e<106)||e===35||e===36||e===37||e===39||e===8||e===46||e===13)){return true}else{d.preventDefault()}},parseInt:function(b){if(!b){return 0}return parseInt(b)},loadScript:function(e,f){var d=document.createElement("script");d.type="text/javascript";if(f){if(d.readyState){d.onreadystatechange=function(){if(d.readyState=="loaded"||d.readyState=="complete"){d.onreadystatechange=null;f()}}}else{d.onload=function(){f()}}}d.src=damoScriptPath+e;if(document.head){document.head.appendChild(d)}else{document.getElementsByTagName("head")[0].appendChild(d)}return d},toArray:function(d){var f=d.length,e=new Array(f);while(f--){e[f]=d[f]}return e},getBlankChar:function(){var b="<BR/>";if(damoUtil.detectIE()&&damoUtil.getIEVersion()<11){b="&nbsp;"}return b},getElementPosition:function(g){var e=0;var f=0;var h="";while(g){h=damoUtil.getStyle(g,"position");if(h!=="static"){break}e+=g.offsetTop;f+=g.offsetLeft;g=g.offsetParent}return{top:e,left:f}},getElementPosition2:function(f){var d=0;var e=0;while(f){d+=f.offsetTop;e+=f.offsetLeft;f=f.offsetParent}return{top:d,left:e}},protectFromXSS:function(editor,xssOption){var tags=xssOption.removeTag.split(",");for(var i=0;i<tags.length;i++){var tagList=editor.getElementsByTagName(tags[i]);for(var j=0;j<tagList.length;j++){tagList[j].parentNode.removeChild(tagList[j])}}var eles=editor.getElementsByTagName("IMG");for(var i=0;i<eles.length;i++){eles[i].removeAttribute("onerror")}var html=editor.innerHTML;if(xssOption.removeEvent==="all"){html=html.replace(/<[^>]+/g,function(match){return match.replace(/ on\w+[= ]*["\'][^"]*["\']/g,"")})}else{if(xssOption.removeEvent!==""){var evlist=xssOption.removeEvent.split(",");for(var i=0;i<evlist.length;i++){html=html.replace(/<[^>]+/g,function(match){return match.replace(eval("/"+evlist[i]+'[= ]*["\'][^"]*["\']/gi'),"")})}}}editor.innerHTML=html},protectFromPrivacy:function(e){var g=[];var f=e.innerText;var h=f.match(editorConfig.privacy.pid);if(h){g.push(h)}h=f.match(editorConfig.privacy.tel);if(h){g.push(h)}h=f.match(editorConfig.privacy.mail);if(h){g.push(h)}this.removeFromPrivacy(e,g)},removeFromPrivacy:function(d,f){if(f.length===0){return true}var e=d.innerHTML;f.forEach(function(a){a.forEach(function(b){e=e.replace(b,"*".repeat(b.length))})});d.innerHTML=e},isFile:function(c){for(var d=0;d<c.length;d++){if(c[d].indexOf("Files")>-1){return true}}return false},getExtention:function(c){var d=c.lastIndexOf(".");if(d===-1){return""}return c.slice(d+1).toLowerCase()},isImage:function(b){return["png","jpg","jpeg","gif","bmp"].indexOf(b)>-1},removeLayoutCSS:function(b){b=b.replace(/[\r|\n|\t|\v|\f]/g,"");b=b.replace(/<\/p>/gi,"</p>\n");b=b.replace(/<\/(h[0-9]|div|ul|ol|li|tr|td)(\s[^\/]*)?>/gi,"$&\n");b=b.replace(/><p/gi,">\n<p");b=b.replace(/><div/gi,">\n<div");b=b.replace(/><li/gi,">\n<li");b=b.replace(/><ol/gi,">\n<ol");b=b.replace(/><ul/gi,">\n<ul");return b.replace(new RegExp("damoLayoutDot","g"),"")},inputCheck:function(d,c){if(d.value===""){alert(c);d.focus();return false}return true}};var rangeUtil={getAllTagList:function(p,a){if(!p){return[]}if(p.collapsed){var q=this.findTag(p.startContainer,a);return(q)?[q]:[]}var o=this.getAllNodeList(p);var k=[];for(var m=0;m<o.length;m++){var l=o[m];if(l.nodeName.match(a)){k.push(l)}else{var n=this.findTag(l,a);if(n){k.push(n)}}}return k},findTag:function(d,e){if(!d){return null}var f=d;while(f){if(f.className==="editor"){return null}if(f.nodeName.match(e)){return f}f=f.nextSibling}f=d;if(f.firstChild){f=f.firstChild}do{if(f.className==="editor"){return null}if(f&&f.nodeName&&f.nodeName.match(e)){return f}f=f.parentNode}while(f);return null},findTags:function(h,f){var g=h;var e=[];while(g){if(g.className==="editor"){return null}if(g.nodeName.match(f)){e.push(g)}g=g.nextSibling}if(e.length>0){return e}g=h;if(g.firstChild){g=g.firstChild}do{if(g.className==="editor"){return null}if(g&&g.nodeName&&g.nodeName.match(f)){return this.findTags(g,f)}g=g.parentNode}while(g);return null},findTagInPath:function(c,d){if(!c){return null}if(c.firstChild){c=c.firstChild}do{if(c.className==="editor"){return null}if(c&&c.nodeName&&c.nodeName.match(d)){return c}c=c.parentNode}while(c);return null},findTagInPathByClass:function(d,c){do{if(d.className===c){return d}d=d.parentNode}while(d);return null},findElementByTag:function(d){var c=damoUtil.getRange();return this.findTag(c.startContainer,d)},getSpanList:function(j){if(!j){return[]}if(j.collapsed){var n=document.createElement("SPAN");n.appendChild(j.extractContents());j.deleteContents();j.insertNode(n);return[n]}var q=this.getAllNodeList(j);var o=[];for(var p=0;p<q.length;p++){var m=q[p];if(!m||m.nodeType!==3||m.data===null){if(m.tagName==="SPAN"){o.push(m)}continue}if(m.data==="\n"||m.data==="\n"){continue}var k=m.parentNode;if(o.indexOf(k)>-1){continue}if(k.tagName==="SPAN"&k.innerHTML===m.data){o.push(k);continue}var n=document.createElement("SPAN");k.insertBefore(n,m);n.appendChild(m);o.push(n)}var l=damoUtil.getSelection();l.removeAllRanges();if(o.length>0){j.setStartBefore(o[0]);j.setEndAfter(o[o.length-1]);l.addRange(j)}return o},getAllNodeList:function(d){var c=this.startContainer(d);this.endNode=this.endContainer(d);if(!c||!this.endNode){return[]}if(c.nodeName==="SPAN"&this.endNode.nodeName==="#text"){if(c.innerHTML.indexOf(this.endNode.data)===0){return[this.endNode]}}this.nodeList=[];this.extractNodes(c);return this.nodeList},extractNodes:function(b){if(this.extractChildNodes(b)){return}while(!b.nextSibling){if(!(b=b.parentNode)){return}this.nodeList.push(b);if(b===this.endNode){return}}return this.extractNodes(b.nextSibling)},extractChildNodes:function(c){if(!c){return false}this.nodeList.push(c);var d=c.firstChild;while(d){if(d&c.innerHTML===d.data){d=d.nextSibling;continue}if(this.extractChildNodes(d)){return true}d=d.nextSibling}if(c===this.endNode){return true}return false},searchNext:function(b){if(!b||b.tagName==="BODY"){return document.body}if(b.nextSibling){return b.nextSibling}return this.searchNext(b.parentNode)},searchPrevious:function(b){if(!b||b.tagName==="BODY"){return document.body}if(b.previousSibling){return b.previousSibling}return this.searchPrevious(b.parentNode)},startContainer:function(d){if(!d){return null}if(d.startContainer.nodeType===3){if(d.startOffset<d.startContainer.nodeValue.length){var a=d.startContainer.splitText(d.startOffset);if(d.startContainer===d.endContainer){d.endOffset-=d.startOffset;d.endContainer=a}}if(d.startOffset>=d.startContainer.nodeValue.length){return this.searchNext(d.startContainer)}return d.startContainer}else{if(d.startOffset>=d.startContainer.childNodes.length){return this.searchNext(d.startContainer)}return this.childNodes2Array(d.startContainer)[d.startOffset]}},endContainer:function(b){if(b.endContainer.nodeType===3){if(b.endOffset<b.endContainer.nodeValue.length){b.endContainer.splitText(b.endOffset)}if(b.endOffset===0){return this.searchPrevious(b.endContainer)}return b.endContainer}else{if(b.endOffset===0){return this.searchPrevious(b.endContainer)}return this.childNodes2Array(b.endContainer)[b.endOffset-1]}},childNodes2Array:function(d){if(!d){return[]}var c=[];d=d.firstChild;while(d){c.push(d);d=d.nextSibling}return c},execCommand:function(j,k,m){var h=damoUtil.getRange();if((!h||h.collapsed)&&m.length>0){var l=damoUtil.getSelection();h=damoUtil.getRangeCreate();for(var g=0;g<m.length;g++){damoUtil.setSelection2(l,h,m[g]);document.execCommand(j,false,k)}h.collapse(false);l.removeAllRanges()}else{if((!h||h.collapsed)&&(j==="subscript"||j==="superscript")){return false}document.execCommand(j,false,k)}return true}};Function.prototype.closure=function(){var f=this,e=arguments[0],d=arguments[1];if(d){d=[d]}return function(){return f.apply(e,(d)?d:[e])}};Function.prototype.closureListener=function(){var e=this,d=damoUtil.toArray(arguments),f=d.shift();return function(b){b=b||window.event;if(b.target){var a=b.target}else{var a=b.srcElement}return e.apply(f,[b,a].concat(d))}};function damoFileUpload(k,j,h){var f=document.createElement("form");f.action=j;f.method="post";f.enctype="multipart/form-data";f.style.display="none";f.target="damoiframe";document.body.appendChild(f);f.appendChild(k);var g=document.createElement("iframe");g.src="javascript:false;";g.name="damoiframe";g.style.display="none";document.body.appendChild(g);g.onload=function(){var a=this.contentWindow?this.contentWindow.document:(this.contentDocument?this.contentDocument:this.document);var b=a.documentElement?a.documentElement:a.body;var c=b.textContent?b.textContent:b.innerText;h(c);document.body.removeChild(f);document.body.removeChild(g)};f.submit()}function damoFileUploadByAjax(g,m,j,h){var l=new FormData();l.append("damoImgFile",g.files[0]);var k=new XMLHttpRequest();k.open("POST",m,true);k.setRequestHeader("Cache-Control","no-cache");if(h){k.upload.onprogress=function(a){damoUtil.setStyle(h,{width:(a.loaded/a.total*100)+"%"})}}k.onload=function(b){var a=k.responseText;j(a.replace(/[\r\n]/g,""))};k.send(l)}function damoAjax(d){var e=null;if(window.XMLHttpRequest){e=new XMLHttpRequest()}else{if(window.ActiveXObject){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(f){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(f){}}}}if(!e){alert("Cannot create an XMLHTTP instance");return false}if(d.progress){e.upload.onprogress=d.progress}e.onreadystatechange=function(){if(e.readyState!==4){return}if(e.status===200){if(d.done){d.done(e.responseText)}}else{alert("There was a problem with the request.")}};e.open("POST",d.url);e.send(d.data)}var damoScriptPath=document.querySelector('script[src$="damoEditor.js"]').getAttribute("src");damoScriptPath=damoScriptPath.replace("damoEditor.js","");damoUtil.loadScript("ext/vanilla-picker.min.js");damoUtil.loadScript("config.js");var editorConfig={buttons:{},iconsize:24,filesize:20*1000*1000};editorConfig.buttons.newdoc={icon:1,command:null,title:"새문서",clickEvent:damoNewClick,shortcut:"N"};editorConfig.buttons.save={icon:2,command:null,title:"저장",clickEvent:damoSaveClick};editorConfig.buttons.saveMSWORD={icon:58,command:null,title:"MS-Word 저장",clickEvent:damoSaveMSWORDClick};editorConfig.buttons.print={icon:3,command:null,title:"출력",clickEvent:damoPrintClick,shortcut:"P"};editorConfig.buttons.undo={icon:4,command:"undo",title:"되돌리기"};editorConfig.buttons.redo={icon:5,command:"redo",title:"다시실행"};editorConfig.buttons.copy={icon:6,command:"copy",title:"복사하기"};editorConfig.buttons.cut={icon:7,command:"cut",title:"잘라내기"};editorConfig.buttons.paste={icon:8,command:"paste",title:"붙여넣기",clickEvent:damoPasteClick};editorConfig.buttons.hr={icon:13,command:"insertHorizontalRule",title:"수평선",dialogHandler:DamoDialogHorizon};editorConfig.buttons.bold={icon:14,command:"Bold",title:"굵게",tags:"^B$|STRONG",css:{"font-weight":"bold"},shortcut:"B"};editorConfig.buttons.italic={icon:16,command:"Italic",title:"기울임꼴",tags:"EM|^I$",css:{"font-style":"italic"},shortcut:"I"};editorConfig.buttons.underline={icon:15,command:"Underline",title:"하단선",tags:"^U$",css:{"text-decoration":"underline"},shortcut:"U"};editorConfig.buttons.strikethrough={icon:17,command:"strikeThrough",title:"중앙선",tags:"STRIKE",css:{"text-decoration":"line-through"}};editorConfig.buttons.subscript={icon:21,command:"subscript",title:"아래첨자",tags:"SUB"};editorConfig.buttons.superscript={icon:20,command:"superscript",title:"윗첨자",tags:"SUP"};editorConfig.buttons.left={icon:22,command:"justifyleft",title:"왼쪽 맞춤",group:"a",clickClass:damoAlignButtonEvent};editorConfig.buttons.center={icon:23,command:"justifycenter",title:"가운데 맞춤",group:"a",clickClass:damoAlignButtonEvent};editorConfig.buttons.right={icon:24,command:"justifyright",title:"오른쪽 맞춤",group:"a",clickClass:damoAlignButtonEvent};editorConfig.buttons.justify={icon:25,command:"justifyfull",title:"양쪽 맞춤",group:"a",clickClass:damoAlignButtonEvent};editorConfig.buttons.ol={icon:26,command:"insertorderedlist",title:"번호 매기기",tags:"OL",group:"b",clickClass:damoOrderButtonEvent};editorConfig.buttons.ul={icon:27,command:"insertunorderedlist",title:"글머리 기호",tags:"UL",group:"b",clickClass:damoOrderButtonEvent};editorConfig.buttons.outdent={icon:28,command:"outdent",title:"내어쓰기",clickEvent:damoOutdentClick};editorConfig.buttons.indent={icon:29,command:"indent",title:"들여쓰기",clickEvent:damoIndentClick,shortcut:"T"};editorConfig.buttons.removeformat={icon:30,command:"removeformat",title:"형식제거"};editorConfig.buttons.image={icon:9,command:"image",title:"이미지",dialogHandler:damoDialogImage};editorConfig.buttons.link={icon:10,command:"link",title:"링크",dialogHandler:damoDialogLink,shortcut:"L"};editorConfig.buttons.table={icon:11,command:"table",title:"테이블",clickClass:damoButtonTable};editorConfig.buttons.specialChar={icon:12,command:"sChar",title:"특수기호",dialogHandler:damoDialogChar};editorConfig.buttons.emoticon={icon:46,command:"emoticon",title:"이모티콘",dialogHandler:damoDialogEmoticon};editorConfig.buttons.emoji={icon:46,command:"emoji",title:"이모티콘",dialogHandler:damoDialogEmoji};editorConfig.buttons.find={icon:44,command:"find",title:"찾기&바꾸기",dialogHandler:damoDialogFind,shortcut:"F"};editorConfig.buttons.layout={icon:45,command:"layout",title:"레이아웃",dialogHandler:damoDialogLayout};editorConfig.buttons.forecolor={icon:18,command:"forecolor",title:"글자색",selectHandler:damoSelectBoxColor};editorConfig.buttons.backcolor={icon:19,command:"background-color",title:"글자배경색",selectHandler:damoSelectBoxColor};editorConfig.buttons.fontfamily={command:"fontname",title:"글꼴",selectHandler:damoSelectBoxFontname};editorConfig.buttons.fontsize={command:"fontsize",title:"글자크기",selectHandler:damoSelectBoxFontsize};editorConfig.buttons.fontformat={command:"formatBlock",title:"글자서식",selectHandler:damoSelectBoxFontformat};editorConfig.buttons.lineheight={icon:52,command:"lineheight",title:"줄간격",selectHandler:damoSelectButtonLineheight};editorConfig.buttons.bgcolor4td={icon:51,command:"bgcolor4td",title:"셀배경색",selectHandler:damoSelectBoxColor4td};editorConfig.buttons.documentBG={icon:53,command:null,title:"문서배경",dialogHandler:damoDialogDocument};editorConfig.buttons.externalMedia={icon:50,command:null,title:"외부동영상",dialogHandler:damoDialogExternalMedia};editorConfig.buttons.mediaFile={icon:55,command:null,title:"동영상파일",dialogHandler:damoDialogMedia};editorConfig.buttons.media={icon:50,command:null,title:"동영상",selectHandler:damoSelectBoxMedia};editorConfig.buttons.align={icon:22,command:null,title:"정렬",selectHandler:damoSelectBoxAlign};editorConfig.buttons.quotation={icon:59,command:"quotation",title:"인용",dialogHandler:DamoDialogQuotation};editorConfig.buttons.privacy={icon:61,command:"privacy",title:"개인정보보호",dialogHandler:damoDialogPrivacy};editorConfig.buttons.accessibility={icon:60,command:"accessibility",title:"웹접근성",dialogHandler:damoDialogAccessibility};editorConfig.buttons.editGroup={icon:14,command:null,title:"편집",selectHandler:damoSelectBox4Buttons};var DAMO_GAP="gap";var DAMO_BLANK="blank";var DAMO_BLANKSMALL="blankSmall";editorConfig.defaultButtons=["fontfamily","fontsize","fontformat","bold","italic","underline","strikethrough","removeformat","forecolor","backcolor","image","emoji","externalMedia","link","table","bgcolor4td","specialChar","hr","quotation","undo","redo","copy","cut","paste","find","ol","ul","subscript","superscript","indent","outdent","left","center","right","justify","lineheight","documentBG","layout","privacy","accessibility",{group:["newdoc","save","saveMSWORD","print"]}];editorConfig.defaultButtons1=["newdoc","save","print","undo","redo","copy","cut","paste","find","layout","image","link","table","specialChar","emoji","hr","left","center","right","justify","ol","ul","indent","outdent","<br>","fontsize","fontfamily","fontformat","lineheight","bold","italic","underline","strikethrough","subscript","superscript","removeformat","forecolor","backcolor"];editorConfig.defaultButtons2=[["fontfamily","fontsize","fontformat",DAMO_GAP,"undo","copy","paste",DAMO_GAP,"ul","ol","subscript","superscript","indent",DAMO_BLANKSMALL,"outdent",DAMO_BLANKSMALL,DAMO_GAP,"link","table","image","media",DAMO_GAP,"save","print"],[{group:["bold","italic","underline","strikethrough"]},{group:["removeformat","forecolor","backcolor"]},DAMO_GAP,"redo","cut","find",DAMO_GAP,"left","center","right","justify","lineheight","bgcolor4td",DAMO_GAP,"specialChar","hr","emoji","documentBG",DAMO_BLANKSMALL,DAMO_GAP,"newdoc","layout"]];editorConfig.mobileButtons=["fontfamily","fontsize","bold","italic","underline","strikethrough","removeformat","forecolor","backcolor","image","emoji"];editorConfig.xss={used:true,removeTag:"script,iframe,object,applet,embed,form",removeEvent:"all"};editorConfig.privacy={pid:/[0-9]{6}-?[012349][0-9]{6}/g,tel:/[\+]?[(]?[0-9]{2,3}[)]?[-\s\.]?[0-9]{3,4}[-\s\.]*[0-9]{4}/g,mail:/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi};var dContextMenu=null,damoTableEditor=null;var damoEditors={activeEditor:null,editors:[],addEditor:function(d,c){this.editors.push({editor:d,damo:c})},findEditor:function(f){var d=this.editors;for(var e=0;e<d.length;e++){if(d[e].editor===f){return d[e].damo}}},findDamoEditorInPath:function(c){var d=rangeUtil.findTagInPathByClass(c,"editor");if(!d||d.contentEditable==="inherit"){return null}return damoEditors.findEditor(d)}};var DAMO_Language=[];function DamoEditor(d,e){this.contentEditor=damoUtil.getElm(d);this.contentEditor.style.display="none";this.options=e||damoConfig||{};this.options.language=this.options.language||damoConfig.language||"ko";this.options.xss=this.options.xss||damoConfig.xss;this.options.fonts=this.options.fonts||damoConfig.fonts;this.options.useEditMode=this.options.useEditMode||damoConfig.useEditMode;this.options.filesize=this.options.filesize||damoConfig.filesize;this.options.uploadURL=this.options.uploadURL||damoConfig.uploadURL;this.options.buttons=this.options.buttons||damoConfig.buttons;if(this.options.xss.used===undefined){this.options.xss.used=editorConfig.xss.used}if(this.options.xss.removeTag===undefined){this.options.xss.removeTag=editorConfig.xss.removeTag}if(this.options.xss.removeEvent===undefined){this.options.xss.removeEvent=editorConfig.xss.removeEvent}if(this.options.privacy===undefined){this.options.privacy=false}if(this.options.filesize===undefined){this.options.filesize=editorConfig.filesize}if(this.options.setFocus===undefined){this.options.setFocus=damoConfig.setFocus}if(this.options.useMobile===undefined){this.options.useMobile=false}if(this.options.useContextMenu===undefined){this.options.useContextMenu=false}if(this.options.accessLevel===undefined){this.options.accessLevel=0}else{if(this.options.accessLevel===2){this.options.useEditMode=false}}this.range=null;this.damoEditor=damoUtil.createElement("div",null,"damoEditor");this.contentEditor.parentNode.insertBefore(this.damoEditor,this.contentEditor);this.toolbar=damoUtil.createElement("div",this.damoEditor,"toolbar","mousedown",damoUtil.preventEvent);this.editor=damoUtil.createElement("div",this.damoEditor,"editor");var f=this.contentEditor.value;if(f.trim()===""){this.clearDocument()}else{this.setHtmlContent(f)}this.editor.contentEditable=true;damoUtil.setStyle(this.damoEditor,{width:this.contentEditor.style.width||"100%"});damoUtil.setStyle(this.editor,{height:this.contentEditor.style.height||"350px"});damoEditors.addEditor(this.editor,this);damoUtil.loadScript("lang/"+this.options.language+".js",this.init.closure(this))}DamoEditor.prototype.init=function(){this.DamoMessage=DAMO_Language[this.options.language];var a=this.editor.getBoundingClientRect();this.position={left:a.left,top:a.top};var n=null,q=null;if((this.options.useMobile&&damoUtil.isMobile())||this.options.useMiniButton){n=editorConfig.mobileButtons}else{if(this.options.buttons){n=this.options.buttons}else{n=editorConfig.defaultButtons}}if(this.options.useEmoticon&&n.indexOf("emoji")>-1){var p=n.indexOf("emoji");n[p]="emoticon"}var s=new RegExp(DAMO_GAP+"|"+DAMO_BLANK+"|"+DAMO_BLANKSMALL);this.extendButton=[];this.tagButtonList=[];this.buttonList=[];this.shortcutList={};var m=null,o=null;this.makeButon=function(c,b){editorConfig.buttons[c].title=this.DamoMessage.buttons[c];if(editorConfig.buttons[c].selectHandler){q=new editorConfig.buttons[c].selectHandler().init(this,editorConfig.buttons[c]);if(b){q.changeToGroup()}}else{q=new DamoButton(this,editorConfig.buttons[c],b)}this.buttonList.push(q);if(editorConfig.buttons[c].tags){this.tagButtonList.push(q)}else{if(c==="undo"){m=q}else{if(c==="redo"){o=q}else{if(editorConfig.buttons[c].shortcut){this.shortcutList[editorConfig.buttons[c].shortcut.charCodeAt()]=q.button}}}}return q};var l=this.toolbar;this.makeButons=function(g){var h=damoUtil.createElement("div",l,"subbar");this.toolbar=h;for(var j in g){var d=g[j];if(d==="<br>"){damoUtil.createElement("br",this.toolbar);continue}if(s.test(d)){var e=damoUtil.createElement("div",this.toolbar,d);continue}if(typeof d!=="string"){var f=d.group;var e=damoUtil.createElement("div",this.toolbar);damoUtil.setStyle(e,{display:"inline-block"});for(var b in f){var c=this.makeButon(f[b],false);e.appendChild(c.button)}}else{this.makeButon(d)}}};this.makeButons(n);this.toolbar=l;this.morePn=damoUtil.createElement("div",this.toolbar,"morePn");var r=damoUtil.createElement("div",this.morePn,"moreBtn");this.overflowBar=damoUtil.createElement("div",this.morePn,"overflowBar");damoUtil.setStyle(this.overflowBar,{visibility:"hidden"});damoUtil.addEvent(r,"click",this.damoResizeMorebtnClick.closureListener(this));this.undoManager=new UndoManager(m,o,this);damoUtil.addEvent(this.editor,"mouseup",this.editorMousedown.closureListener(this));damoUtil.addEvent(this.editor,"keydown",this.editorKeydown.closureListener(this));damoUtil.addEvent(this.editor,"keyup",this.editorKeyup.closureListener(this));damoUtil.addEvent(this.editor,"blur",this.editorBlur.closure(this));damoUtil.addEvent(this.editor,"focus",this.editorFocus.closure(this));damoUtil.addEvent(this.editor,"paste",this.damoPasteEvent.closureListener(this));damoUtil.addEvent(this.editor,"drop",this.damoDropEvent.closureListener(this));damoUtil.addEvent(this.editor,"dragover",this.damoDragOver.closureListener(this));damoUtil.addEvent(this.editor,"dragend",this.damoDragEnd.closureListener(this));damoUtil.addEvent(window,"resize",this.damoResize.closureListener(this));if(this.options.useEditMode===undefined||this.options.useEditMode===true){this.setEditorMode()}if(!damoTableEditor){damoTableEditor=new TableEditor()}if(!dContextMenu&!this.options.useContextMenu){dContextMenu=new DamoContextMenu();dContextMenu.init(damoTableEditor)}damoUtil.addEvent(this.editor,"scroll",damoTableEditor.scrollEvent.closureListener(damoTableEditor));if(this.options.colors){this.setToolbarBgColor(this.toolbar,this.damoEditor);this.setToolbarBgColor(this.overflowBar,this.overflowBar)}this.damoResize();if(this.options.setFocus){this.editor.focus()}this.activateButton();return this};DamoEditor.prototype.setToolbarBgColor=function(c,d){damoUtil.setStyle(d,{"border-color":this.options.colors.editorBorder});damoUtil.setStyle(c,{"border-bottom-color":this.options.colors.editorBorder});damoUtil.setStyle(c,{background:this.options.colors.toolbarStart});damoUtil.setStyle(c,{background:"linear-gradient(to bottom, "+this.options.colors.toolbarStart+" 0%, "+this.options.colors.toolbarEnd+" 100%"});damoUtil.setStyle(c,{background:"-moz-linear-gradient(top, "+this.options.colors.toolbarStart+" 0%, "+this.options.colors.toolbarEnd+" 100%"});damoUtil.setStyle(c,{background:"-webkit-linear-gradient(top, "+this.options.colors.toolbarStart+" 0%, "+this.options.colors.toolbarEnd+" 100%"});damoUtil.setStyle(c,{filter:"progid:DXImageTransform.Microsoft.gradient( startColorstr='"+this.options.colors.toolbarStart+"', endColorstr='"+this.options.colors.toolbarEnd+"',GradientType=0 )"})};DamoEditor.prototype.damoResizeMorebtnClick=function(c){this.closePanels(this.overflowBar);function d(){damoUtil.setStyle(this.overflowBar,{visibility:"visible"})}if(damoUtil.getStyle(this.overflowBar,"visibility")==="hidden"){if(damoUtil.detectIE()){if(this.editor===document.activeElement){this.editor.blur()}setTimeout(d.closure(this),50)}else{damoUtil.setStyle(this.overflowBar,{visibility:"visible"})}}else{damoUtil.setStyle(this.overflowBar,{visibility:"hidden"})}};DamoEditor.prototype.damoResize=function(E){var t=this.toolbar.getElementsByClassName("subbar");var B=damoUtil.getStyleI(this.toolbar,"width");this.closePanels();while(this.overflowBar.lastChild){var C=this.overflowBar.lastChild;t[0].appendChild(C)}var v=30;if(B<600){v=10;damoUtil.setStyle(this.morePn,{"margin-top":"0"+C_PX,"margin-left":"-2"+C_PX})}else{damoUtil.setStyle(this.morePn,{"margin-top":"30"+C_PX,"margin-left":"-10"+C_PX})}var s=this.findSelectedExtendButton(damoSelectBoxFontname);var q=this.findSelectedExtendButton(damoSelectBoxFontformat);if(B<385){if(s){damoUtil.setStyle(s.button,{display:"none"})}if(q){damoUtil.setStyle(q.button,{display:"none"})}if(!this.editGroup){this.editGroup=new damoSelectBox4Buttons();this.editGroup.init(this,editorConfig.buttons.editGroup);var w=this.findSelectedButton("Bold");t[0].insertBefore(this.editGroup.button,w.button)}if(this.editGroup.isEmpty()){this.editGroup.addItem(this.findSelectedButton("Bold"));this.editGroup.addItem(this.findSelectedButton("Italic"));this.editGroup.addItem(this.findSelectedButton("Underline"));this.editGroup.addItem(this.findSelectedButton("strikeThrough"));this.editGroup.selectedItemEvent(0);damoUtil.setStyle(this.editGroup.button,{display:"inline-block"})}var r=t[0].childNodes;for(var y=r.length-1;y>8;y--){this.overflowBar.appendChild(r[y])}}else{if(s){damoUtil.setStyle(s.button,{display:"inline-block"})}if(q){damoUtil.setStyle(q.button,{display:"inline-block"})}if(this.editGroup&&!this.editGroup.isEmpty()){this.editGroup.itemMoveTo(t[0]);damoUtil.setStyle(this.editGroup.button,{display:"none"})}var F=t[0].firstChild.offsetTop;var z=null;while(z=t[0].lastChild){var u=z.offsetTop-F;if(u>v||z.className.indexOf("damoSelectBoxPanel")>-1){this.overflowBar.appendChild(z)}else{break}}}if(this.overflowBar.childNodes.length===1&&this.overflowBar.firstChild.className.indexOf("damoSelectBoxPanel")>-1){t[0].appendChild(this.overflowBar.firstChild)}var A=this.overflowBar.getElementsByClassName("damoButton").length+this.overflowBar.getElementsByClassName("damoSelectButton").length;var D=0;if(A>30){D=Math.ceil(A/2)*26}else{D=Math.ceil(A/2)*30}damoUtil.setStyle(this.overflowBar,{width:D+C_PX,left:(-D)+C_PX});if(B>384){damoUtil.setStyle(this.morePn,{display:this.overflowBar.firstChild?"inline-block":"none"})}else{damoUtil.setStyle(this.morePn,{display:"none"})}};DamoEditor.prototype.damoDragOver=function(b){if(b.dataTransfer.types&&damoUtil.isFile(b.dataTransfer.types)){b.preventDefault()}};DamoEditor.prototype.damoDropEvent=function(h){if(!h.dataTransfer.types||!damoUtil.isFile(h.dataTransfer.types)){return}var k=damoUtil.getRange();if(k.startContainer.className==="toolbar"){return}h.preventDefault();var j=[];if(h.dataTransfer.items){for(var f=0;f<h.dataTransfer.items.length;f++){if(h.dataTransfer.items[f].webkitGetAsEntry().isDirectory){return}if(h.dataTransfer.items[f].kind==="file"){var g=h.dataTransfer.items[f].getAsFile();if(damoUtil.isImage(damoUtil.getExtention(g.name))){j.push(g)}}}h.dataTransfer.items.clear()}else{for(var f=0;f<h.dataTransfer.files.length;f++){var g=h.dataTransfer.files[f];if(damoUtil.isImage(damoUtil.getExtention(g.name))){j.push(g)}}h.dataTransfer.clearData()}if(j.length>0){this.sendFiles(j)}};DamoEditor.prototype.damoDragEnd=function(b){setTimeout(this.undoManager.record.closure(this.undoManager),10)};DamoEditor.prototype.setEditorMode=function(){this.modeTabs=new DamoEditorMode(this)};DamoEditor.prototype.getClipboardData=function(c){var d=null;if(c.originalEvent){d=c.originalEvent}if(window.clipboardData){d=window.clipboardData}else{d=c.clipboardData}return d};DamoEditor.prototype.damoPasteEvent=function(z){if(this.options.accessLevel===2){if(z.preventDefault&&z.stopPropagation){z.preventDefault();z.stopPropagation()}alert(this.DamoMessage.msg.accessibilityLevel);return}var q=this.getClipboardData(z);var s=this;if(!q.types){return false}var o=new RegExp(/<(TABLE)[^>]*>/,"i");var u=q.getData("text/html");var r=q.types;if((r.contains&&r.contains("text/html"))||(r.indexOf&&r.indexOf("text/html")>-1)){if(o.test(u)){if(damoUtil.isEdge){return true}var n=document.createElement("DIV");var p=u.match(/<body[^>]*>([\w|\W]*)<\/body>/im);if(p){u=p[0]}n.innerHTML=u;var v=damoUtil.getRange();if(!v.isCollapsed){v.deleteContents()}for(var w=n.childNodes.length-1;w>-1;w--){var y=n.childNodes[w];if(y.nodeName==="META"||y.nodeName==="LINK"||y.nodeName==="STYLE"||y.nodeName==="#comment"){continue}if(y.nodeName==="TABLE"&&!damoUtil.detectIE()){y.border=1}v.insertNode(y)}}else{if(q.getData("text/plain")===""){z.preventDefault();return}return true;var n=document.createElement("DIV");n.innerHTML=u;var v=damoUtil.getRange();if(!v.isCollapsed){v.deleteContents()}for(var w=n.childNodes.length-1;w>-1;w--){var y=n.childNodes[w];if(y.nodeName==="META"||y.nodeName==="LINK"||y.nodeName==="STYLE"||y.nodeName==="#comment"){continue}if(y.nodeName==="P"){if(y.style.fontFamily===""){y.style.fontFamily="맑은 고딕"}}v.insertNode(y)}}z.preventDefault();return false}if((r.contains&&r.contains("Files"))||(r.indexOf&&r.indexOf("Files")>-1)){var t=q.items;if(t.length>0){for(var w=0;w<t.length;w++){if(t[w].type.indexOf("image")!==-1){this.sendFile(s,null,t[w].getAsFile())}}}z.preventDefault();return false}return true};DamoEditor.prototype.sendFiles=function(c){this.showProgress();this.fileCount=c.length;for(var d=0;d<c.length;d++){this.sendFile(this,null,c[d])}};DamoEditor.prototype.sendFile=function(o,m,p){if(p===null){return}this.focus();var q=damoUtil.getRange();var n=new FormData();n.append("damoImgFile",p,"damoImgFile");var l=this;damoAjax({url:o.options.uploadURL,data:n,progress:k,done:j});function j(b){l.fileCount--;if(l.fileCount===0){l.closeProgress()}var a=damoUtil.createElement("IMG");a.setAttribute("src",b);damoUtil.setStyle(a,{"max-width":"95%"});q.insertNode(a);q=null}function k(a){damoUtil.setStyle(l.progressbar,{width:(a.loaded/a.total*100)+"%"})}};DamoEditor.prototype.showProgress=function(){this.damoDialog=damoUtil.createElement("div",document.body,"damoDialog");this.dialog=damoUtil.createElement("div",this.damoDialog,"dialog damoDialogMain");var l=damoUtil.getElementPosition2(this.editor);var m=300;var k=(l.left-(document.documentElement.scrollLeft||document.body.scrollLeft))+(damoUtil.getStyleI(this.editor,"width")-m)/2;var n=l.top-(document.documentElement.scrollTop||document.body.scrollTop);var o=damoUtil.getStyleI(this.editor,"height");var q=200;n-=(q-o)/2;if(n<0){n=100}damoUtil.setStyle(this.dialog,{width:m+C_PX,top:n+C_PX,left:k+C_PX});var j=damoUtil.createElement("div",this.dialog,"progressbar");var p=damoUtil.createElement("div",j);p.innerHTML="파일 전송 중";this.progressbar=damoUtil.createElement("div",j,"progressbar4Video");damoUtil.setStyle(this.progressbar,{width:"0%"})};DamoEditor.prototype.closeProgress=function(){this.damoDialog.parentNode.removeChild(this.damoDialog);this.editor.focus();this.progressbar=null};DamoEditor.prototype.editorBlur=function(){this.closePanels()};DamoEditor.prototype.editorFocus=function(){damoEditors.activeEditor=this};DamoEditor.prototype.saveRange=function(){this.range=damoUtil.getRange()};DamoEditor.prototype.restoreRange=function(){if(!this.range||this.range.collapse){return}var b=damoUtil.getSelection();b.removeAllRanges();b.addRange(this.range);this.focus()};DamoEditor.prototype.focus=function(){if(!this.editor.focued){this.editor.focus()}};DamoEditor.prototype.editorMousedown=function(b){if(b.target.nodeName==="IMG"){this.buttonsDisable(true,"undo,redo,copy,cut,paste,image,justifyleft,justifycenter,justifyright,justifyfull");this.activateButton(b.target)}else{this.buttonsDisable(false,"bgcolor4td");this.activateButton()}};DamoEditor.prototype.editorKeydown=function(c){if(c.keyCode===46&this.activeElement!==null&this.activeElement.nodeName==="IMG"){this.removeElement();this.buttonsDisable(false,"bgcolor4td");this.activateButton();damoUtil.preventEvent(c);return}if(!c.ctrlKey||c.keyCode===17){return}var d=this.shortcutList[c.keyCode];if(d){d.click(this);damoUtil.preventEvent(c)}};DamoEditor.prototype.editorKeyup=function(b){if((b.keyCode<33||b.keyCode>46)&b.keyCode!==13){return}this.activateButton()};DamoEditor.prototype.executeClick=function(f){for(var d=0;d<this.buttonList.length;d++){var e=this.buttonList[d];if(e.command===f){e.button.click(this);return}}};DamoEditor.prototype.removeElement=function(){damoTableEditor.ribbonMgr.deActivate();this.activeElement.parentNode.removeChild(this.activeElement);this.activeElement=null;this.editor.focus()};DamoEditor.prototype.activateButton=function(src){if(!src){src=damoUtil.getElementFromHierarchy()}if(!src){return}this.activeElement=src;this.saveRange();this.closePanels();this.buttonUnSelect();var fontSize=null,fontFamily=null,fontformat=null,textAlign=null,lineheight=null;while(src&&src!==this.editor){for(var inx in this.tagButtonList){var button=this.tagButtonList[inx];if(src.nodeName.match(eval("/"+button.tags+"/"))){damoUtil.addClass(button.button,"buttonSelect");break}else{if(fontformat===null&"H1,H2,H3,H4,H5,H6".indexOf(src.nodeName)>-1){fontformat=src.nodeName;if(textAlign===null){textAlign=src.align}if(lineheight===null){lineheight=this.getLineheight(src,"line-height")}}}}if(src.nodeType!==3){if(fontSize===null&&src.style.fontSize!==null){fontSize=this.getFontStyle(src,"font-size")}if(fontFamily===null&&src.style.fontFamily!==null){fontFamily=this.getFontStyle(src,"font-family")}if(lineheight===null&&src.style.lineHeight!==null){lineheight=this.getLineheight(src,"line-height")}if(textAlign===null&&"PDIV".indexOf(src.nodeName)>-1){textAlign=src.style.textAlign}}if(lineheight===null&&src.nodeName==="P"){lineheight=this.getLineheight(src,"line-height")}src=src.parentNode}this.selectedExtendButton(damoSelectBoxFontsize,fontSize?fontSize:this.getFontStyle(src,"font-size"));this.selectedExtendButton(damoSelectBoxFontname,fontFamily?fontFamily:this.getFontStyle(src,"font-family"));this.selectedExtendButton(damoSelectBoxFontformat,fontformat);this.selectedAlignButton(textAlign)};DamoEditor.prototype.getFontStyle=function(f,d){var e=null;e=damoUtil.getStyle(f,d).replace('"',"");if(e.indexOf(C_PX)>-1){e=Math.ceil(parseInt(e)*3/4)+"pt"}else{if(e.indexOf("em")>-1){e=Math.ceil(parseInt(e)*12)+"pt"}}return e};DamoEditor.prototype.getLineheight=function(h,k){var f=damoUtil.getStyle(h,k);if(!f){return null}var g=parseFloat(f);if(!g){return"120%"}if(f.indexOf(C_PX)>-1){var j=damoUtil.getStyle(h,"font-size");f=(Math.round(g/parseFloat(j)*10)*10)+"%"}else{f=g}return f};DamoEditor.prototype.selectedExtendButton=function(e,f){for(var d in this.extendButton){if(this.extendButton[d] instanceof e){this.extendButton[d].setTitle(f)}}};DamoEditor.prototype.findSelectedExtendButton=function(d){for(var c in this.extendButton){if(this.extendButton[c] instanceof d){return this.extendButton[c]}}return null};DamoEditor.prototype.findSelectedButton=function(d){for(var c in this.buttonList){if(this.buttonList[c].command===d){return this.buttonList[c]}}return null};DamoEditor.prototype.selectedAlignButton=function(d){if(!this.toggleBtns){return}if(d==="justify"){d="full"}var e=this.toggleBtns.a;for(var f in e){if(e[f].command.indexOf(d)>0){damoUtil.addClass(e[f].button,"buttonSelect")}else{damoUtil.removeClass(e[f].button,"buttonSelect")}}};DamoEditor.prototype.closePanels=function(e){var f=document.getElementsByClassName("damoSelectBoxPanel");for(var d=0;d<f.length;d++){f[d].style.display="none"}if(e!==this.overflowBar){damoUtil.setStyle(this.overflowBar,{visibility:"hidden"})}};DamoEditor.prototype.buttonUnSelect=function(){for(var b in this.tagButtonList){damoUtil.removeClass(this.tagButtonList[b].button,"buttonSelect")}};DamoEditor.prototype.getLength=function(){if(!this.modeTabs){return this.editor.innerHTML.length}var b=this.modeTabs.activetab.id;if(b==="design"){return this.editor.innerHTML.length}else{if(b==="preview"){return this.modeTabs.preview.innerHTML.length}else{return this.modeTabs.editorETC.value.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"").length}}};DamoEditor.prototype.saveContents=function(){this.contentEditor.value=this.getContents()};DamoEditor.prototype.getContents=function(){var d;if(this.modeTabs){var c=this.modeTabs.activetab.id;if(c=="html"){d=this.modeTabs.editorETC.value;this.editor.innerHTML=d}else{if(c=="text"){d=this.modeTabs.Text2HTML(this.modeTabs.editorETC.value);this.editor.innerHTML=d}else{if(c=="preview"){d=this.modeTabs.preview.innerHTML;this.editor.innerHTML=d}else{d=this.editor.innerHTML}}}}else{d=this.editor.innerHTML}if(this.options.xss.used){damoUtil.protectFromXSS(this.editor,this.options.xss)}if(this.options.privacy){damoUtil.protectFromPrivacy(this.editor)}return damoUtil.removeLayoutCSS(this.editor.innerHTML)};DamoEditor.prototype.checkPrivacyViolation=function(){var d=this.editor.innerText;var c=d.match(editorConfig.privacy.pid);if(c){return true}c=d.match(editorConfig.privacy.tel);if(c){return true}c=d.match(editorConfig.privacy.mail);if(c){return true}return false};DamoEditor.prototype.checkAccessibility=function(){var p=0;var k=this.editor.querySelectorAll("input[type=image], img, area");for(p=0;p<k.length;p++){if(k[p].getAttribute("alt")===null){return true}}var l=["a","frame","iframe","framese"];var j=this.editor.querySelectorAll("a, frame, iframe, framese");for(p=0;p<j.length;p++){if(!j[p].title){return true}}j=document.querySelectorAll("*");for(p=0;p<j.length;p++){var m=j[p];if(typeof m.onfocus==="function"){return true}}var q=this.editor.querySelectorAll("table");for(p=0;p<q.length;p++){if(!q[p].summary||!q[p].caption){return true}}var n=[];var o=this.editor.querySelectorAll('*[id]:not([id=""])');for(p=0;p<o.length;p++){if(n.includes(o[p].id)){return true}else{n.push(o[p].id)}}return false};DamoEditor.prototype.clearDocument=function(){this.editor.innerHTML="<p>"+damoUtil.getBlankChar()+"</p>";var b=damoUtil.getStyle(this.editor,"background-image");damoUtil.setStyle(this.editor,{"background-color":"transparent","background-image":"none"});if(b!=="none"){damoUtil.setStyle(this.editor,{"background-attachment":"","background-repeat":"","background-position":""})}};DamoEditor.prototype.buttonsDisable=function(g,h){var j=this.buttonList;if(g){for(var k in j){var a=j[k];this.buttonDisable(a,!(h&&h.indexOf(a.command)>-1))}}else{for(var k in j){var a=j[k];this.buttonDisable(a,h&&h.indexOf(a.command)>-1)}}this.undoManager.changed(this.undoManager)};DamoEditor.prototype.buttonDisable=function(d,c){if(c){d.button.setAttribute("disabled",c);damoUtil.addClass(d.button,"buttonDisable")}else{d.button.removeAttribute("disabled");damoUtil.removeClass(d.button,"buttonDisable")}};DamoEditor.prototype.undoRecord=function(){this.undoManager.record()};DamoEditor.prototype.setHtmlContent=function(f){if(f.trim()===""){f="<p>"+damoUtil.getBlankChar()+"</p>"}this.editor.innerHTML=f;this.setEditorProperty(this.editor);if(this.options.xss.used){damoUtil.protectFromXSS(this.editor,this.options.xss)}if(this.options.privacy){damoUtil.protectFromPrivacy(this.editor)}var e=document.getElementsByClassName("damoLayoutInput");for(var d=0;d<e.length;d++){damoUtil.addClass(e[d],"damoLayoutDot")}};DamoEditor.prototype.setEditorProperty=function(e){var h=e.querySelector("#damoEditorBack");if(!h){damoUtil.setStyle(e,{"background-color":"transparent","background-image":"none"});return}var g=null;while(g=h.firstChild){e.appendChild(g)}damoUtil.setStyle(e,{"background-color":damoUtil.getStyleA(h,"background-color")});var f=damoUtil.getStyle(h,"background-image");if(f!=="none"){damoUtil.setStyle(e,{"background-image":f,"background-attachment":damoUtil.getStyle(h,"background-attachment"),"background-repeat":damoUtil.getStyle(h,"background-repeat"),"background-position":damoUtil.getStyle(h,"background-position-x")+" "+damoUtil.getStyle(h,"background-position-y")})}e.removeChild(h)};DamoEditor.prototype.getEditorContent=function(e){var h=damoUtil.getStyleA(e,"background-color");var f=damoUtil.getStyle(e,"background-image");if(h==="transparent"&&f==="none"){return e.innerHTML}var g="<div id='damoEditorBack' style='width:100%;";if(h!=="transparent"){g+="background-color:"+h+";"}if(f!=="none"){g+="background-image:"+f+"; background-attachment:"+damoUtil.getStyle(e,"background-attachment")+";background-repeat:"+damoUtil.getStyle(e,"background-repeat")+";background-position:"+damoUtil.getStyle(e,"background-position-x")+" "+damoUtil.getStyle(e,"background-position-y")}return g+"'>"+e.innerHTML+"</div>"};function DamoEditorMode(j){this.parent=j;this.editor=j.editor;this.editorETC=damoUtil.createElement("textarea",j.damoEditor,"editor");var k=parseInt(damoUtil.getStyle(this.editor,"height"));damoUtil.setStyle(this.editorETC,{display:"none",height:k+parseInt(damoUtil.getStyle(this.editor,"padding-top"))*2+C_PX,width:"100%",padding:"0px"});this.preview=damoUtil.createElement("div",j.damoEditor,"editor");damoUtil.setStyle(this.preview,{display:"none",height:k+C_PX});var h=damoUtil.createElement("div",j.damoEditor,"damoEditorBottom");this.editorView={design:this.editor,html:this.editorETC,text:this.editorETC,preview:this.preview};var l=["design","html","text","preview"];for(var g=0;g<l.length;g++){var m=damoUtil.createElement("div",h,"damoEditorBottomTab");m.innerText=this.parent.DamoMessage.editorMode[l[g]];m.id=l[g];damoUtil.addEvent(m,"click",this.damoEditorBottomTabChange.closure(this,m));if(g===0){this.damoEditorBottomTabChange(m)}if(j.options.colors){damoUtil.setStyle(m,{background:j.options.colors.bottom})}}if(j.options.colors){damoUtil.setStyle(h,{background:j.options.colors.bottom,"border-top-color":j.options.colors.bottomTop})}this.resizing=false;this.resizer=damoUtil.createElement("div",h,"damoEditorResizer");this.resizer.innerHTML=this.parent.DamoMessage.editorMode.resizer;damoUtil.addEvent(this.resizer,"mousedown",this.resizerMousedown.closureListener(this),true);damoUtil.addEvent(window,"mousemove",this.resizerMousemove.closureListener(this));damoUtil.addEvent(window,"mouseup",this.resizerMouseup.closureListener(this));return this}DamoEditorMode.prototype.resizerMousedown=function(b){this.resizing=true;this.stY=b.pageY};DamoEditorMode.prototype.resizerMouseup=function(b){this.resizing=false};DamoEditorMode.prototype.resizerMousemove=function(g){if(!this.resizing){return}var f=g.pageY-this.stY;var h=damoUtil.getStyleI(this.editor,"height");if(f+h<150){return}var e=damoUtil.getStyleI(this.editorETC,"height");damoUtil.setStyle(this.editor,{height:(h+f)+C_PX});damoUtil.setStyle(this.editorETC,{height:(e+f)+C_PX});damoUtil.setStyle(this.preview,{height:(h+f)+C_PX});this.stY=g.pageY};DamoEditorMode.prototype.damoEditorBottomTabChange=function(c){if(this.activetab===c){return}if(c.id==="text"){if(!confirm(this.parent.DamoMessage.editorMode.msg.textMode)){return}}if(this.activetab){damoUtil.removeClass(this.activetab,"damoEditorBottomTabActive")}damoUtil.addClass(c,"damoEditorBottomTabActive");if(!this.activetab){this.activetab=c;return}this.damoEditorBottomTabDisplay(this.editorView[this.activetab.id],this.editorView[c.id]);if(this.activetab.id==="preview"){this.activetab=this.activetab4preview}this.parent.buttonsDisable(c.id!=="design");if(this.activetab===c){return}if(c.id==="design"){var d="";if(this.activetab.id==="html"){d=this.editorETC.value}else{d=this.Text2HTML(this.editorETC.value)}this.parent.setHtmlContent(d);this.editorETC.value="";this.preview.innerHTML=""}else{if(c.id==="preview"){if(this.activetab.id==="design"){this.preview.innerHTML=damoUtil.removeLayoutCSS(this.parent.getEditorContent(this.editor))}else{if(this.activetab.id==="html"){this.preview.innerHTML=this.editorETC.value}else{this.preview.innerHTML=this.Text2HTML(this.editorETC.value)}}this.activetab4preview=this.activetab}else{if(c.id==="html"){if(this.activetab.id==="design"){this.editorETC.value=damoUtil.removeLayoutCSS(this.parent.getEditorContent(this.editor))}else{this.editorETC.value=this.Text2HTML(this.editorETC.value)}}else{if(this.activetab.id==="design"){this.editorETC.value=this.HTML2Text(this.parent.getEditorContent(this.editor))}else{this.editorETC.value=this.HTML2Text(this.editorETC.value)}}}}this.activetab=c};DamoEditorMode.prototype.damoEditorBottomTabDisplay=function(d,c){if(d){damoUtil.setStyle(d,{display:"none"})}damoUtil.setStyle(c,{display:""});c.focus()};DamoEditorMode.prototype.Text2HTML=function(j){var k="";var h=j.split("\n");var m="<BR>";if(damoUtil.detectIE()){m="&nbsp;"}for(var g=0;g<h.length;g++){var l=h[g].replace(/[\r|\n]/g,"");if(l===null||l===""){l=m}k=k+"<p>"+l+"</p>\n"}return k};DamoEditorMode.prototype.HTML2Text=function(b){b=b.replace(/[\r|\n|\t|\v|\f]/g,"");b=b.replace(/<p><br><\/p>|<P>&nbsp;<\/P>/gi,"\n");b=b.replace(/<br(\s)*\/?>|<br(\s[^\/]*)?>|<\/p(\s[^\/]*)?>/gi,"\n");b=b.replace(/<\/li(\s[^\/]*)?>|<\/tr(\s[^\/]*)?>/gi,"\n");b=this.strip_tags(b,false);b=b.replace(/[\n]*$/g,"");b=b.replace(new RegExp("damoLayoutDot","g"),"");return b};DamoEditorMode.prototype.strip_tags=function(f,h){h=(((h||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var e=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi;var g=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return f.replace(g,"").replace(e,function(a,b){return h.indexOf("<"+b.toLowerCase()+">")>-1?a:""})};function DamoButton(k,l,m){this.command=l.command;this.tags=l.tags;this.editor=k;var j=damoUtil.createElement("button",k.toolbar,"damoButton");j.setAttribute("type","button");if(m){damoUtil.addClass(j,"groupButton")}damoUtil.setStyle(j,{backgroundPosition:(l.icon*-editorConfig.iconsize)+"px 0px"});j.title=l.title;if(l.dialogHandler){var g=new l.dialogHandler().init(k);damoUtil.addEvent(j,"click",g.open.closure(g),true)}else{if(l.clickClass){var h=new l.clickClass();h=h.init(k,l,this);damoUtil.addEvent(j,"click",h.buttonClick.closure(h,this),true)}else{if(l.clickEvent){damoUtil.addEvent(j,"click",l.clickEvent.closureListener(this),true)}else{if(l.command!=="undo"&&l.command!=="redo"){damoUtil.addEvent(j,"click",this.buttonClick.closure(this),true)}}}}damoUtil.addEvent(j,"mousedown",k.restoreRange.closure(k),false);this.button=j;return this}DamoButton.prototype.buttonClick=function(){if(this.command==="insertHorizontalRule"){var k=damoUtil.getRange();var a=k.startContainer;var g=k.startOffset;var j=document.createElement("HR");j.style.height="1px";k.deleteContents();k.insertNode(j);this.editor.focus();damoUtil.setSelection(damoUtil.getSelection(),k,a,g)}else{if(!rangeUtil.execCommand(this.command,null,damoTableEditor.selectList)){return}}this.editor.undoRecord();var h=damoUtil.getElementFromSibling(damoUtil.getRange());if(!h){return}while(h.firstChild){h=h.firstChild}this.editor.activateButton(h)};DamoButton.prototype.buttonsDisable=function(){damoUtil.toggleClass(this.button,"buttonDisable")};function damoNewClick(){if(!confirm(this.editor.DamoMessage.msg.clear)){return false}this.editor.clearDocument();this.editor.undoManager.clearUndo(this.editor.editor.innerHTML);if(!damoUtil.detectIE()){this.editor.focus()}return true}function damoGetContent(b){return"<!DOCTYPE html>\n<html>\n<head>\n<meta http-equiv='Content-Type' content='text/html; charset=utf-8' />\n<title>damoWebEditor</title><style>body{font-family : segoe ui emoji}</style></head>\n<body>\n"+b+"</body>\n<html>"}function damoSaveClick(){var k="damoWebEditor.html";var g="data:text/plain;charset=utf-8,";var h=this.editor.getEditorContent(this.editor.editor);damoUtil.removeLayoutCSS(h);if(damoUtil.detectIE()){if(damoUtil.getIEVersion()===9){damoSaveAsHTML4IE9(h,k)}else{var j=new Blob([damoGetContent(h)]);window.navigator.msSaveBlob(j,k)}}else{var a=document.createElement("a");document.body.appendChild(a);a.href=g+damoGetContent(h);a.download=k;a.click();document.body.removeChild(a)}}function damoSaveAsHTML4IE9(d,e){var f=document.createElement("iframe");document.body.appendChild(f);f.contentWindow.document.open("text/html","replace");f.contentWindow.document.write(d);f.contentWindow.document.close();f.contentWindow.focus();f.contentWindow.document.execCommand("SaveAs",true,e);document.body.removeChild(f)}function damoSaveMSWORDClick(){var q="damoWebEditor.doc";var k="data:application/vnd.ms-word;charset=utf-8,";var n=this.editor.getEditorContent(this.editor.editor);damoUtil.removeLayoutCSS(n);var m="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Export HTML To Doc</title></head><body>";var l="</body></html>";var o=m+n+l;if(damoUtil.detectIE()){var p=new Blob([damoGetContent(n)]);window.navigator.msSaveBlob(p,q)}else{var a=document.createElement("a");document.body.appendChild(a);a.href=k+damoGetContent(n);a.download=q;a.click();document.body.removeChild(a)}}function damoPrintClick(){var d=damoUtil.getStyleI(this.editor.editor,"width");if(d<700){d=700}var c=window.open("","","width="+d+",height=500, scrollbars=yes");c.document.write(damoGetContent(this.editor.getEditorContent(this.editor.editor)));c.document.close();c.focus();setTimeout(function(){c.print()},1000)}function damoPasteClick(d){if(this.editor.options.accessLevel===2){if(d.preventDefault&&d.stopPropagation){d.preventDefault();d.stopPropagation()}alert(this.editor.DamoMessage.msg.accessibilityLevel);return}if(!this.editor.getClipboardData(d)){alert(this.editor.DamoMessage.msg.pasteWarning);return}this.editor.focus();document.execCommand("paste",false,null);this.editor.undoRecord();var c=damoUtil.getElementFromHierarchy();while(c.firstChild){c=c.firstChild}this.editor.activateButton(c)}function damoIndentClick(){damoIndentOutdent(20,this.editor)}function damoOutdentClick(){damoIndentOutdent(-20,this.editor)}function damoIndentOutdent(l,n){n.focus();if(damoTableEditor.selectList.length>0){var m=damoUtil.getSelection();var j=damoUtil.getRangeCreate();for(var h=0;h<damoTableEditor.selectList.length;h++){o(damoTableEditor.selectList[h])}m.removeAllRanges()}else{var j=damoUtil.getRange();if(j){var k=rangeUtil.getAllTagList(j,/^P|OL|UL|H[1-6]/);for(var h=0;h<k.length;h++){o(k[h])}}}n.undoRecord();function o(c){var b=rangeUtil.findTag(c,"^P|OL|UL|H[1-6]");if(b){var a=damoUtil.getStyle(b,"padding-left");if(!a){a=0}else{a=parseInt(a)+l}if(a<0){a=0}damoUtil.setStyle(b,{"padding-left":a+C_PX})}}}function damoToggleButtonEvent(){}damoToggleButtonEvent.prototype.init=function(d,e,f){f.toggleGroup=e.group;if(e.group){if(!d.toggleBtns){d.toggleBtns={}}if(!d.toggleBtns[e.group]){d.toggleBtns[e.group]={}}d.toggleBtns[e.group][e.command]=f}return this};damoToggleButtonEvent.prototype.buttonsDisable=function(){damoUtil.toggleClass(this.button,"buttonDisable")};damoToggleButtonEvent.prototype.activateButton=function(f,g,e){for(var h in g){damoUtil.removeClass(g[h].button,"buttonSelect")}damoUtil.addClass(f,"buttonSelect")};damoToggleButtonEvent.prototype.multiBlockExec=function(h){var g=damoUtil.getSelection();var f=damoUtil.getRangeCreate();for(var e=0;e<damoTableEditor.selectList.length;e++){damoUtil.setSelection2(g,f,damoTableEditor.selectList[e].firstChild);this.execCommand(h,damoTableEditor.selectList[e])}g.removeAllRanges()};function damoAlignButtonEvent(){this.buttonClick=function(b){if(damoTableEditor.selectList.length>0){this.multiBlockExec(b)}else{this.execCommand(b)}b.editor.undoRecord();this.activateButton(b.button,b.editor.toggleBtns[b.toggleGroup],"buttonSelect");b.editor.focus()},this.execCommand=function(f){document.execCommand(f.command,false,null);var e=rangeUtil.findElementByTag("^P$|DIV|H[1-6]");if(e){var a=f.command.replace("justify","");if(a==="full"){a="justify"}damoUtil.setStyle(e,{"text-align":a})}}}damoAlignButtonEvent.prototype=new damoToggleButtonEvent();function damoOrderButtonEvent(){this.buttonClick=function(c){c.editor.focus();if(damoTableEditor.selectList.length>0){this.multiBlockExec(c)}else{var d=damoUtil.getRange();this.execCommand(c,d.startContainer)}c.editor.undoRecord();this.activateButton(c.button,c.editor.toggleBtns[c.toggleGroup],"buttonSelect")},this.execCommand=function(d,c){document.execCommand(d.command,false,"");var c=rangeUtil.findTag(c,"OL|UL");if(c&&orderbtnflag){if(d.command==="insertorderedlist"){damoUtil.setStyle(c,{"list-style-type":"decimal"})}else{damoUtil.setStyle(c,{"list-style-type":"disc"})}damoUtil.setStyle(c,{overflow:"visible"})}else{orderbtnflag=false;selectedElement=window.getSelection().focusNode.parentNode;if(d.command==="insertorderedlist"){selectedElement.style.listStyleType="decimal"}else{selectedElement.style.listStyleType="disc"}}}}var orderbtnflag=true;damoOrderButtonEvent.prototype=new damoToggleButtonEvent();function DamoSelectBox(){this.button=null;this.width="100px";this.selectedValue=null;this.isMenu=true}DamoSelectBox.prototype.initialize=function(d,e){this.command=e.command;this.editor=d;if(d.toolbar){this.button=damoUtil.createElement("div",d.toolbar,"damoSelectBox","click",this.damoSelectBoxClick.closure(this),true)}else{this.button=damoUtil.createElement("div",d,"damoSelectBox","click",this.damoSelectBoxClick.closure(this),true)}damoUtil.setStyle(this.button,{width:this.width,"background-color":"#FFFFFF"});this.button.selecttitle=damoUtil.createElement("div",this.button,"selecttitle");this.button.selecttitle.innerHTML=e.title;damoUtil.setStyle(this.button.selecttitle,{width:(parseInt(this.width)-editorConfig.iconsize+4)+C_PX});var f=damoUtil.createElement("div",this.button,"dropbutton");damoUtil.setStyle(f,{backgroundPosition:"-3px 0px",border:"0px"});if(e.command){d.extendButton.push(this)}};DamoSelectBox.prototype.damoSelectBoxClick=function(){if(damoUtil.hasClass(this.button,"buttonDisable")){this.hide();return}if(!this.panel){this.setPanel()}if(this.panel.style.display==="none"){this.show()}else{this.hide();this.editor.focus()}};DamoSelectBox.prototype.show4timer=function(){this.panel.style.display="block";this.calcPanelPosition(this.panel);this.showPanel()};DamoSelectBox.prototype.show=function(){if(this.editor.closePanels){if(damoUtil.detectIE()){if(this.button.parentNode===this.editor.overflowBar){this.editor.closePanels(this.button.parentNode)}else{if(this.editor.editor===document.activeElement){this.editor.editor.blur()}else{this.editor.closePanels(this.button.parentNode)}}setTimeout(this.show4timer.closure(this),50)}else{this.editor.closePanels(this.button.parentNode);this.show4timer()}}else{this.closePanels();this.show4timer()}};DamoSelectBox.prototype.closePanels=function(){var c=document.getElementsByClassName("damoSelectBoxPanel");for(var d=0;d<c.length;d++){c[d].style.display="none"}};DamoSelectBox.prototype.addPanel=function(){var b=(this.isMenu)?this.editor.toolbar:this.button.parentNode.parentNode;panel=damoUtil.createElement("div",b,"damoSelectBoxPanel");panel.style.display="none";this.calcPanelPosition(panel);return panel};DamoSelectBox.prototype.calcPanelPosition=function(e){var h=this.button;var g;if(this.isMenu){if(this.button.parentNode===this.editor.overflowBar){h.parentNode.appendChild(e)}else{this.editor.toolbar.appendChild(e)}var g=damoUtil.getElementPosition(h);var f=damoUtil.getStyleI(this.editor.toolbar,"width");if(g.left+this.panelwidth>f){g.left=f-this.panelwidth-20}}else{var g=damoUtil.getElementPosition(h)}damoUtil.setStyle(e,{left:g.left+C_PX,top:(g.top+h.offsetHeight)+C_PX,width:this.panelwidth+C_PX})};DamoSelectBox.prototype.showPanel=function(){};DamoSelectBox.prototype.setPanel=function(){this.panel=this.addPanel();for(var b in this.items){this.addItem(b,this.items[b])}if(this.showEvent){this.showEvent()}};DamoSelectBox.prototype.hide=function(){if(this.panel){this.panel.style.display="none"}};DamoSelectBox.prototype.addItem=function(e,f){var d=damoUtil.createElement("div",this.panel,"damoSelectBoxItem","click",this.damoSelectBoxItemClick.closure(this,e),false);this.setItem(d,f,e)};DamoSelectBox.prototype.damoSelectBoxItemClick=function(b){this.hide();this.selectedItemEvent(b);this.editor.oldsrc=null;if(this.isMenu){this.editor.undoRecord()}};DamoSelectBox.prototype.setTitle=function(b){this.button.selecttitle.innerText=b};DamoSelectBox.prototype.buttonsDisable=function(){damoUtil.toggleClass(this.button,"buttonDisable")};DamoSelectBox.prototype.execCommand=function(g,k,j){var h=g.collapsed;var l=rangeUtil.getSpanList(g);for(var m=0;m<l.length;m++){l[m].style[k]=j;if(l.length===1&&l[m].innerHTML===""){l[m].innerText=unescape("%uFEFF")}}if(h&&l.length===1){damoUtil.setSelection(damoUtil.getSelection(),g,l[0],1)}};DamoSelectBox.prototype.setStyle=function(k,h){this.editor.focus();var g=damoUtil.getRange();if((!g||g.collapsed)&&damoTableEditor.selectList.length>0){var j=damoUtil.getSelection();g=damoUtil.getRangeCreate();for(var f=0;f<damoTableEditor.selectList.length;f++){damoUtil.setSelection2(j,g,damoTableEditor.selectList[f]);this.execCommand(g,k,h)}g.collapse(false);j.removeAllRanges()}else{this.execCommand(g,k,h)}};function damoSelectBoxFontname(){var b=["돋움","돋움체","굴림","굴림체","바탕","바탕체","궁서","Arial","Courier New","Times New Roman","Verdana"];this.width="61px";this.init=function(d,a){this.items=d.options.fonts||b;this.initialize(d,a);return this};this.setItem=function(a,d){a.innerHTML="<font face='"+d+"'>"+d+"</font>"};this.selectedItemEvent=function(d){var a=this.items[d];this.setTitle(a);this.setStyle("fontFamily",a)}}damoSelectBoxFontname.prototype=new DamoSelectBox();function damoSelectBoxFontsize(){this.items=["9pt","10pt","12pt","14pt","16pt","20pt","24pt","30pt","36pt"];this.width="36px";this.init=function(c,d){this.initialize(c,d);return this};this.setItem=function(d,c){d.innerHTML="<font style='font-size:"+c+"'>"+c+"</font>"};this.selectedItemEvent=function(d){var c=this.items[d];this.setTitle(c);this.setStyle("fontSize",c)};this.setTitle=function(b){this.button.selecttitle.innerText=b.replace("pt","")}}damoSelectBoxFontsize.prototype=new DamoSelectBox();function damoSelectBoxFontformat(){this.items={H:"기본서식",H1:"Heading 1",H2:"Heading 2",H3:"Heading 3",H4:"Heading 4",H5:"Heading 5",H6:"Heading 6"};this.width="94px";this.init=function(c,d){this.initialize(c,d);this.items.H=c.DamoMessage.buttons.fontformat;return this};this.setItem=function(d,f,e){d.innerHTML="<"+e+">"+f+"</"+e+">"};this.selectedItemEvent=function(f){if(f!=="H"){this.editor.focus();rangeUtil.execCommand(this.command,"<"+f+">",damoTableEditor.selectList);this.button.selecttitle.innerText=this.items[f];this.editor.activateButton();return}if(damoTableEditor.selectList.length>0){for(var e=0;e<damoTableEditor.selectList.length;e++){var d=rangeUtil.findTag(damoTableEditor.selectList[e],"H[1-6]");this.removeFormat(d)}}else{var d=rangeUtil.findElementByTag("H[1-6]");this.removeFormat(d)}this.editor.activateButton()},this.removeFormat=function(f){if(!f){return}var e=f.parentNode;var d=document.createElement("p");e.insertBefore(d,f);while(f.firstChild){d.appendChild(f.firstChild)}e.removeChild(f)},this.setTitle=function(b){if(this.items[b]){this.button.selecttitle.innerText=this.items[b]}else{this.button.selecttitle.innerText=editorConfig.buttons.fontformat.title}}}damoSelectBoxFontformat.prototype=new DamoSelectBox();function damoSelectButton(){this.initialize=function(h,e,f){this.command=e.command;this.editor=h;if(h.toolbar){this.button=damoUtil.createElement("div",h.toolbar,"damoSelectButton")}else{this.button=damoUtil.createElement("div",h,"damoSelectButton")}damoUtil.setStyle(this.button,{border:"1px solid #fbfcfd"});this.button.selecttitle=damoUtil.createElement("div",this.button,"damoButton","click",this.damoSelectButtonClick.closure(this),true);this.button.selecttitle.title=e.title;damoUtil.setStyle(this.button.selecttitle,{backgroundPosition:(e.icon*-editorConfig.iconsize)+"px 0px"});if(f){this.button.selecttitlecolor=damoUtil.createElement("div",this.button.selecttitle,"buttonColor")}var g=damoUtil.createElement("div",this.button,"dropbutton","click",this.damoSelectBoxClick.closure(this),true);damoUtil.setStyle(g,{backgroundPosition:"-8px 0px",width:"10px"});if(e.command){h.extendButton.push(this)}};this.changeToGroup=function(){damoUtil.addClass(this.button,"damoSelectBoxGroup")};this.damoSelectButtonClick=function(){if(this.button.disabled){return}this.selectedItemEvent(this.selectedValue);this.editor.undoRecord();this.editor.closePanels()};this.addItem=function(e,f){var d=damoUtil.createElement("div",this.panel,"damoSelectButtonItem","click",this.damoSelectBoxItemClick.closure(this,e),false);this.setItem(d,f,e)}}damoSelectButton.prototype=new DamoSelectBox();function damoSelectButtonLineheight(){this.items={1:"100%",2:"120%",3:"140%",4:"160%",5:"180%",6:"200%",7:"300%"};this.panelwidth=60;this.init=function(c,d){this.initialize(c,d);return this};this.setItem=function(d,f,e){d.innerHTML=f;damoUtil.removeClass(d,"damoSelectButtonItem");damoUtil.addClass(d,"damoSelectBoxLineheightItem")};this.selectedItemEvent=function(k){var h=this.items[k];if(damoTableEditor.selectList.length>0){var j=damoUtil.getSelection();var g=damoUtil.getRangeCreate();for(var f=0;f<damoTableEditor.selectList.length;f++){damoUtil.setSelection2(j,g,damoTableEditor.selectList[f]);this.execCommand(g,h)}j.removeAllRanges()}else{this.execCommand(damoUtil.getRange(),h)}},this.execCommand=function(f,h){var g=rangeUtil.getAllTagList(f,/^P$|^H([0-9])|OL|UL/);for(var e=0;e<g.length;e++){damoUtil.setStyle(g[e],{"line-height":h})}};this.damoSelectButtonClick=function(){this.damoSelectBoxClick()}}damoSelectButtonLineheight.prototype=new damoSelectButton();function damoSelectBoxColor(){this.items=["#ff0000","#ff5e00","#ffbb00","#ffe400","#abf200","#1fda11","#00d8ff","#0055ff","#0900ff","#6600ff","#ff00dd","#ff007f","#000000","#ffffff","#ffd8d8","#fae0d4","#faecc5","#faf4c0","#e4f7ba","#cefbc9","#d4f4fa","#d9e5ff","#dad9ff","#e8d9ff","#ffd9fa","#ffd9ec","#f6f6f6","#eaeaea","#f15f5f","#f29661","#f2cb61","#e5d85c","#bce55c","#86e57f","#5cd1e5","#6699ff","#6b66ff","#a366ff","#f261df","#f261aa","#a6a6a6","#8c8c8c","#670000","#662500","#664b00","#665c00","#476600","#22741c","#005766","#002266","#030066","#290066","#660058","#660033","#464646","#212121","#000000"];this.panelwidth=180;this.selectedValue="#000000";this.init=function(c,d){this.initialize(c,d,true);return this};this.showEvent=function(){this.moreBtn=damoUtil.createElement("button",this.panel);this.moreBtn.setAttribute("type","button");this.moreBtn.innerHTML=this.editor.DamoMessage.colorPicker.more;damoUtil.addEvent(this.moreBtn,"click",this.moreColor.closureListener(this));damoUtil.addClass(this.moreBtn,"cp-button");damoUtil.setStyle(this.panel,{overflow:"hidden"});damoUtil.addClass(this.panel,"damoSelectBoxPanelColor")};this.moreColor=function(){var e=damoUtil.createElement("div",this.panel);e.id="colorPicker";var f=damoUtil.createElement("div",this.panel,"colorStatus");this.selectedcolor=damoUtil.createElement("div",f,"selectedcolor");var d=damoUtil.createElement("button",f);d.setAttribute("type","button");d.innerHTML=this.editor.DamoMessage.colorPicker.ok;damoUtil.addEvent(d,"click",this.okClick.closureListener(this));damoUtil.addClass(d,"cp-button");e=new Picker({parent:e,popup:false,alpha:false,editor:false,color:this.selectedValue,onChange:this.colorPickerChange.closureListener(this)});this.moreBtn.disabled="false"};this.colorPickerChange=function(b){this.selectedValue=b.hex;this.selectedcolor.style.backgroundColor=b.hex};this.okClick=function(){this.damoSelectBoxItemClick(this.selectedValue)};this.setItem=function(d,c){damoUtil.setStyle(d,{"background-color":c,border:"2px solid "+c})};this.selectedItemEvent=function(j){if(j.charAt(0)!=="#"){j=this.items[j]}var f={};f[this.command.replace("fore","")]=j;this.editor.focus();var g=damoUtil.getRange();if((!g||g.collapsed)&&damoTableEditor.selectList.length>0){var h=damoUtil.getSelection();g=damoUtil.getRangeCreate();for(var k=0;k<damoTableEditor.selectList.length;k++){damoUtil.setSelection2(h,g,damoTableEditor.selectList[k]);this.execCommand(g,f)}g.collapse(false);h.removeAllRanges()}else{if(g&&!g.collapsed){this.execCommand(g,f)}}this.selectedValue=j;if(this.button.selecttitlecolor){damoUtil.setStyle(this.button.selecttitlecolor,{"background-color":j})}};this.execCommand=function(e,f){var g=rangeUtil.getSpanList(e);for(var h=0;h<g.length;h++){damoUtil.setStyle(g[h],f)}}}damoSelectBoxColor.prototype=new damoSelectButton();function damoSelectBoxColor4td(){this.selectedItemEvent=function(c){if(c.charAt(0)!=="#"){c=this.items[c]}for(var d=0;d<damoTableEditor.selectList.length;d++){damoUtil.setStyle(damoTableEditor.selectList[d],{"background-color":c})}this.selectedValue=c;damoUtil.setStyle(this.button.selecttitlecolor,{"background-color":c})}}damoSelectBoxColor4td.prototype=new damoSelectBoxColor();function damoSelectBoxAlign(){this.items={0:"left",1:"center",2:"right",3:"justify"};var d=[],c=0;this.panelwidth=30;this.init=function(a,b){this.initialize(a,b);this.setPanel();return this};this.setItem=function(b,a,f){btn=new DamoButton(this.editor,editorConfig.buttons[a],false);b.appendChild(btn.button);d[f]=btn;damoUtil.removeClass(b,"damoSelectButtonItem")};this.selectedItemEvent=function(b){c=parseInt(b);var a=damoUtil.getStyle(d[c].button,"background-position-x");damoUtil.setStyle(this.button.selecttitle,{backgroundPosition:a+" 0px"})},this.damoSelectButtonClick=function(){d[c].button.click()}}damoSelectBoxAlign.prototype=new damoSelectButton();function damoButtonExt(){this.init=function(d,e,f){this.editor=d;this.button=f;return this};this.buttonClick=function(b){this.editor.focus();if(damoUtil.hasClass(this.button.button,"buttonDisable")){this.hide();return}if(!this.panel){this.setPanel()}if(this.panel.style.display==="none"){this.show()}else{this.hide()}}}damoButtonExt.prototype.show=function(){this.editor.closePanels(this.button.button.parentNode);this.panel.style.display="block";this.calcPanelPosition(this.panel);this.showPanel()};damoButtonExt.prototype.hide=function(){this.panel.style.display="none"};damoButtonExt.prototype.addPanel=function(){panel=damoUtil.createElement("div",this.editor.toolbar,"damoSelectBoxPanel");panel.style.display="none";this.calcPanelPosition(panel);return panel};damoButtonExt.prototype.calcPanelPosition=function(e){var h=this.button.button;h.parentNode.appendChild(e);var g=damoUtil.getElementPosition(h);var f=damoUtil.getStyleI(this.editor.toolbar,"width");if(g.left+this.panelwidth>f){g.left=(g.left-this.panelwidth)}damoUtil.setStyle(e,{left:g.left+C_PX,top:(g.top+h.offsetHeight)+C_PX,width:this.panelwidth+C_PX})};function damoButtonTable(){this.panelwidth=170;this.showPanel=function(){this.selectArea(null,0,0)};this.setPanel=function(){this.panel=this.addPanel();damoUtil.addClass(this.panel,"damoSelectBoxPanelTable");this.table=damoUtil.createElement("table",this.panel,"tablePicker");damoUtil.addEvent(this.table,"mouseleave",this.mouseleave.closureListener(this));var j=damoUtil.createElement("tr",this.table);this.tablePickerDsp=damoUtil.createElement("td",j,"tablePickerDsp");this.tablePickerDsp.innerHTML="&nbsp;";this.tablePickerDsp.colSpan=10;for(var k=0;k<10;k++){var j=damoUtil.createElement("tr",this.table);for(var g=0;g<10;g++){var h=damoUtil.createElement("td",j,"tablePickerCell");damoUtil.addEvent(h,"mousedown",this.mousedown.closureListener(this));damoUtil.addEvent(h,"mousemove",this.mousemove.closureListener(this))}}var f=damoUtil.createElement("button",this.panel);f.setAttribute("type","button");f.innerHTML=this.editor.DamoMessage.table.title;damoUtil.addEvent(f,"click",this.makeTableBtnClick.closureListener(this))};this.makeTableBtnClick=function(){var b=new DamoDialogTable().init(this.editor);b.open()};this.mouseleave=function(b){this.selectArea(null,0,0)};this.mousedown=function(n){var l=n.target;var m=l.parentNode.rowIndex;var q=l.cellIndex+1;var l=rangeUtil.findTag(damoUtil.getRange().startContainer,"TD");var j=0;if(l){j=parseInt(damoUtil.getStyle(l,"width"))-10}else{j=parseInt(damoUtil.getStyle(this.editor.editor,"width"))-30}var o={width:j+C_PX,border:"0px","border-collapse":"collapse","border-spacing":"0px",border:"1px solid"};var k={width:Math.round(j/q)+C_PX,border:"1px solid","word-break":"break-all"};var p=damoMakeTable(damoUtil.getRange(),q,m,o,k);this.editor.closePanels();this.editor.undoRecord(p)};this.mousemove=function(e){var g=e.target;var h=g.parentNode.rowIndex;var f=g.cellIndex;this.selectArea(g,f,h)};this.selectArea=function(j,h,k){this.tablePickerDsp.innerHTML=(h+1)+" * "+k;for(var m=1;m<=10;m++){var l=this.table.rows[m];for(var g=0;g<10;g++){if(m<=k&g<=h){l.cells[g].style.backgroundColor="#85D3F1"}else{l.cells[g].style.backgroundColor="white"}}}}}damoButtonTable.prototype=new damoButtonExt();var damoActiveDialog=null;function DamoDialog(){this.st=null;this.initialize=function(b){this.editor=b};this.headMousedown=function(b){this.st={x:b.pageX,y:b.pageY};damoActiveDialog=this};this.headMouseup=function(){if(damoActiveDialog){damoActiveDialog.st=null}};this.headMousemove=function(d){if(!damoActiveDialog||!damoActiveDialog.st){return}var e=d.pageX-damoActiveDialog.st.x;var f=d.pageY-damoActiveDialog.st.y;damoActiveDialog.dialog.style.left=(parseInt(damoActiveDialog.dialog.style.left)+e)+C_PX;damoActiveDialog.dialog.style.top=(parseInt(damoActiveDialog.dialog.style.top)+f)+C_PX;damoActiveDialog.st={x:d.pageX,y:d.pageY}}}DamoDialog.prototype.show=function(m){this.saveRange();this.editor.editor.blur();this.damoDialog=damoUtil.createElement("div",document.body,"damoDialog");this.dialog=damoUtil.createElement("div",this.damoDialog,"dialog");this.head=damoUtil.createElement("div",this.dialog,"head","mousedown",this.headMousedown.closure(this));this.head.innerText=this.title;this.dialogBody=damoUtil.createElement("div",this.dialog,"dialogBody");var k=damoUtil.createElement("a",this.dialog,"closebtn","mousedown",this.close.closure(this));k.innerText=" ";var l=damoUtil.getElementPosition2(this.editor.editor);var j=0;var n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;if(n>414&n>this.width){n=this.width;j=(l.left-(document.documentElement.scrollLeft||document.body.scrollLeft))+(damoUtil.getStyleI(this.editor.editor,"width")-n)/2}else{n-=16;j=8}if(j<0){o=10;j=0}var o=l.top-50-(document.documentElement.scrollTop||document.body.scrollTop);var p=damoUtil.getStyleI(this.editor.editor,"height");var q=parseInt(this.height);if(p<q){o-=(q-p)/2}if(o<0){o=50}damoUtil.setStyle(this.dialog,{width:n+C_PX,top:o+C_PX,left:j+C_PX});damoUtil.addEvent(window,"mouseup",this.headMouseup);damoUtil.addEvent(window,"mousemove",this.headMousemove);this.dialogBody.innerHTML=m;damoUtil.addEventByClass("damoSubmitBtn","click",this.sumit.closure(this));damoUtil.addEventByClass("damoCancelBtn","click",this.close.closure(this));if(this.editor.options.colors){damoUtil.setStyle(this.dialog,{"border-color":this.editor.options.colors.editorBorder});damoUtil.setStyle(this.dialog,{background:this.editor.options.colors.toolbarStart})}};DamoDialog.prototype.close=function(){this.damoDialog.parentNode.removeChild(this.damoDialog);this.editor.editor.focus();if(this.selection){this.selection.addRange(this.linkRange)}this.linkRange=this.selection=null};DamoDialog.prototype.sumit=function(){if(this.submitEvent()){this.close()}};DamoDialog.prototype.saveRange=function(){this.editor.focus();this.linkRange=damoUtil.getRange();this.selection=damoUtil.getSelection()};DamoDialog.prototype.undoRecord=function(b){this.editor.undoRecord()};function damoDialogLink(){this.init=function(b){this.initialize(b);return this};this.open=function(){var h="<div id='damoDialogMain' class='damoDialogMain'><div class='damoRow'><label class='label'>URL</label><input type='text' id='damoUrl' class='textBox' value='http://'></div><div class='damoRow'><label class='label'>"+this.editor.DamoMessage.link.text+"</label><input type='text' id='damoUrlTitle' class='textBox'></div><div><label class='label' style='width: 50%'><input type='checkbox' id='damoUrlNew' value='Y'> "+this.editor.DamoMessage.link.newWindow+"</label></div></div><div id='damoDialogBottom' class='damoDialogBottom'><div class='damoSubmitBtn'>"+this.editor.DamoMessage.dialog.makeBtn+"</div> <div class='damoCancelBtn'>"+this.editor.DamoMessage.dialog.cancelBtn+"</div></div>";var e=damoUtil.getRange();this.link=rangeUtil.findTagInPath(e.startContainer,"^A");if(!this.link&&e.collapsed){alert(this.editor.DamoMessage.link.msg);return}this.width="340";this.title=this.editor.DamoMessage.buttons.link;this.show(h);if(this.link){damoUtil.getElm("damoUrl").value=this.link.getAttribute("href");damoUtil.getElm("damoUrlNew").checked=this.link.getAttribute("target")!==null;damoUtil.getElm("damoUrlTitle").value=this.link.getAttribute("title");var g=damoUtil.getElm("damoDialogBottom");var f=damoUtil.createElement("div",g,"damoControlBtn","click",this.unlinkClick.closure(this));f.innerHTML=this.editor.DamoMessage.link.unlink}};this.submitEvent=function(){var g=damoUtil.getElm("damoUrl");var k=damoUtil.getElm("damoUrlNew");var f=damoUtil.getElm("damoUrlTitle");if(this.link){this.link.setAttribute("href",g.value);this.link.setAttribute("target",k.checked?"blank_":"");return true}var j=this.linkRange.extractContents();var h=damoUtil.createElement("A");if(j.textContent===""){h.appendChild(j)}else{h.innerHTML=j.textContent;h.setAttribute("title",j.textContent)}h.setAttribute("href",g.value);if(k.checked){h.setAttribute("target","blank_")}if(f.value){h.setAttribute("title",f.value)}this.linkRange.deleteContents();this.linkRange.insertNode(h);this.undoRecord(h);return true};this.unlinkClick=function(){damoUtil.setSelection2(this.selection,this.linkRange,this.link);document.execCommand("unlink",false,null);this.editor.undoRecord();this.close()}}damoDialogLink.prototype=new DamoDialog();function damoDialogChar(){var b=["｝〔〕〈〉《》「」『』【】‘’“”、。·‥…§※☆★○●◎◇◆□■△▲▽▼◁◀▷▶♤♠♡♥♧♣⊙◈▣◐◑▒▤▥▨▧▦▩±×÷≠≤≥∞∴°′″∠⊥⌒∂≡≒≪≫√∽∝∵∫∬∈∋⊆⊇⊂⊃∪∩∧∨￢⇒⇔∀∃´～ˇ˘˝˚˙¸˛¡¿ː∮∑∏♭♩♪♬㉿→←↑↓↔↕↗↙↖↘㈜№㏇™㏂㏘℡♨☏☎☜☞¶†‡®ªº♂♀","½⅓⅔¼¾⅛⅜⅝⅞¹²³⁴ⁿ₁₂₃₄ⅠⅡⅢⅣⅤⅥⅦⅧⅨⅩⅰⅱⅲⅳⅴⅵⅶⅷⅸⅹ￦$￥￡€℃A℉￠¤‰㎕㎖㎗ℓ㎘㏄㎣㎤㎥㎦㎙㎚㎛㎜㎝㎞㎟㎠㎡㎢㏊㎍㎎㎏㏏㎈㎉㏈㎧㎨㎰㎱㎲㎳㎴㎵㎶㎷㎸㎹㎀㎁㎂㎃㎄㎺㎻㎼㎽㎾㎿㎐㎑㎒㎓㎔Ω㏀㏁㎊㎋㎌㏖㏅㎭㎮㎯㏛㎩㎪㎫㎬㏝㏐㏓㏃㏉㏜㏆","㉠㉡㉢㉣㉤㉥㉦㉧㉨㉩㉪㉫㉬㉭㉮㉯㉰㉱㉲㉳㉴㉵㉶㉷㉸㉹㉺㉻ⓐⓑⓒⓓⓔⓕⓖⓗⓘⓙⓚⓛⓜⓝⓞⓟⓠⓡⓢⓣⓤⓥⓦⓧⓨⓩ①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮㈀㈁㈂㈃㈄㈅㈆㈇㈈㈉㈊㈋㈌㈍㈎㈏㈐㈑㈒㈓㈔㈕㈖㈗㈘㈙㈚㈛⒜⒝⒞⒟⒠⒡⒢⒣⒤⒥⒦⒧⒨⒩⒪⒫⒬⒭⒮⒯⒰⒱⒲⒳⒴⒵⑴⑵⑶⑷⑸⑹⑺⑻⑼⑽⑾⑿⒀⒁⒂"];this.init=function(a){this.initialize(a);this.activeInx=0;return this};this.open=function(){var e="<div id='damoTab' class='damoTab'><div id='damoTabHead0'class='damoTabHead'>"+this.editor.DamoMessage.specialChar.tabHead1+"</div><div id='damoTabHead1' class='damoTabHead'>"+this.editor.DamoMessage.specialChar.tabHead2+"</div><div id='damoTabHead2' class='damoTabHead'>"+this.editor.DamoMessage.specialChar.tabHead3+"</div><div id='damoTabBody' class='damoTabBody'></div></div><div class='damoDialogBottom'><input type='text' id='damoSelectChar' class='damoSelectChar'/><div class='damoSubmitBtn'>"+this.editor.DamoMessage.dialog.confirmBtn+"</div><div class='damoCancelBtn'>"+this.editor.DamoMessage.dialog.cancelBtn+"</div></div>";this.width="500";this.title=this.editor.DamoMessage.buttons.specialChar;this.show(e);this.damoTabChange(0);this.damoSelectChar=damoUtil.getElm("damoSelectChar");for(var f=0;f<3;f++){var a=damoUtil.getElm("damoTabHead"+f);damoUtil.addEvent(a,"click",this.damoTabChange.closure(this,f.toString()))}};this.submitEvent=function(){if(this.damoSelectChar.value===""){return false}var a=document.createTextNode(this.damoSelectChar.value);this.linkRange.insertNode(a);damoUtil.setSelection2(this.selection,this.linkRange,a);this.undoRecord(a);return true};this.damoTabChange=function(g){var f=damoUtil.getElm("damoTabBody");damoUtil.removeAllChild(f);for(var a=0;a<b[g].length;a++){if(b[g][a]===","){continue}var h=damoUtil.createElement("div",f,"damoTabItem");h.innerText=b[g][a];damoUtil.addEvent(h,"click",this.damoTabItemClick.closure(h))}damoUtil.removeClass(damoUtil.getElm("damoTabHead"+this.activeInx),"damoTabActive");damoUtil.addClass(damoUtil.getElm("damoTabHead"+g),"damoTabActive");this.activeInx=g};this.damoTabItemClick=function(){var d=damoUtil.getElm("damoSelectChar");d.value+=this.innerText;if(d.createTextRange){var a=d.createTextRange();a.move("character",d.value.length);a.select()}else{if(d.selectionStart||d.selectionStart=="0"){d.selectionStart=d.value.length;d.selectionEnd=d.value.length;d.focus()}}}}damoDialogChar.prototype=new DamoDialog();function damoDialogEmoticon(){this.init=function(b){this.initialize(b);return this};this.open=function(){var e="<div id='damoDialogMain' class='damoDialogMain'></div><div id='damoDialogBottom' class='damoDialogBottom'><div class='damoCancelBtn'>"+this.editor.DamoMessage.dialog.closeBtn+"</div></div>";this.width="500";this.title=this.editor.DamoMessage.buttons.emoticon;this.show(e);var h=damoUtil.getElm("damoDialogMain");for(var f=1;f<79;f++){var g=damoUtil.createElement("div",h,"damoEmoticonItem");damoUtil.setStyle(g,{"background-image":"url('"+damoScriptPath+"images/emoticon/icon"+f+".gif')"});damoUtil.addEvent(g,"click",this.itemClick.closure(this,g))}};this.itemClick=function(f){var d=damoUtil.getStyle(f,"background-image");var e=damoUtil.createElement("IMG");e.setAttribute("src",d.replace(/(url\(|\)|")/g,""));e.setAttribute("title","Emoticon");e.setAttribute("alt","Emoticon");this.linkRange.insertNode(e);damoUtil.setSelection2(this.selection,this.linkRange,e);this.undoRecord(e);this.close()}}damoDialogEmoticon.prototype=new DamoDialog();function damoDialogEmoji(){const b=["1F601","1F602","1F603","1F604","1F605","1F606","1F609","1F60A","1F60B","1F60C","1F60D","1F60F","1F612","1F613","1F614","1F616","1F618","1F61A","1F61C","1F61D","1F61E","1F620","1F621","1F622","1F623","1F624","1F625","1F628","1F629","1F62A","1F62B","1F62D","1F630","1F631","1F632","1F633","1F635","1F637","1F638","1F639","1F63A","1F63B","1F63C","1F63D","1F63E","1F63F","1F640","1F645","1F646","1F647","1F648","1F649","1F64A","1F64B","1F64C","1F64D","1F64E","1F64F"];this.init=function(a){this.initialize(a);return this};this.open=function(){var h="<div id='damoDialogMain' class='damoDialogMain'></div><div id='damoDialogBottom' class='damoDialogBottom'><div class='damoCancelBtn'>"+this.editor.DamoMessage.dialog.closeBtn+"</div></div>";this.width="500";this.title=this.editor.DamoMessage.buttons.emoticon;this.show(h);var g=damoUtil.getElm("damoDialogMain");for(var a=0;a<b.length;a++){var f=damoUtil.createElement("div",g,"damoEmosiItem");damoUtil.addEvent(f,"click",this.itemClick.closure(this,f));f.innerHTML=String.fromCodePoint(parseInt(b[a],16))}};this.itemClick=function(d){var a=d.firstChild;this.linkRange.insertNode(a);damoUtil.setSelection2(this.selection,this.linkRange,a);this.undoRecord(a);this.close()}}damoDialogEmoji.prototype=new DamoDialog();function damoDialogImage(){var g=null;var j=null;var f=null;var h=null;this.init=function(a){this.initialize(a);return this};this.open=function(){var b="<div id='damoDialogMain' class='damoDialogMain'><div><div class='label'><label><input type='radio' id='damoRadioF' name='damoRadio' value='F'/>"+this.editor.DamoMessage.image.file+"</label><br/><label><input type='radio' id='damoRadioU' name='damoRadio' value='U'/> URL </label></div><div class='textColumn'><input type='text' id='damoImgURL' name='damoImgURL' class='textInput'/><input type='file' id='damoImgFile' name='damoImgFile' accept='image/*' class='textInput'/></div></div><div class='damoRow'><label class='label'>"+this.editor.DamoMessage.image.imgAlt+"</label><input type='text' id='damoImgTitle' class='textBox'/></div><div><label class='label'>"+this.editor.DamoMessage.image.imgDesc+"</label><input type='text' id='damoImgAlt' class='textBox'/></div></div><div id='damoDialogBottom' class='damoDialogBottom'><div class='damoSubmitBtn'>"+this.editor.DamoMessage.dialog.confirmBtn+"</div> <div class='damoCancelBtn'>"+this.editor.DamoMessage.dialog.cancelBtn+"</div></div>";this.width="340";this.title=this.editor.DamoMessage.buttons.image;this.show(b);this.damoImgFile=damoUtil.getElm("damoImgFile");this.damoImgURL=damoUtil.getElm("damoImgURL");var c=damoUtil.getElm("damoRadioF");var a=damoUtil.getElm("damoRadioU");damoUtil.addEvent(c,"click",this.radioClick.closureListener(this,"F"));damoUtil.addEvent(a,"click",this.radioClick.closureListener(this,"U"));g=this.editor.activeElement;if(g&&g.nodeName==="IMG"){damoUtil.getElm("damoImgTitle").value=g.getAttribute("title");damoUtil.getElm("damoImgAlt").value=g.getAttribute("alt");this.damoImgURL.value=g.getAttribute("src");a.checked=true;this.radioClick(null,null,"U")}else{g=null;c.checked=true;this.radioClick(null,null,"F")}};this.radioClick=function(a,c,b){if(b==="F"){damoUtil.setStyle(this.damoImgFile,{display:"inline-block"});damoUtil.setStyle(this.damoImgURL,{display:"none"})}else{damoUtil.setStyle(this.damoImgFile,{display:"none"});damoUtil.setStyle(this.damoImgURL,{display:"inline-block"})}};this.submitEvent=function(){j=damoUtil.getElm("damoImgTitle").value;f=damoUtil.getElm("damoImgAlt").value;var c=damoUtil.getElm("damoRadioF");if(!c.checked){if(!g){g=damoUtil.createElement("IMG");this.linkRange.insertNode(g)}g.setAttribute("src",this.damoImgURL.value);g.setAttribute("title",j);g.setAttribute("alt",f);this.undoRecord(g);damoUtil.setSelectionControl(g);return true}if(c.checked&&damoImgFile.value!==""&&damoImgFile.files&&damoImgFile.files[0].size>this.editor.options.filesize){alert(this.editor.DamoMessage.msg.filesize);return false}if(damoImgFile.value===""){if(g){g.setAttribute("title",j);g.setAttribute("alt",f);this.undoRecord(g);damoUtil.setSelectionControl(g);return true}return false}var a=damoUtil.createElement("div",damoImgFile.parentNode,"progressbar4VideoFld");var b=damoUtil.createElement("div",a,"progressbar4Video");damoUtil.setStyle(b,{width:"0%"});h={obj:this,range:this.linkRange};if(damoImgFile.files){damoFileUploadByAjax(damoImgFile,this.editor.options.uploadURL,this.uploadResult,b)}else{damoFileUpload(damoImgFile,this.editor.options.uploadURL,this.uploadResult)}return false};this.uploadResult=function(c){if(!g){g=damoUtil.createElement("IMG");h.range.insertNode(g);h.obj.editor.focus();var a=damoUtil.getSelection();var b=damoUtil.getRange();damoUtil.setSelection2(a,b,g)}g.setAttribute("src",c);if(j){g.setAttribute("title",j)}if(j){g.setAttribute("alt",f)}damoUtil.setStyle(g,{"max-width":"95%"});damoUtil.addEvent(g,"load",k);h.obj.close()};var k=function(){h.obj.undoRecord(g)}}damoDialogImage.prototype=new DamoDialog();function damoDialogFind(){this.init=function(b){this.initialize(b);if(!this.damoFind){this.damoFind=new DamoFind(this.editor)}return this};this.open=function(){var b="<div id='damoDialogMain' class='damoDialogMain'><div><label class='label'>"+this.editor.DamoMessage.find.findWord+"</label><input type='text' id='damoFindWord' class='textBox'/></div><br/><div><label class='label'>"+this.editor.DamoMessage.find.replaceWord+"</label><input type='text' id='damoReplaceWord' class='textBox'/></div><div><label class='label'></label><label><input type='checkbox' id='damoMatchcase' value='0'/> "+this.editor.DamoMessage.find.matchcase+"</label></div></div><div id='damoDialogBottom' class='damoDialogBottom'><div id='damoFindBtn' class='damoControlBtn'>"+this.editor.DamoMessage.find.findBtn+"</div><div id='damoReplaceBtn' class='damoControlBtn'>"+this.editor.DamoMessage.find.replaceBtn+"</div><div class='damoSubmitBtn'>"+this.editor.DamoMessage.find.replaceAllBtn+"</div> <div class='damoCancelBtn'>"+this.editor.DamoMessage.dialog.closeBtn+"</div></div>";this.width="350";this.title=this.editor.DamoMessage.buttons.find;this.show(b);if(this.selection){this.findReset()}this.damoFindWord=damoUtil.getElm("damoFindWord");this.damoFindWord.focus();this.damoReplaceWord=damoUtil.getElm("damoReplaceWord");this.damoFindBtn=damoUtil.getElm("damoFindBtn");this.damoReplaceBtn=damoUtil.getElm("damoReplaceBtn");damoUtil.addEvent(this.damoFindWord,"keyup",this.FindWordKeyUp.closureListener(this));damoUtil.addEvent(this.damoReplaceWord,"keyup",this.ReplaceWordKeyUp.closureListener(this));damoUtil.addEvent(this.damoFindBtn,"click",this.Find.closure(this));damoUtil.addEvent(this.damoReplaceBtn,"click",this.Replace.closure(this))};this.FindWordKeyUp=function(b){if(b.keyCode==13){this.Find()}};this.ReplaceWordKeyUp=function(b){if(b.keyCode==13){this.Replace()}};this.findReset=function(){damoUtil.setSelectText(this.selection,this.editor.editor.firstChild,0,0);this.saveRange()};this.Find=function(){if(!damoUtil.inputCheck(this.damoFindWord,this.editor.DamoMessage.find.findMsg)){return false}var b=this.damoFind.setFindOption();if(!this.damoFind.findNext(this.linkRange,b)){this.findReset()}this.saveRange()};this.Replace=function(){if(!damoUtil.inputCheck(this.damoFindWord,this.editor.DamoMessage.find.findMsg)){return false}if(!damoUtil.inputCheck(this.damoReplaceWord,this.editor.DamoMessage.find.replaceMsg)){return false}var b=this.damoFind.setFindOption();if(!this.damoFind.replaceNext(this.linkRange,b,damoReplaceWord.value)){this.findReset()}this.saveRange();this.editor.undoRecord()};this.submitEvent=function(){if(!damoUtil.inputCheck(this.damoFindWord,this.editor.DamoMessage.find.findMsg)){return false}if(!damoUtil.inputCheck(this.damoReplaceWord,this.editor.DamoMessage.find.replaceMsg)){return false}var b=this.damoFind.setFindOption();this.damoFind.replaceAll(b,damoReplaceWord.value);this.editor.undoRecord();return true}}damoDialogFind.prototype=new DamoDialog();function damoDialogLayout(){this.init=function(a){this.initialize(a);return this};this.open=function(){var o="<div id='damoDialogMain' class='damoDialogMain'></div><div id='damoDialogBottom' class='damoDialogBottom'><div class='damoCancelBtn'>"+this.editor.DamoMessage.dialog.closeBtn+"</div></div>";this.width="340";this.title=this.editor.DamoMessage.buttons.layout;this.show(o);var j=damoUtil.getElm("damoDialogMain");var a=damoUtil.createElement("table",j,"damoLayoutDialog");for(var p=0;p<4;p++){var n=damoUtil.createElement("tr",a);for(var q=0;q<4;q++){var r=p*4+q;var s=damoUtil.createElement("td",n,null,"click",this.LayoutClick.closureListener(this,r));var m=damoUtil.createElement("span",s,"editorLayoutItem");damoUtil.setStyle(m,{backgroundPosition:(r*-64)+"px 0px"})}}};var b=["<tr><td style='height: 50%;border-spacing: 10px;'>#msg#</td></tr><tr><td style='height: 50%;border-spacing: 10px;'>#msg#</td></tr>","<tr><td style='width: 50%'>#msg#</td><td style='width: 50%'>#msg#</td></tr>","<tr><td style='height: 33%'>#msg#</td></tr><tr><td style='height: 33%'>#msg#</td></tr><tr><td style='height: 33%'>#msg#</td></tr>","<tr><td style='width: 33%'>#msg#</td><td style='width: 33%'>#msg#</td><td style='width: 33%'>#msg#</td></tr>","<tr><td style='width: 50%; height: 50%;border-spacing: 10px;'>#msg#</td><td style='width: 50%; height: 50%;border-spacing: 10px;'>#msg#</td></tr><tr><td colspan='2' style='height: 50%;border-spacing: 10px;'>#msg#</td></tr>","<tr><td colspan='2' style='height: 50%;border-spacing: 10px;'>#msg#</td></tr><tr><td style='width: 50%; height: 50%;border-spacing: 10px;'>#msg#</td><td style='width: 50%; height: 50%;border-spacing: 10px;'>#msg#</td></tr>","<tr><td style='height: 50%;width: 50%'>#msg#</td><td rowspan='2'style='width: 50%'>#msg#</td></tr><tr><td style='height: 50%;width: 50%'>#msg#</td></tr>","<tr><td rowspan='2' style='width: 50%'>#msg#</td><td style='width: 50%;height: 50%;'>#msg#</td></tr><tr><td style='height: 50%;width: 50%'>#msg#</td></tr>","<tr><td style='width: 50%; height: 50%;border-spacing: 10px;'>#msg#</td><td style='width: 50%; height: 50%;border-spacing: 10px;'>#msg#</td></tr><tr><td style='width: 50%; height: 50%;border-spacing: 10px;'>#msg#</td><td style='width: 50%; height: 50%;border-spacing: 10px;'>#msg#</td></tr>","<tr><td style='height: 25%'>#msg#</td></tr><tr><td style='height: 25%'>#msg#</td></tr><tr><td style='height: 25%'>#msg#</td></tr><tr><td style='height: 25%'>#msg#</td></tr>","<tr><td colspan='2' style='height: 25%'>#msg#</td></tr><tr><td style='height: 50%;width:50%'>#msg#</td><td style='height: 50%;width:50%'>#msg#</td></tr><tr><td colspan='2' style='height: 25%'>#msg#</td></tr>","<tr><td colspan='3' style='height: 25%;border-spacing: 10px;'>#msg#</td></tr><tr><td style='width: 33%; height: 75%;'>#msg#</td><td style='width: 33%'>#msg#</td><td style='width: 33%'>#msg#</td></tr>","<tr><td style='height: 20%'>#msg#</td></tr><tr><td style='height: 20%'>#msg#</td></tr><tr><td style='height: 20%'>#msg#</td></tr><tr><td style='height: 20%'>#msg#</td></tr><tr><td style='height: 20%'>#msg#</td></tr>","<tr><td rowspan='4' style='height: 100%; width: 20%'>#msg#</td><td style='height: 25%'>#msg#</td></tr><tr><td style='height: 25%'>#msg#</td></tr><tr><td style='height: 25%'>#msg#</td></tr><tr><td style='height: 25%'>#msg#</td></tr>","<tr><td colspan='2' style='height: 25%'>#msg#</td></tr><tr><td rowspan='3' style='height: 100%; width: 20%'>#msg#</td><td style='height: 25%'>#msg#</td></tr><tr><td style='height: 25%'>#msg#</td></tr><tr><td style='height: 25%'>#msg#</td></tr>","<tr><td colspan='2' style='height: 25%'>#msg#</td></tr><tr><td rowspan='2' style='height: 100%; width: 20%'>#msg#</td><td style='height: 25%'>#msg#</td></tr><tr><td style='height: 25%'>#msg#</td></tr><tr><td colspan='2' style='height: 25%'>#msg#</td></tr>"];this.LayoutClick=function(g,a,f){if(!damoNewClick.apply(this)){return}this.editor.editor.innerHTML="<p><table class='damoLayoutInput damoLayoutDot' style='width: 100%; height: 700px; border-spacing: 10px;'>"+b[f].replace(/#msg#/g,"<p>"+this.editor.DamoMessage.layout.inputMsg+"</p>")+"</table></p>";this.editor.undoManager.clearUndo(this.editor.editor.innerHTML);this.close();var h=document.getElementsByClassName("damoLayoutInput");damoUtil.setSelectText(damoUtil.getSelection(),h[0].firstChild.firstChild.firstChild.firstChild)}}damoDialogLayout.prototype=new DamoDialog();var damoMakeUtil={makeColumn:function(m,o,n,t){var u=damoUtil.createElement("div",m,"settingField");var p=damoUtil.createElement("label",u,"inputSpinLabel");p.innerHTML=o;var r=damoUtil.createElement("div",u,"inputSpin");var s=damoUtil.createElement("input",r,"inputSpinTxt","keydown",damoUtil.onlyNumber);s.value=n;if(!t){var w=damoUtil.createElement("div",r,"spinButton");var q=damoUtil.createElement("span",w,"spinUp","click",this.spinClick.closure(s,1));var v=damoUtil.createElement("span",w,"spinDown","click",this.spinClick.closure(s,-1))}else{s.disabled=true}return s},makeTextColumn:function(k,f){var h=damoUtil.createElement("div",k,"settingField");var j=damoUtil.createElement("label",h,"inputSpinLabel");j.innerHTML=f;var g=damoUtil.createElement("input",h,"inputText");return g},makeSelectBox:function(n,h,j,o){var k=damoUtil.createElement("div",n,"settingField");var m=damoUtil.createElement("label",k,"inputSpinLabel");m.innerHTML=h;var l=new j();l.init(k,{});l.editor=o;return l},spinClick:function(b){this.value=damoUtil.parseInt(this.value)+b;if(this.value==="-1"){this.value="0"}}};function DamoDialogBasic4Table(){this.init=function(b){this.initialize(b);return this};this.open=function(b){}}DamoDialogBasic4Table.prototype=new DamoDialog();function DamoDialogTable(){this.open=function(k){var g="<div id='damoDialogMain' class='damoDialogMain'></div><div id='damoDialogBottom' class='damoDialogBottom'><div class='damoSubmitBtn'>"+this.editor.DamoMessage.dialog.confirmBtn+"</div> <div class='damoCancelBtn'>"+this.editor.DamoMessage.dialog.cancelBtn+"</div></div>";this.width="400";this.title=this.editor.DamoMessage.table.title;this.show(g);this.selectedTable=k;var f=damoUtil.getElm("damoDialogMain");this.tableRow=damoMakeUtil.makeColumn(f,this.editor.DamoMessage.table.row,5,k);this.tableWidth=damoMakeUtil.makeColumn(f,this.editor.DamoMessage.table.width,"");this.tableColumn=damoMakeUtil.makeColumn(f,this.editor.DamoMessage.table.column,4,k);this.tableHeight=damoMakeUtil.makeColumn(f,this.editor.DamoMessage.table.height,"");this.tableBorder=damoMakeUtil.makeSelectBox(f,this.editor.DamoMessage.table.border,damoSelectBoxLinetype4Table,this.editor);this.tableBorderWidth=damoMakeUtil.makeColumn(f,this.editor.DamoMessage.table.borderWidth,1);this.borderColor=damoMakeUtil.makeSelectBox(f,this.editor.DamoMessage.table.borderColor,damoSelectBoxLineColor4Dialog,this.editor);this.bgColor=damoMakeUtil.makeSelectBox(f,this.editor.DamoMessage.table.bgColor,damoSelectBoxLineColor4Dialog,this.editor);this.tableCellSpace=damoMakeUtil.makeColumn(f,this.editor.DamoMessage.table.cellSpace,0);this.tableCellPad=damoMakeUtil.makeColumn(f,this.editor.DamoMessage.table.cellPad,1);this.borderColor.selectedItemEvent("#000000");this.bgColor.selectedItemEvent("#FFFFFF");var h=damoUtil.createElement("div",f,"settingField");var j=damoUtil.createElement("label",h);j.innerHTML=this.editor.DamoMessage.table.seperateBorder;this.collapse=damoUtil.createElement("input",j);this.collapse.type="checkbox";damoUtil.createElement("br",f);this.caption=damoMakeUtil.makeTextColumn(f,this.editor.DamoMessage.table.caption);this.summary=damoMakeUtil.makeTextColumn(f,this.editor.DamoMessage.table.summary);if(!k){return}this.tableRow.value=k.rows.length;this.tableWidth.value=damoUtil.getStyleI(k,"width");this.tableColumn.value=k.rows[0].cells.length;this.tableHeight.value=damoUtil.getStyleI(k,"height");this.tableBorder.setValue(damoUtil.getStyleA(k,"border-top-style"));this.tableBorderWidth.value=parseFloat(damoUtil.getStyleA(k,"border-top-width"));this.borderColor.setValue(damoUtil.getStyleA(k,"border-top-color"));this.bgColor.setValue(damoUtil.getStyleA(k,"background-color"));this.tableCellSpace.value=damoUtil.getStyleAI(k,"border-spacing");this.tableCellPad.value=damoUtil.getStyleAI(k,"padding");this.collapse.checked=damoUtil.getStyle(k,"border-collapse")!=="collapse";if(k.caption){this.caption.value=k.caption.innerHTML}if(k.summary&k.summary!==undefined){this.summary.value=k.summary}};this.submitEvent=function(){var c=this.tableRow.value;var d=this.tableColumn.value;if(c>60||d>40){alert(this.editor.DamoMessage.table.restrictCellMsg);return}if(this.selectedTable){return this.modifyTable()}return this.makeTable()};this.modifyTable=function(){damoUtil.setStyle(this.selectedTable,this.makeCSS(this.calWidth()));if(!this.selectedTable.caption){this.selectedTable.createCaption()}this.selectedTable.caption.innerHTML=this.caption.value;this.selectedTable.summary=this.summary.value;this.undoRecord(this.selectedTable);return true};this.makeTable=function(){var l=this.tableRow.value;var q=this.tableColumn.value;if(q==="0"||l==="0"){alert(this.editor.DamoMessage.table.InputMsg);return false}var j=this.calWidth();var m=rangeUtil.findTag(this.linkRange.startContainer,"TD");var o=Math.round(j/q)+C_PX;var p=this.makeCSS(j);var k={width:o,border:"1px solid black","word-break":"break-all"};var n=damoMakeTable(this.linkRange,q,l,p,k,this.summary.value,this.caption.value);this.undoRecord(n);return true};this.calWidth=function(){var d=this.tableWidth.value;if(damoUtil.parseInt(d)>0){d=d}else{var c=rangeUtil.findTag(this.linkRange.startContainer,"TD");d=c?parseInt(damoUtil.getStyle(c,"width"))-10:parseInt(damoUtil.getStyle(this.editor.editor,"width"))-30}return d};this.makeCSS=function(e){var f={width:e+C_PX,border:this.tableBorderWidth.value+"px "+this.tableBorder.getValue()+" "+this.borderColor.selectedValue,"background-color":this.bgColor.selectedValue,"border-spacing":this.tableCellSpace.value+C_PX,padding:this.tableCellPad.value+C_PX};var d=this.tableHeight.value;if(damoUtil.parseInt(d)>0){f.height=d+C_PX}f["border-collapse"]=this.collapse.checked?"separate":"collapse";return f}}DamoDialogTable.prototype=new DamoDialogBasic4Table();function damoMakeTable(w,s,t,v,z,u,p){var q=damoUtil.createElement("table",null);q.summary=u;damoUtil.setStyle(q,v);if(p){var r=q.createCaption();r.innerText=p}for(var y=0;y<t;y++){var j=damoUtil.createElement("tr",q);for(var A=0;A<s;A++){var B=damoUtil.createElement("td",j);damoUtil.setStyle(B,z);B.innerHTML="<p>"+damoUtil.getBlankChar()+"</p>"}}w.insertNode(q);q.rows[0].cells[0].focus();return q}function DamoDialogTableCell(){this.open=function(s){var C={left:this.editor.DamoMessage.tableCell.left,right:this.editor.DamoMessage.tableCell.right,center:this.editor.DamoMessage.tableCell.center,justify:this.editor.DamoMessage.tableCell.justify};var r={top:this.editor.DamoMessage.tableCell.top,middle:this.editor.DamoMessage.tableCell.middle,bottom:this.editor.DamoMessage.tableCell.bottom};var q={normal:this.editor.DamoMessage.tableCell.wordbreak_normal,"break-all":this.editor.DamoMessage.tableCell.wordbreak_all};this.border_arr={left:1,right:1,top:1,middle:1};var w="<div id='damoDialogMain' class='damoDialogMain'></div><div id='damoDialogBottom' class='damoDialogBottom'><div class='damoSubmitBtn'>"+this.editor.DamoMessage.dialog.confirmBtn+"</div> <div class='damoCancelBtn'>"+this.editor.DamoMessage.dialog.cancelBtn+"</div></div>";this.width="400";this.title=this.editor.DamoMessage.tableCell.title;this.show(w);this.selectedCell=s.selectList[0];this.selectList=s.selectList;this.tableEditor=s;var p=damoUtil.getElm("damoDialogMain");this.align=this.makeSelectBoxTag(p,this.editor.DamoMessage.tableCell.align,C);this.wordbreak=this.makeSelectBoxTag(p,this.editor.DamoMessage.tableCell.wordbreak,q);this.valign=this.makeSelectBoxTag(p,this.editor.DamoMessage.tableCell.valign,r);damoUtil.createElement("hr",p);this.tableBorder=damoMakeUtil.makeSelectBox(p,this.editor.DamoMessage.tableCell.tableBorder,damoSelectBoxLinetype4Table,this.editor);this.tableBorderWidth=damoMakeUtil.makeColumn(p,this.editor.DamoMessage.tableCell.tableBorderWidth,1);this.borderColor=damoMakeUtil.makeSelectBox(p,this.editor.DamoMessage.tableCell.borderColor,damoSelectBoxLineColor4Dialog,this.editor);this.bgColor=damoMakeUtil.makeSelectBox(p,this.editor.DamoMessage.tableCell.bgColor,damoSelectBoxLineColor4Dialog,this.editor);this.tableCellPad=damoMakeUtil.makeColumn(p,this.editor.DamoMessage.tableCell.tableCellPad,1);var A=damoUtil.createElement("div",p,"settingField damoEditorCellProp");var D=damoUtil.createElement("div",A,"damoEditorCellPropOutline");var z=damoUtil.createElement("div",D,"damoEditorCellPropOutlineLeft");var t=damoUtil.createElement("div",z,"damoEditorCellPropHandlerTop");var y=damoUtil.createElement("div",z,"damoEditorCellPropHandlerBottom");this.propPreview=damoUtil.createElement("div",D,"damoEditorCellPropPreview");var u=damoUtil.createElement("div",D,"damoEditorCellPropHandlerLeft");var v=damoUtil.createElement("div",D,"damoEditorCellPropHandlerRight");damoUtil.addEvent(t,"click",this.previewClick.closureListener(this,"top"));damoUtil.addEvent(y,"click",this.previewClick.closureListener(this,"bottom"));damoUtil.addEvent(u,"click",this.previewClick.closureListener(this,"left"));damoUtil.addEvent(v,"click",this.previewClick.closureListener(this,"right"));this.getBorderStatus(this.selectedCell,t,"top");this.getBorderStatus(this.selectedCell,y,"bottom");this.getBorderStatus(this.selectedCell,u,"left");this.getBorderStatus(this.selectedCell,v,"right");var B=damoUtil.createElement("div",p,"damoEditorCellGuideMsg");B.innerHTML="셀의 선 속성(모양, 색 등)이 제대로 적용되지<br/>않는 경우, [표속성]에서 <br/>[표 테두리 분리]를 선택하고 사용하세요.";this.align.value=damoUtil.getStyle(this.selectedCell,"text-align");this.wordbreak.value=damoUtil.getStyle(this.selectedCell,"word-break");this.valign.value=damoUtil.getStyle(this.selectedCell,"vertical-align");this.tableBorder.setValue(damoUtil.getStyleA(this.selectedCell,"border-top-style"));this.tableBorderWidth.value=parseFloat(damoUtil.getStyleA(this.selectedCell,"border-top-width"));this.borderColor.setValue(damoUtil.getStyleA(this.selectedCell,"border-top-color"));this.bgColor.setValue(damoUtil.getStyleA(this.selectedCell,"background-color"));this.tableCellPad.value=damoUtil.getStyleAI(this.selectedCell,"padding")};this.previewClick=function(j,f,g){var h=this.propPreview;var k="border-"+g+"-style";if(h.style[k]==="dotted"){h.style[k]="solid";f.style.backgroundColor="#C0C0C0";this.border_arr[g]=1}else{h.style[k]="dotted";f.style.backgroundColor="#FFFFFF";this.border_arr[g]=0}};this.getBorderStatus=function(h,f,g){var k="border-"+g+"-style";var j=this.propPreview;if(h.style[k]==="solid"){j.style[k]="solid";f.style.backgroundColor="#C0C0C0";this.border_arr[g]=1}else{j.style[k]="dotted";f.style.backgroundColor="#FFFFFF";this.border_arr[g]=0}};this.makeSelectBoxTag=function(o,q,j){var l=damoUtil.createElement("div",o,"settingField");var n=damoUtil.createElement("label",l,"inputSpinLabel");n.innerHTML=q;var k=damoUtil.createElement("select",l,"damoSelect");for(var p in j){var m=j[p];k.options[k.options.length]=new Option(m,p)}return k};this.submitEvent=function(){var d=this.makeCSS();for(var e=0;e<this.selectList.length;e++){var f=this.selectList[e];damoUtil.setStyle(f,d)}this.undoRecord(this.selectedCell);return true};this.close=function(){this.editor.editor.focus();this.damoDialog.parentNode.removeChild(this.damoDialog);this.tableEditor.resetSelectList(this.selectList);return true};this.makeCSS=function(){var c={"text-align":this.align.value,"word-break":this.wordbreak.value,"vertical-align":this.valign.value,border:this.tableBorderWidth.value+"px "+this.tableBorder.getValue()+" "+this.borderColor.selectedValue,"background-color":this.bgColor.selectedValue,padding:this.tableCellPad.value+C_PX};if(this.border_arr.left+this.border_arr.right+this.border_arr.top+this.border_arr.middle!==4){for(var d in this.border_arr){c["border-"+d+"-style"]=(this.border_arr[d]===1)?this.tableBorder.getValue():"none"}}return c}}DamoDialogTableCell.prototype=new DamoDialogBasic4Table();function damoSelectBoxLinetype4Table(){this.isMenu=false;this.items={0:"style='border: 1px'",1:"style='border: 1px solid'",2:"style='border: 1px dashed'",3:"style='border: 1px dotted'",4:"style='border: 3px double'"};this.itemsString=["","solid","dashed","dotted","double"];this.width="80px";this.selectedIndex=null;this.init=function(c,d){this.initialize(c,d);this.selectedItemEvent(1);return this};this.setItem=function(d,f,e){d.innerHTML="<HR "+f+">";damoUtil.setStyle(d,{width:"80px"})};this.selectedItemEvent=function(b){this.selectedIndex=b;this.button.selecttitle.innerHTML="<HR "+this.items[b]+">"};this.getValue=function(){return this.itemsString[this.selectedIndex]};this.setValue=function(c){for(var d=0;d<this.itemsString.length;d++){if(this.itemsString[d]===c){this.selectedItemEvent(d);return}}this.selectedItemEvent(0)};this.damoSelectButtonClick=function(){this.selectedItemEvent(this.selectedValue)}}damoSelectBoxLinetype4Table.prototype=new DamoSelectBox();function damoSelectBoxLineColor4Dialog(){this.isMenu=false;this.init=function(c,d){this.initialize(c,d,false);return this};this.selectedItemEvent=function(b){if(parseInt(b)<100){b=this.items[b]}this.selectedValue=b;damoUtil.setStyle(this.button.selecttitle,{"background-image":"none","background-color":b})};this.setValue=function(b){this.selectedItemEvent(b)};this.damoSelectButtonClick=function(){}}damoSelectBoxLineColor4Dialog.prototype=new damoSelectBoxColor();function DamoFind(m){var j=false;var n=m;var l=function(d,e,a){if(!d||d.tagName=="BODY"||d.className=="damoEditor"){return null}var b=d;do{var f="";if(b.data){f=b.data}else{f=b.innerText}if(f&&!j){f=f.toLowerCase()}if(b.nodeType===3&&f.indexOf(a,e)>-1){o(a,b,f.indexOf(a,e));return b}if(b.firstChild){for(var c=0;c<b.childNodes.length;c++){return l(b.childNodes[c],0,a)}}}while(b=b.nextSibling);return l(k(d),0,a)};var k=function(a){while(a=a.parentNode){if(a.className=="damoEditor"){return null}if(a.nextSibling){return a.nextSibling}}return null};var o=function(b,c,a){if(n.editor.scrollTop>c.parentNode.offsetTop||n.editor.scrollTop+parseInt(n.editor.style.height)<c.parentNode.offsetTop+20){n.editor.scrollTop=c.parentNode.offsetTop-20}damoUtil.setSelectText(damoUtil.getSelection(),c,a,a+b.length)};var h=function(a){if(a.endContainer.firstChild){return a.endContainer.firstChild}else{return a.endContainer}};this.findNext=function(c,b){var a=h(c);var d=l(a,c.endOffset+1,b);if(!d){alert(n.DamoMessage.find.notFindMsg)}return d};this.replaceNext=function(c,q,d){var f=h(c);var a=c.endOffset;var b="";if(f.data){b=f.data.substring(c.startOffset,c.endOffset)}if((j&&b===q)||(!j&&b.toLowerCase()===q)){a=c.startOffset+d.length;var g=f.data;f.data=g.substring(0,c.startOffset)+d+g.substring(c.endOffset,g.length)}var e=l(f,a,q);if(!e){alert(n.DamoMessage.find.notFindMsg)}return e};this.replaceAll=function(g,e){var q=n.editor.firstChild,b=0,d=0;var a=new RegExp(g,"g"+(!j?"i":""));while(q=l(q,d,g)){var f=q.data;var c=f.match(a);b+=c.length;q.data=f.replace(a,e);d=q.data.length}alert(n.DamoMessage.find.replacedMsg.replace("%1",b))};this.setFindOption=function(){var a=document.getElementById("damoFindWord").value;j=document.getElementById("damoMatchcase").checked;if(!j){a=a.toLowerCase()}n.editor.focus();return a}}function damoDialogExternalMedia(){this.init=function(b){this.initialize(b);return this};this.open=function(){var b="<div id='damoDialogMain' class='damoDialogMain'><div>"+this.editor.DamoMessage.externalMedia.desc+"</div><br/><div>"+this.editor.DamoMessage.externalMedia.source+"</div><br/><div><textarea id='damoMediaSource' style='width: 98%; height: 120px; border: 1px solid LightGray'></textarea></div><br/></div><div id='damoDialogBottom' class='damoDialogBottom'><div class='damoSubmitBtn'>"+this.editor.DamoMessage.dialog.confirmBtn+"</div> <div class='damoCancelBtn'>"+this.editor.DamoMessage.dialog.cancelBtn+"</div></div>";this.width="470";this.title=this.editor.DamoMessage.buttons.externalMedia;this.show(b)};this.submitEvent=function(){var h=damoUtil.getElm("damoMediaSource");var g=h.value;if(!g.match(/object|embed|video|iframe/i)){alert(this.editor.DamoMessage.externalMedia.inputError);return}var e=damoUtil.createElement("P");e.innerHTML=h.value;try{if(e.firstChild){damoUtil.setStyle(e.firstChild,{"max-width":"95%"})}}catch(f){alert(this.editor.DamoMessage.externalMedia.inputError);return}this.editor.focus();this.linkRange.insertNode(e);this.selection.addRange(this.linkRange);this.undoRecord(e);this.close()}}damoDialogExternalMedia.prototype=new DamoDialog();function damoDialogMedia(){var d=null;var c=null;this.init=function(a){this.initialize(a);return this};this.open=function(){var b="<div id='damoDialogMain' class='damoDialogMain'><div><label class='label'>"+this.editor.DamoMessage.image.file+"</label><input type='file' id='damoImgFile' name='damoImgFile' class='textBox' accept='.wmv, .mp4, .avi'/></div><br/><div id='damoDialogSub'></div><br/><div><label class='videoLabel'><input type='checkbox' name='damoVideoOption' value='autoplay' />"+this.editor.DamoMessage.mediaFile.autoplay+"</label><label class='videoLabel'><input type='checkbox' name='damoVideoOption' value='loop' />"+this.editor.DamoMessage.mediaFile.loop+"</label><label class='videoLabel'><input type='checkbox' name='damoVideoOption' value='controls' checked/>"+this.editor.DamoMessage.mediaFile.controls+"</label></div><br/></div><div id='damoDialogBottom' class='damoDialogBottom'><div class='damoSubmitBtn'>"+this.editor.DamoMessage.dialog.confirmBtn+"</div> <div class='damoCancelBtn'>"+this.editor.DamoMessage.dialog.cancelBtn+"</div></div>";this.width="380";this.title=this.editor.DamoMessage.buttons.mediaFile;this.show(b);var a=damoUtil.getElm("damoDialogSub");this.videoWidth=damoMakeUtil.makeColumn(a,this.editor.DamoMessage.table.width,320,false);this.videoHeight=damoMakeUtil.makeColumn(a,this.editor.DamoMessage.table.height,240,false)};this.submitEvent=function(){var a=document.querySelectorAll("input[name=damoVideoOption]:checked");var n=0;for(var b=0;b<a.length;b++){if(a[b].value==="controls"){n++;break}}if(n===0){if(!confirm(this.editor.DamoMessage.mediaFile.controlsMsg)){return false}}var l=damoUtil.getElm("damoImgFile");if(l.value===""){return false}var m="";if(l.files){if(l.files[0].size>this.editor.options.filesize){alert(this.editor.DamoMessage.msg.filesize);return false}m=l.files[0].name}else{m=l.value}damoUtil.setStyle(l,{display:"none"});var k=damoUtil.createElement("div",l.parentNode,"progressbar4VideoFld");var o=damoUtil.createElement("div",k,"progressbar4Video");damoUtil.setStyle(o,{width:"0%"});c={obj:this,range:this.linkRange,ext:m.split(".").pop()};if(l.files){damoFileUploadByAjax(l,this.editor.options.uploadURL,this.uploadResult,o)}else{damoFileUpload(l,this.editor.options.uploadURL,this.uploadResult)}return false};this.uploadResult=function(k){var h=document.querySelectorAll("input[name=damoVideoOption]:checked");c.obj.editor.focus();var b=damoUtil.createElement("video");b.setAttribute("width",c.obj.videoWidth.value);b.setAttribute("height",c.obj.videoHeight.value);if(c.damoVideoTag==="video"){var a=damoUtil.createElement("source");b.appendChild(a);a.setAttribute("src",k);a.setAttribute("type","video/"+c.ext);for(var j=0;j<h.length;j++){if(h[j].checked){b.setAttribute(h[j].value,h[j].value)}}}else{b.setAttribute("src",k);b.setAttribute("type","video/x-ms-wmv");b.setAttribute("enablecontextmenu","0");for(var j=0;j<h.length;j++){if(h[j].checked){b.setAttribute(h[j].value,(h[j].checked?"1":"0"))}}}c.range.insertNode(b);c.obj.undoRecord(b);c.obj.close()}}damoDialogMedia.prototype=new DamoDialog();function damoSelectBoxMedia(){this.items={0:"externalMedia",1:"mediaFile"};var d=[],c=0;this.panelwidth=30;this.init=function(a,b){this.initialize(a,b);this.setPanel();return this};this.setItem=function(b,a,f){btn=new DamoButton(this.editor,editorConfig.buttons[a],false);b.appendChild(btn.button);d[f]=btn;damoUtil.removeClass(b,"damoSelectButtonItem")};this.selectedItemEvent=function(b){c=parseInt(b);var a=damoUtil.getStyle(d[c].button,"background-position-x");damoUtil.setStyle(this.button.selecttitle,{backgroundPosition:a+" 0px"})},this.damoSelectButtonClick=function(){d[c].button.click()}}damoSelectBoxMedia.prototype=new damoSelectButton();function damoSelectBox4Buttons(){this.items={};var d=[],c=0;this.panelwidth=30;this.init=function(a,b){this.initialize(a,b);this.setPanel();return this};this.addItem=function(b){var f=d.length;var a=damoUtil.createElement("div",this.panel,"","click",this.damoSelectBoxItemClick.closure(this,f),false);a.appendChild(b.button);d[f]=b};this.itemMoveTo=function(a){for(var b=0;b<d.length;b++){a.insertBefore(d[b].button,this.button)}d=[]};this.isEmpty=function(){return d.length===0};this.selectedItemEvent=function(b){if(b===this){b=0}c=parseInt(b);var a=damoUtil.getStyle(d[c].button,"background-position-x");damoUtil.setStyle(this.button.selecttitle,{backgroundPosition:a+" 0px"})},this.damoSelectButtonClick=function(){d[c].button.click()}}damoSelectBox4Buttons.prototype=new damoSelectButton();function damoDialogDocument(){var h=null;var k=null;var l=[];var j=[];var n=["left top","left center","left bottom","right top","right center","right bottom","center top","center center","center bottom"];var m=[];this.init=function(a){this.initialize(a);l=[["","scroll","fixed"],[this.editor.DamoMessage.documentBG.optionDefault,this.editor.DamoMessage.documentBG.optionScroll,this.editor.DamoMessage.documentBG.optionFixed]];j=[["no-repeat","repeat","repeat-x","repeat-y"],[this.editor.DamoMessage.documentBG.repeatNo,this.editor.DamoMessage.documentBG.repeat,this.editor.DamoMessage.documentBG.repeatX,this.editor.DamoMessage.documentBG.repeatY]];m=[n,this.editor.DamoMessage.documentBG.imgPosArr];return this};this.open=function(){var s="<div id='damoDialogMain' class='damoDialogMain'><div><label class='label'>"+this.editor.DamoMessage.buttons.image+"</label><input type='file' id='damoImgFile' name='damoImgFile' accept='image/*' class='textBox'/></div><br/><div><label class='label'>"+this.editor.DamoMessage.documentBG.imgOption+"</label><select id='damoImgOption' class='selectBox'></select></div><br/><div><label class='label'>"+this.editor.DamoMessage.documentBG.imgRepeat+"</label><select id='damoImgRepeat' class='selectBox'></select></div><br/><div><label class='label'>"+this.editor.DamoMessage.documentBG.imgPosition+"</label><select id='damoImgPosition' class='selectBox'></select></div><br/></div><div id='damoDialogBottom' class='damoDialogBottom'><div class='damoSubmitBtn'>"+this.editor.DamoMessage.dialog.confirmBtn+"</div> <div class='damoCancelBtn'>"+this.editor.DamoMessage.dialog.cancelBtn+"</div></div>";this.width="340";this.title=this.editor.DamoMessage.buttons.documentBG;this.show(s);this.imgOption=damoUtil.getElm("damoImgOption");o(this.imgOption,l);this.imgRepeat=damoUtil.getElm("damoImgRepeat");o(this.imgRepeat,j);this.imgPosition=damoUtil.getElm("damoImgPosition");o(this.imgPosition,m);var a=damoUtil.getElm("damoDialogMain");var u=damoUtil.createElement("div",a,"settingField_tmp");var c=damoUtil.createElement("label",u,"label");c.innerHTML=this.editor.DamoMessage.documentBG.bgCollor;this.bgColor=new damoSelectBoxLineColor4Dialog();this.bgColor.init(u,{});this.bgColor.editor=this.editor;this.bgColor.selectedItemEvent("#FFFFFF");damoUtil.addEvent(this.bgColor.button.selecttitle,"click",this.bgColor.damoSelectBoxClick.closure(this.bgColor));var t=damoUtil.getStyleA(this.editor.editor,"background-color");if(t==="transparent"){t="#FFFFFF"}this.bgColor.setValue(t);this.imgOption.value=damoUtil.getStyle(this.editor.editor,"background-attachment");this.imgRepeat.value=damoUtil.getStyle(this.editor.editor,"background-repeat");this.imgPosition.value=damoUtil.getStyle(this.editor.editor,"background-position-x")+" "+damoUtil.getStyle(this.editor.editor,"background-position-y");var e=damoUtil.getElm("damoImgFile");var d=damoUtil.getStyle(this.editor.editor,"background-image");if(d!=="none"){var b=damoUtil.createElement("span",e.parentNode,"imageFile");b.innerHTML=d;b.setAttribute("title",d);var f=damoUtil.getElm("damoDialogBottom");var g=damoUtil.createElement("A",f,"damoControlBtn","click",this.removeButtonClick.closure(this));g.innerHTML=this.editor.DamoMessage.documentBG.imgRemove;g.setAttribute("href","#")}};this.removeButtonClick=function(){damoUtil.setStyle(this.editor.editor,{"background-color":"","background-image":"none"});this.close()};this.damoSelectButtonClick=function(){};function o(b,c){for(i=0;i<c[0].length;i++){var a=damoUtil.createElement("option");a.text=c[1][i];a.value=c[0][i];b.options.add(a)}}this.submitEvent=function(){damoUtil.setStyle(this.editor.editor,{"background-color":this.bgColor.selectedValue});damoUtil.setStyle(this.editor.editor,{"background-attachment":this.imgOption.value});damoUtil.setStyle(this.editor.editor,{"background-repeat":this.imgRepeat.value});damoUtil.setStyle(this.editor.editor,{"background-position":this.imgPosition.value});var a=damoUtil.getElm("damoImgFile");if(a.value===""){return true}_this=this;if(a.files){damoFileUploadByAjax(a,this.editor.options.uploadURL,this.uploadResult,null)}else{damoFileUpload(a,this.editor.options.uploadURL,this.uploadResult)}return true};this.uploadResult=function(a){damoUtil.setStyle(_this.editor.editor,{"background-image":"url('"+a+"')"})}}damoDialogDocument.prototype=new DamoDialog();function DamoDialogHorizon(){var b=["border-top: 1px solid #8c8b8b; border-bottom: 1px solid #fff;","background-color: #fff; border: 1px solid #8c8b8b;","background-color: #fff; border: 1px dashed #8c8b8b;","background-color: #fff; border: 1px dotted #8c8b8b;","background-color: #fff; border-top: 3px double #8c8b8b;","border-top: 1px dashed #8c8b8b; border-bottom: 1px dashed #fff;","border-top: 1px dotted #8c8b8b; border-bottom: 1px dotted #fff;","border: 0; height: 1px; background-image: -webkit-linear-gradient(left, #fff, #8c8b8b, #fff); background-image: -moz-linear-gradient(left, #fff, #8c8b8b, #fff); background-image: -ms-linear-gradient(left, #fff, #8c8b8b, #fff); background-image: -o-linear-gradient(left, #fff, #8c8b8b, #fff); ","height: 10px; border: 0; box-shadow: 0 10px 10px -10px #8c8b8b inset;","height: 10px; border: 1; box-shadow: inset 0 9px 9px -3px #8c8b8b; -webkit-border-radius: 5px; -moz-border-radius: 5px; -ms-border-radius: 5px; -o-border-radius: 5px; border-radius: 5px;"];this.init=function(a){this.initialize(a);return this};this.open=function(){var k="<div id='damoDialogMain' class='damoDialogMain'></div><div id='damoDialogBottom' class='damoDialogBottom'><div class='damoSubmitBtn'>"+this.editor.DamoMessage.dialog.confirmBtn+"</div> <div class='damoCancelBtn'>"+this.editor.DamoMessage.dialog.cancelBtn+"</div></div>";this.width="400";this.title=this.editor.DamoMessage.buttons.hr;this.show(k);var j=damoUtil.getElm("damoDialogMain");this.tableWidth=damoMakeUtil.makeColumn(j,this.editor.DamoMessage.table.width+" (%)","100");this.tableHeight=damoMakeUtil.makeColumn(j,this.editor.DamoMessage.table.height+" (px)","1");this.borderColor=damoMakeUtil.makeSelectBox(j,this.editor.DamoMessage.table.borderColor,damoSelectBoxLineColor4Dialog,this.editor);this.bgColor=damoMakeUtil.makeSelectBox(j,this.editor.DamoMessage.documentBG.bgCollor,damoSelectBoxLineColor4Dialog,this.editor);this.borderColor.selectedItemEvent("#000000");this.bgColor.selectedItemEvent("#FFFFFF");damoUtil.createElement("hr",j);for(var a=0;a<b.length;a++){var h=damoUtil.createElement("div",j,"controlColumn");var g=damoUtil.createElement("div",h,"horizontalRuleItem");g.innerHTML="<hr style='"+b[a]+"'/>";damoUtil.addEvent(g,"click",this.templiteClick.closure(this,a+1))}};this.templiteClick=function(a){var f=b[a-1];f=f.replace(/#8c8b8b/gi,this.borderColor.selectedValue);f=f.replace(/#fff/gi,this.bgColor.selectedValue);var e=damoUtil.createElement("HR");e.style.cssText=f;damoUtil.setStyle(e,{width:this.tableWidth.value+"%"});this.linkRange.deleteContents();this.linkRange.insertNode(e);this.undoRecord(e);this.close()};this.submitEvent=function(){var a=damoUtil.createElement("HR");damoUtil.setStyle(a,{width:this.tableWidth.value+"%",border:this.tableHeight.value+C_PX+" solid "+this.borderColor.selectedValue,"background-color":this.bgColor.selectedValue});this.linkRange.deleteContents();this.linkRange.insertNode(a);this.undoRecord(a);return true}}DamoDialogHorizon.prototype=new DamoDialog();function DamoDialogQuotation(){var b=["background-color: #fff; border: 1px solid #8c8b8b;","background-color: #fff; border: 1px dashed #8c8b8b;","background-color: #fff; border-left: 1px solid #8c8b8b;"];this.init=function(a){this.initialize(a);return this};this.open=function(){var k="<div id='damoDialogMain' class='damoDialogMain'></div><div id='damoDialogBottom' class='damoDialogBottom'><div class='damoSubmitBtn'>"+this.editor.DamoMessage.dialog.confirmBtn+"</div> <div class='damoCancelBtn'>"+this.editor.DamoMessage.dialog.cancelBtn+"</div></div>";this.width="400";this.title=this.editor.DamoMessage.buttons.quotation;this.show(k);var j=damoUtil.getElm("damoDialogMain");this.tableWidth=damoMakeUtil.makeColumn(j,this.editor.DamoMessage.table.width+" (%)","80");this.tableHeight=damoMakeUtil.makeColumn(j,this.editor.DamoMessage.table.height+" (px)","1");this.borderColor=damoMakeUtil.makeSelectBox(j,this.editor.DamoMessage.table.borderColor,damoSelectBoxLineColor4Dialog,this.editor);this.bgColor=damoMakeUtil.makeSelectBox(j,this.editor.DamoMessage.documentBG.bgCollor,damoSelectBoxLineColor4Dialog,this.editor);this.borderColor.selectedItemEvent("#000000");this.bgColor.selectedItemEvent("#FFFFFF");damoUtil.createElement("hr",j);for(var a=0;a<b.length;a++){var h=damoUtil.createElement("div",j,"controlColumn");var g=damoUtil.createElement("div",h,"qutationItem");g.innerHTML="<blockquote style='height:10px;"+b[a]+"'/>";damoUtil.addEvent(g,"click",this.templiteClick.closure(this,a+1))}};this.templiteClick=function(a){var f=b[a-1];f=f.replace(/#8c8b8b/gi,this.borderColor.selectedValue);f=f.replace(/#fff/gi,this.bgColor.selectedValue);f=f.replace(/1px/,this.tableHeight.value+C_PX);var e=damoUtil.createElement("blockquote");e.innerHTML="<p>"+damoUtil.getBlankChar()+"</p>";e.style.cssText=f;damoUtil.setStyle(e,{width:this.tableWidth.value+"%",padding:"10px"});this.linkRange.deleteContents();this.linkRange.insertNode(e);this.undoRecord(e);damoUtil.setSelection2(this.selection,this.linkRange,e.firstChild.firstChild);this.close()};this.submitEvent=function(){var a=damoUtil.createElement("blockquote");a.innerHTML="<p>"+damoUtil.getBlankChar()+"</p>";damoUtil.setStyle(a,{width:this.tableWidth.value+"%",border:this.tableHeight.value+C_PX+" solid "+this.borderColor.selectedValue,"background-color":this.bgColor.selectedValue,padding:"10px"});this.linkRange.deleteContents();this.linkRange.insertNode(a);this.undoRecord(a);damoUtil.setSelection2(this.selection,this.linkRange,a.firstChild.firstChild);return true}}DamoDialogQuotation.prototype=new DamoDialog();function damoDialogPrivacy(){this.violateList=[];this.pidList=null;this.init=function(b){this.initialize(b);return this};this.open=function(){var h="<div id='damoDialogMain' class='damoDialogMain'><div>"+this.editor.DamoMessage.privacy.desc+"</div><br/>  <ul id='damoListView' style='height:200px; width: 100%; display:inline-block' class='damoListView'></ul></div><div id='damoDialogBottom' class='damoDialogBottom'><div class='damoSubmitBtn'>"+this.editor.DamoMessage.privacy.deleteBtn+"</div><div class='damoCancelBtn'>"+this.editor.DamoMessage.dialog.closeBtn+"</div></div>";this.width="340";this.title=this.editor.DamoMessage.buttons.privacy;this.show(h);this.damoListView=damoUtil.getElm("damoListView");var e=this.editor.editor.innerText;var g=this.chkPrivacy(this.editor.DamoMessage.privacy.pid,e,editorConfig.privacy.pid);if(g){this.pidList=g.toString()}this.chkPrivacy(this.editor.DamoMessage.privacy.tel,e,editorConfig.privacy.tel);this.pidList=null;this.chkPrivacy(this.editor.DamoMessage.privacy.email,e,editorConfig.privacy.mail);if(this.violateList.length===0){var f=document.createElement("li");f.innerHTML="<p>"+this.editor.DamoMessage.privacy.noPrivacy+"</p>";this.damoListView.appendChild(f)}};this.chkPrivacy=function(g,k,f){var j=k.match(f);if(!j){return}this.violateList.push(j);var h=this;j.forEach(function(a){if(h.pidList!==null&&h.pidList.indexOf(a)>-1){return}var b=document.createElement("li");b.innerHTML='<p class="p1">'+a+'</p><p class="p2">'+g+"</p>";h.damoListView.appendChild(b)});return j};this.submitEvent=function(){if(this.violateList.length===0){return true}if(!confirm(this.editor.DamoMessage.privacy.removeAll)){return}damoUtil.removeFromPrivacy(this.editor.editor,this.violateList);return true}}damoDialogPrivacy.prototype=new DamoDialog();function damoDialogAccessibility(){this.init=function(b){this.initialize(b);return this};this.open=function(){var d="<div id='damoDialogMain' class='damoDialogMain'>  <ul id='damoListView' style='height:150px; width: 100%; display:inline-block' class='damoListView'></ul>  <div class='damoInputPn' id='damoInputPn'>  	<p id='damoGuide' style='margin: 0px;'>테스트</p>  	<div>  		<p id='damoTitle' class='damoTitle'>제목</p><input id='damoInputTx1' type='text' class='input'/>   		<label id='damoAltChkPn'><input type='checkbox'> 미입력 </label>  	</div>  	<div id='damoSubPn'>  		<p class='damoTitle'>"+this.editor.DamoMessage.accessibility.tableSummary+"</p><input id='damoInputTx2' type='text' class='input' style='width: 200px;'/>   	</div>  	<div style='margin-top: 10px;float: right'><button id='damoFixBtn'>"+this.editor.DamoMessage.accessibility.fix+"</button></div>  </div></div><div id='damoDialogBottom' class='damoDialogBottom'><div class='damoSubmitBtn'>"+this.editor.DamoMessage.dialog.closeBtn+"</div></div>";this.width="450";this.title=this.editor.DamoMessage.buttons.accessibility;this.show(d);var c=document.getElementById("damoFixBtn");damoUtil.addEvent(c,"click",this.fixClick.closureListener(this));this.activeNode=null;this.check()};this.check=function(){this.violateList=[];var z=0;var t=this.editor.editor.querySelectorAll("input[type=image], img, area");for(z=0;z<t.length;z++){if(t[z].getAttribute("alt")===null){this.violateList.push({type:1,item:t[z]})}}var A=["a","frame","iframe","framese"];var B=this.editor.editor.querySelectorAll("a, frame, iframe, framese");for(z=0;z<B.length;z++){if(!B[z].title){this.violateList.push({type:2,item:B[z]})}}B=document.querySelectorAll("*");for(z=0;z<B.length;z++){var q=B[z];if(typeof q.onfocus==="function"){this.violateList.push({type:3,item:q})}}var r=this.editor.editor.querySelectorAll("table");for(z=0;z<r.length;z++){var q=r[z];if(!q.summary||!q.caption){this.violateList.push({type:4,item:q})}}var y=[];var C=this.editor.editor.querySelectorAll('*[id]:not([id=""])');for(z=0;z<C.length;z++){var q=C[z];if(y.includes(q.id)){this.violateList.push({type:5,item:q})}else{y.push(q.id)}}var u=document.getElementById("damoListView");u.innerHTML="";const p=this.editor.DamoMessage.accessibility;if(this.violateList.length===0){var s=document.createElement("li");s.innerHTML="<p>"+p.noResult+"</p>";u.appendChild(s);return}var D=["",p.msgErr1,p.msgErr2,p.msgErr3,p.msgErr4,p.msgErr5];var v=["",p.msgTitle1,p.msgTitle2,p.msgTitle3,p.msgTitle4,p.msgTitle5];var w=this;this.violateList.forEach(function(b,c){var a=D[b.type];if(b.type===2&b.item.tagName==="A"){a=p.msgErrLink}var d=document.createElement("li");d.id=c;d.innerHTML='<p class="p1">'+a+'</p><p class="p2">'+b.item.tagName+"</p>";u.appendChild(d);b.li=d;d.addEventListener("click",function(){if(w.activeNode){w.activeNode.li.classList.remove("active");w.activeNode.item.classList.remove("damoSelected")}w.activeNode=b;b.li.classList.add("active");b.item.classList.add("damoSelected");w.editor.editor.scrollTop=b.item.offsetTop-w.editor.editor.offsetTop;var h=b.item.tagName;var f=document.getElementById("damoInputPn");var g=document.getElementById("damoGuide");var j=document.getElementById("damoTitle");var m=document.getElementById("damoAltChkPn");var k=document.getElementById("damoInputTx1");var l=document.getElementById("damoInputTx2");var e=document.getElementById("damoSubPn");g.innerHTML=h+" : "+a;f.style.display="inline-block";k.style.display="inline-block";e.style.display="none";m.style.display="none";j.innerText=v[b.type];k.value="";l.value="";m.firstChild.checked=false;if(b.type===1&&h==="IMG"){m.style.display="inline-block";m.innerHTML="<input type='checkbox' class='input'/>"+p.msgNoInput}else{if(b.type===4){e.style.display="inline-block";m.style.display="inline-block";m.innerHTML="<input type='checkbox' class='input'/>"+p.msgPrint}else{if(b.type===3){m.style.display="none";k.style.display="none"}}}})})};this.fixClick=function(){if(!this.activeNode){return}var h=document.getElementById("damoInputTx1");var l=h.value;if(!l){alert(this.editor.DamoMessage.accessibility.msgInput1);h.focus();return}var k=document.getElementById("damoInputTx2");var n=k.value;if(this.activeNode.type===4&&!n){alert(this.editor.DamoMessage.accessibility.msgInput2);k.focus();return}this.activeNode.item.classList.remove("damoSelected");var j=this.activeNode.item.tagName;var m=document.getElementById("damoAltChkPn").firstChild;if(this.activeNode.type===1&&j==="IMG"&&m.checked){l=""}if(this.activeNode.type===2){this.activeNode.item.title=l}else{if(this.activeNode.type===3){this.activeNode.item.removeAttribute("onfocus")}else{if(this.activeNode.type===4){this.activeNode.item.summary=n;if(!this.activeNode.item.caption){this.activeNode.item.createCaption()}this.activeNode.item.caption.innerHTML=l;if(!m.checked){this.activeNode.item.caption.style.display="none"}}else{if(this.activeNode.type===5){this.activeNode.item.id=l}else{this.activeNode.item.alt=l}}}}this.activeNode.li.remove();this.activeNode=null;var o=document.getElementById("damoInputPn");o.style.display="none"};this.submitEvent=function(){if(this.activeNode){this.activeNode.item.classList.remove("damoSelected")}return true}}damoDialogAccessibility.prototype=new DamoDialog();
var UndoStack=function(b){this.commands=[];this.stackPosition=-1;this.undoManager=b};UndoStack.prototype.execute=function(b){this._clearRedo();if(this.commands.length===200){this.commands.splice(0,1);this.stackPosition=198}b.execute();this.commands.push(b);this.stackPosition++;this.changed(this.undoManager)};function restoreRangePosition(o,p){p.focus();if(!o){return}var n=damoUtil.getSelection(),q=n.getRangeAt(0);var k,l,m=p,j=p;l=o.sC;k=l.length;while(k--&&m){m=m.childNodes[l[k]]}l=o.eC;k=l.length;while(k--&&m){j=j.childNodes[l[k]]}if(j.nodeType!==3){return}q.setStart(m,o.sO);q.setEnd(j,o.eO);n.removeAllRanges();n.addRange(q)}UndoStack.prototype.undo=function(d){var f=this.commands[this.stackPosition].oldValue;this.commands[this.stackPosition--].undo();this.changed(this.undoManager);if(this.stackPosition>-1){var e=this.commands[this.stackPosition].rangeInfo;restoreRangePosition(e,this.undoManager.editor.editor);this.undoManager.editor.activateButton()}return f};UndoStack.prototype.canUndo=function(){return this.stackPosition>=0};UndoStack.prototype.redo=function(){this.commands[++this.stackPosition].redo();var b=this.commands[this.stackPosition].rangeInfo;restoreRangePosition(b,this.undoManager.editor.editor);this.undoManager.editor.activateButton();this.changed(this.undoManager);return this.commands[this.stackPosition].newValue};UndoStack.prototype.canRedo=function(){return this.stackPosition<this.commands.length-1};UndoStack.prototype._clearRedo=function(){this.commands=this.commands.slice(0,this.stackPosition+1)};UndoStack.prototype.clearUndo=function(){this.commands=[];this.stackPosition=-1;this.changed(this.undoManager)};UndoStack.prototype.changed=function(b){};function getNodeIndex(c){var d=0;while(c=c.previousSibling){d++}return d}function saveRangePosition(l){var m=damoUtil.getRange();if(!m){return null}var k=m.startContainer,g=m.endContainer;var h=[];while(k&&k!==l){h.push(getNodeIndex(k));k=k.parentNode}var j=[];while(g&&g!==l){j.push(getNodeIndex(g));g=g.parentNode}return{sC:h,sO:m.startOffset,eC:j,eO:m.endOffset}}var EditCommand=function(d,e,f){this.editor=d;this.oldValue=e.replace(/damoSelectedCell/gi,"");this.newValue=f.replace(/damoSelectedCell/gi,"");this.rangeInfo=saveRangePosition(d)};EditCommand.prototype.execute=function(){};EditCommand.prototype.undo=function(){this.editor.innerHTML=this.oldValue};EditCommand.prototype.redo=function(){this.editor.innerHTML=this.newValue};var UndoManager=function(d,f,e){this.timer=null;this.isPressShortcuts=false;this.editor=e;this.undoBtn=d;this.redoBtn=f;this.stack=new UndoStack(this);this.stack.changed=this.changed;this.stack.changed(this);this.startValue=e.editor.innerHTML;if(d){damoUtil.addEvent(d.button,"click",this.undo_click.closure(this))}if(f){damoUtil.addEvent(f.button,"click",this.redo_click.closure(this))}damoUtil.addEvent(this.editor.editor,"keyup",this.editor_keyup.closureListener(this));damoUtil.addEvent(this.editor.editor,"keydown",this.editor_keydown.closureListener(this))};UndoManager.prototype.clearUndo=function(b){this.stack.clearUndo();this.startValue=b};UndoManager.prototype.changed=function(b){if(b.undoBtn){b.editor.buttonDisable(b.undoBtn,!b.stack.canUndo())}if(b.redoBtn){b.editor.buttonDisable(b.redoBtn,!b.stack.canRedo())}};UndoManager.prototype.undo_click=function(){this.startValue=this.stack.undo(this.editor)};UndoManager.prototype.redo_click=function(){this.stack.redo()};UndoManager.prototype.editor_keyup=function(b){if(this.isPressShortcuts){if(b.ctrlKey&&b.keyCode===86){this.record();return true}if(b.keyCode===17||b.ctrlKey||b.keyCode>86){return false}this.isPressShortcuts=false}clearTimeout(this.timer);this.timer=setTimeout(this.autoRecord.closure(this),300)};UndoManager.prototype.editor_keydown=function(b){if(b.ctrlKey){this.isPressShortcuts=true;switch(b.keyCode){case 89:b.preventDefault();if(this.stack.canRedo()){this.startValue=this.stack.redo()}break;case 90:b.preventDefault();if(this.stack.canUndo()){this.startValue=this.stack.undo(this.editor)}break}}};UndoManager.prototype.autoRecord=function(){var b=this.editor.editor.innerHTML;if(b!=this.startValue){this.stack.execute(new EditCommand(this.editor.editor,this.startValue,b));this.startValue=b}};UndoManager.prototype.record=function(){this.editor.focus();var b=this.editor.editor.innerHTML;this.stack.execute(new EditCommand(this.editor.editor,this.startValue,b));this.startValue=b};
function TableEditor(){this.editor=null;this.tableCells=[];this.selectList=[];this.selectArea={};this.sCellPos={};this.selectingCell=false;this.startTD=null;this.selectedTable=null;var b=damoUtil.getIEVersion();this.useRibbon=b<1||b>11;damoUtil.addEvent(document.body,"mousemove",this.mousemove.closureListener(this));damoUtil.addEvent(document.body,"mousedown",this.mousedown.closureListener(this));damoUtil.addEvent(document.body,"mouseup",this.mouseup.closureListener(this));this.mouseMoveAction=0;this.tableResize={position:0,type:0,table:null};this.gripper=damoUtil.createElement("div",document.body);damoUtil.addClass(this.gripper,"gripper");damoUtil.addEvent(this.gripper,"mousedown",this.gripperMousedown.closureListener(this));damoUtil.addEvent(this.gripper,"dragover",damoUtil.preventDefault);damoUtil.addEvent(this.gripper,"drop",damoUtil.preventDefault);if(!this.ribbonMgr){this.ribbonMgr=new DamoRibbon(this);damoUtil.addEvent(document.body,"mousemove",this.ribbonMgr.mousemove.closureListener(this.ribbonMgr));damoUtil.addEvent(document.body,"mouseup",this.ribbonMgr.mouseup.closureListener(this.ribbonMgr))}}TableEditor.prototype.scrollEvent=function(b){if(this.ribbonMgr.isRibbonActivate){this.ribbonMgr.setRibbon()}};TableEditor.prototype.undoRecord=function(c){if(!c){c=this.selectedTable}var d=damoEditors.findDamoEditorInPath(c);d.focus();d.undoRecord()};TableEditor.prototype.mousedown=function(b){if(b.button===0&&this.useRibbon){if(b.target.nodeName==="IMG"){this.editor=damoEditors.findDamoEditorInPath(b.target);if(!this.editor){return}this.selectedImage=b.target;this.ribbonMgr.setRibbon(this.selectedImage);return}else{if(this.ribbonMgr.isRibbon(b.target)){return}}}if(this.ribbonMgr.isRibbonActivate){this.ribbonMgr.deActivate()}if(b.target.className==="damoContextMenuItemBody"){return}this.startTD=rangeUtil.findTagInPath(b.target,"TD");if(!this.startTD){if(b.target.className.indexOf&&b.target.className.indexOf("damoContextMenuItem")===-1){this.unmarkSelectCell();this.selectList=[]}return}this.editor=damoEditors.findDamoEditorInPath(this.startTD);if(!this.editor){return}this.selectedTable=rangeUtil.findTagInPath(this.startTD,"TABLE");this.setTableCells();if(b.which===3){b.preventDefault();return}this.unmarkSelectCell();this.selectList=[this.startTD];this.selectingCell=true;this.sCellPos=this.getCellPosition(this.startTD)};TableEditor.prototype.mousemove=function(d){if(this.ribbonMgr.isResizing){return}if(!this.selectingCell){this.mousemove4CellResizing(d);return}this.unmarkSelectCell();var e=rangeUtil.findTagInPath(d.target,"TD");if(!e||e===this.startTD){return}damoUtil.getSelection().removeAllRanges();var f=this.getCellPosition(e);if(!f){return}this.selectArea={x1:Math.min(this.sCellPos.x,this.sCellPos.x_span,f.x,f.x_span),y1:Math.min(this.sCellPos.y,this.sCellPos.y_span,f.y,f.y_span),x2:Math.max(this.sCellPos.x,this.sCellPos.x_span,f.x,f.x_span),y2:Math.max(this.sCellPos.y,this.sCellPos.y_span,f.y,f.y_span)};this.selectArea=this.searchSelectArea(this.selectArea);this.selectCell(this.selectArea);this.markSelectCell()};TableEditor.prototype.mouseup=function(b){if(b.button!==0||b.target.className==="damoContextMenuItemBody"){return}if(this.tableResize.type>0){if(this.tableResize.type===1){this.resizeTableColumnWidth(this.tableResize.targetCell,b.pageX-this.tableResize.position)}else{this.resizeTableRowHeight(this.tableResize.targetCell,b.pageY-this.tableResize.position)}this.tableResize.type=0;damoUtil.removeClass(this.gripper,"gripperShow");return}if(!this.selectingCell){return}this.selectingCell=false;if(this.selectList.length<2){this.selectArea={};if(this.editor){this.editor.buttonsDisable(false)}}else{this.editor.buttonsDisable(false,"image,link,table,sChar")}};TableEditor.prototype.getStyleI=function(f,d){var e=this.getAttributeI(f,d);if(e>1){return e}if(f.style[d]){return parseInt(f.style[d])}return parseInt(damoUtil.getStyle(f,d))};TableEditor.prototype.setTableCells=function(){var q=this.selectedTable.rows[0],t=0,v=0;for(var w=0;w<q.cells.length;w++){t+=this.getAttributeI(q.cells[w],"colSpan")}this.tableCells=[t];v=this.selectedTable.rows.length;for(var w=0;w<t;w++){this.tableCells[w]=new Array(v)}for(var p=0;p<v;p++){q=this.selectedTable.rows[p];if(!q){continue}var o=-1,n=0;var y=q.cells[n];while(y){o++;if(!this.tableCells[o]){break}if(this.tableCells[o][p]){continue}var u=this.getAttributeI(y,"colSpan");var r=this.getAttributeI(y,"rowSpan");for(var s=0;s<r;s++){for(var z=0;z<u;z++){this.tableCells[o+z][p+s]=y}}y=q.cells[++n]}}};TableEditor.prototype.getCellSpan=function(f){var e=parseInt(f.getAttribute("colSpan"))-1||0;var d=parseInt(f.getAttribute("rowSpan"))-1||0;if(d<0){d=0}return{col:e,row:d}};TableEditor.prototype.getCellPosition=function(h){for(var g=0;g<this.tableCells.length;g++){for(var j=0;j<this.tableCells[g].length;j++){if(this.tableCells[g][j]===h){var k=this.getAttributeI(h,"colSpan");var f=this.getAttributeI(h,"rowSpan");return{x:g,y:j,x_span:g+k-1,y_span:j+f-1}}}}return{x:0,y:0,x_span:0,y_span:0}};TableEditor.prototype.markSelectCell=function(){for(var b=0;b<this.selectList.length;b++){damoUtil.addClass(this.selectList[b],"damoSelectedCell")}};TableEditor.prototype.unmarkSelectCell=function(){for(var b=0;b<this.selectList.length;b++){damoUtil.removeClass(this.selectList[b],"damoSelectedCell")}};TableEditor.prototype.selectCell=function(h){this.selectList=[];for(var f=h.x1;f<=h.x2;f++){for(var g=h.y1;g<=h.y2;g++){var e=this.tableCells[f][g];if(this.selectList.indexOf(e)===-1){this.selectList.push(e)}}}};TableEditor.prototype.searchSelectArea=function(v){var t=v.x1,u=v.y1,E=0,q=0;for(var s=v.x1;s<=v.x2;s++){for(var w=v.y1;w<=v.y2;w++){var D=this.tableCells[s][w];var r=this.getCellSpan(D);var B=-1,C=1,F=-1,z=1;for(var A=s;A>=s-r.col;A--){if(!this.tableCells[A]||D!==this.tableCells[A][w]){break}C--}for(var A=s;A<=s+r.col;A++){if(!this.tableCells[A]||D!==this.tableCells[A][w]){break}B++}for(var A=w;A>=w-r.row;A--){if(!this.tableCells[s][A]||D!==this.tableCells[s][A]){break}z--}for(var A=w;A<=w+r.row;A++){if(!this.tableCells[s][A]||D!==this.tableCells[s][A]){break}F++}if(t>s+C){t=s+C}if(E<s+B){E=s+B}if(u>w+z){u=w+z}if(q<w+F){q=w+F}}}var y={x1:t,y1:u,x2:E,y2:q};if(v.x1===t&v.y1===u&v.x2===E&v.y2===q){return y}else{return this.searchSelectArea(y)}};TableEditor.prototype.searchSelectMinMax=function(){var h=9999,j=9999,m=0,n=0;for(var o=0;o<this.selectList.length;o++){var k=this.selectList[o];var l=this.getCellPosition(k);h=Math.min(h,l.x);m=Math.max(m,l.x,l.x_span);j=Math.min(j,l.y);n=Math.max(n,l.y,l.y_span)}return{x1:h,y1:j,x2:m,y2:n}};TableEditor.prototype.cellMerge=function(){if(this.selectList.length<2){return}var n=this.selectList[0];this.selectArea=this.searchSelectMinMax();var h=0,o=0,l;for(var j=this.selectArea.x1;j<=this.selectArea.x2;j++){var k=this.tableCells[j][this.selectArea.y1];if(k===l){continue}h+=this.getStyleI(k,"width");l=k}for(var j=this.selectArea.y1;j<=this.selectArea.y2;){o+=this.getStyleI(this.tableCells[this.selectArea.x1][j],"height");j+=this.getAttributeI(this.tableCells[this.selectArea.x1][j],"rowspan")}for(var j=1;j<this.selectList.length;j++){this.selectList[j].parentNode.removeChild(this.selectList[j])}var m=this.selectArea.y2-this.selectArea.y1+1;n.setAttribute("rowspan",m);n.setAttribute("colspan",this.selectArea.x2-this.selectArea.x1+1);damoUtil.setStyle(n,{width:h+C_PX,height:o+C_PX});this.selectList=[];this.selectList.push(n);this.rearrangeTR(n.parentNode,m);this.setTableCells();this.undoRecord()};TableEditor.prototype.rearrangeTR=function(h,j){var f=0;for(var g=0;g<h.cells.length;g++){if(this.getAttributeI(h.cells[g],"rowspan")===j){f++}}if(h.cells.length===f){for(var g=0;g<h.cells.length;g++){h.cells[g].removeAttribute("rowspan")}for(var g=h.rowIndex+1;g<h.rowIndex+j;){var k=this.selectedTable.rows[g];if(k.cells.length===0){k.parentNode.removeChild(k)}else{g++}if(g===this.selectedTable.rows.length){break}}}};TableEditor.prototype.splitColumn=function(){if(this.selectList.length===0){return}this.unmarkSelectCell();var y=this.selectList[0];var H=0,r=0;for(var A=0;A<this.selectList.length;A++){var E=this.selectList[A];var z=this.getAttributeI(E,"colSpan");var D=Math.round(z/2);if(z===1){var v=this.getCellPosition(E);for(var w=0;w<this.tableCells[0].length;){var F=this.tableCells[v.x][w];var s=this.getAttributeI(F,"colSpan");F.setAttribute("colSpan",s+1);w+=this.getAttributeI(F,"rowSpan")}E.setAttribute("colSpan",1)}else{E.setAttribute("colSpan",z-D)}var t=this.cloneNode(E);t.setAttribute("colSpan",D);t.setAttribute("rowSpan",this.getAttributeI(E,"rowSpan"));var G=this.getStyleI(E,"width");var B=Math.round(G/2);damoUtil.setStyleNremoveA(E,{width:B+"px"});damoUtil.setStyleNremoveA(t,{width:(G-B)+"px"});E.parentNode.insertBefore(t,E.nextSibling);var C=this.getCellPositionInTable(t);if(H<C.x){H=C.x}if(r<C.y){r=C.y}}this.setTableCells();var u=this.getCellPosition(y);var C=this.getCellPosition(t);this.selectArea=this.searchSelectArea({x1:u.x,y1:u.y,x2:Math.max(C.x,C.x_span),y2:r});this.selectCell(this.selectArea);this.markSelectCell();this.undoRecord()};TableEditor.prototype.sameHeight=function(){this.unmarkSelectCell();var m=0,h=0,j=0;if(this.selectList.length>1){var n=this.searchSelectMinMax();h=this.selectArea.y1;j=this.selectArea.y2}else{j=this.tableCells[0].length-1}for(var l=h;l<=j;){m+=damoUtil.getStyleAI(this.tableCells[0][l],"height");l+=this.getAttributeI(this.tableCells[0][l],"rowspan")}m=Math.round(m/(j-h+1));for(var l=h;l<=j;l++){for(var o=0;o<this.tableCells.length;o++){var k=this.getAttributeI(this.tableCells[o][l],"rowSpan");damoUtil.setStyle(this.tableCells[o][l],{height:(m*k)+C_PX})}}if(this.selectList.length>1){this.markSelectCell()}this.undoRecord()};TableEditor.prototype.sameWidth=function(){this.unmarkSelectCell();var m=0,h=0,j=0;if(this.selectList.length>1){var n=this.searchSelectMinMax();h=this.selectArea.x1;j=this.selectArea.x2}else{j=this.tableCells.length-1}for(var l=h;l<=j;){m+=damoUtil.getStyleAI(this.tableCells[l][0],"width");l+=this.getAttributeI(this.tableCells[l][0],"colspan")}m=Math.round(m/(j-h+1));for(var l=h;l<=j;l++){for(var o=0;o<this.tableCells[l].length;o++){var k=this.getAttributeI(this.tableCells[l][o],"colspan");damoUtil.setStyle(this.tableCells[l][o],{width:(m*k)+C_PX})}}if(this.selectList.length>1){this.markSelectCell()}this.undoRecord()};TableEditor.prototype.getCellPositionInTable=function(h){var g=h.cellIndex;var j=h.parentNode.rowIndex;var k=this.getAttributeI(h,"colSpan");var f=this.getAttributeI(h,"rowSpan");return{x:g,y:j,x_span:g+k-1,y_span:j+f-1}};TableEditor.prototype.getAttributeI=function(c,d){return parseInt(c.getAttribute(d),10)||1};TableEditor.prototype.cloneNode=function(c){var d=c.cloneNode(false);d.innerHTML=damoUtil.getBlankChar();return d};TableEditor.prototype.splitRow=function(){if(this.selectList.length===0){return}this.unmarkSelectCell();var X,O,D,M,R=0,Q;for(var E=0;E<this.selectList.length;E++){O=this.selectList[E];if(this.getAttributeI(O,"rowSpan")>1){continue}X=O.parentNode;M=damoUtil.createElement("tr");X.parentNode.insertBefore(M,X.nextSibling);Q=this.getCellPosition(O);for(var N=0;N<this.tableCells.length;){D=this.tableCells[N][Q.y];T=this.getAttributeI(D,"rowSpan");D.setAttribute("rowSpan",T+1);N+=this.getAttributeI(D,"colSpan")}R++}var j,S,U,W,T,P,K;var B=0,C=0,G,I;for(var E=0;E<this.selectList.length;E++){var O=this.selectList[E];T=this.getAttributeI(O,"rowSpan");S=Math.round(T/2);O.setAttribute("rowSpan",S);j=this.cloneNode(O);j.setAttribute("rowSpan",T-S);K=j;P=this.getAttributeI(O,"colSpan");j.setAttribute("colSpan",P);G=damoUtil.getStyleAI(O,"height");I=Math.round(G/2);damoUtil.setStyleNremoveA(O,{height:I+"px"});damoUtil.setStyle(j,{height:(G-I)+"px"});X=this.selectedTable.rows[O.parentNode.rowIndex+S];var V=X.cells;var J=null;U=this.getCellPosition(O);for(var F=0;F<V.length;F++){D=V[F];W=this.getCellPosition(D);if(U.x<W.x){J=D;break}}X.insertBefore(j,J);var L=this.getCellPositionInTable(j);if(B<U.x){B=U.x}if(C<L.y){C=L.y}}this.setTableCells();var H=this.getCellPosition(this.selectList[0]);if(this.selectArea&&this.selectArea.y2){this.selectArea.y2+=R}else{this.selectArea={x1:H.x,y1:H.y,x2:B,y2:C}}this.selectCell(this.selectArea);this.markSelectCell();this.undoRecord()};TableEditor.prototype.insertColumn=function(n){if(this.selectList.length===0){return}this.selectArea={};this.unmarkSelectCell();var k=this.selectList[0];var q=this.getCellPosition(k);var m=null,l=damoUtil.getStyle(k,"width");for(var p=0;p<this.tableCells[0].length;){var t=this.tableCells[q.x][p];var r=this.getAttributeI(t,"rowSpan");var s=this.getAttributeI(t,"colSpan");if(s>1){var o=this.getCellPosition(t);if(n==="left"&&q.x===o.x){m=this.cloneNode(t);m.setAttribute("rowSpan",r);m.setAttribute("colSpan",1);damoUtil.setStyle(m,{width:l});t.parentNode.insertBefore(m,t)}else{t.setAttribute("colSpan",s+1)}}else{m=this.cloneNode(t);t.parentNode.insertBefore(m,((n==="left")?t:t.nextSibling));m.setAttribute("rowSpan",r);damoUtil.setStyle(m,{width:l})}p+=r}this.undoRecord();this.setTableCells();this.selectList=[];this.selectList.push(k);k.focus()};TableEditor.prototype.insertRow=function(m){if(this.selectList.length===0){return}this.selectArea={};this.unmarkSelectCell();var k=this.selectList[0];var p=this.getAttributeI(k,"rowSpan");if(p>1&&m!=="over"){var o=this.getCellPosition(k);if(o.y+p<this.tableCells[0].length){k=this.tableCells[o.x][o.y+p];m="over"}}var q=k.parentNode;var t=damoUtil.createElement("tr");q.parentNode.insertBefore(t,((m==="over")?q:q.nextSibling));function l(a,d,e){var b=a.cloneNode(d);b.setAttribute("colSpan",e);b.setAttribute("rowSpan",1);var c=damoUtil.getStyle(d,"height");damoUtil.setStyle(b,{height:c});t.insertBefore(b,null)}var o=this.getCellPosition(k);var r,p;for(var n=0;n<this.tableCells.length;){var s=this.tableCells[n][o.y];r=this.getAttributeI(s,"colSpan");p=this.getAttributeI(s,"rowSpan");if(p>1){if(m==="over"&&q.rowIndex===s.parentNode.rowIndex){l(this,s,r)}else{s.setAttribute("rowSpan",p+1)}}else{l(this,s,r)}n+=r}this.undoRecord();this.setTableCells();this.selectList=[];this.selectList.push(k);k.focus()};TableEditor.prototype.deleteRow=function(){if(this.selectList.length===0){return}this.selectArea={};this.unmarkSelectCell();var e=[];for(var f=0;f<this.selectList.length;f++){var g=this.selectList[f].parentNode;if(e.indexOf(g)===-1){e.push(g)}}function h(d){var a=this.getCellPosition(d.cells[0]);var m,n,b=null;for(var p=0;p<this.tableCells.length;p++){var c=this.tableCells[p][a.y];n=this.getAttributeI(c,"rowSpan");if(n>1){b=c;break}}if(b){for(var p=0;p<this.tableCells.length;){var c=this.tableCells[p][a.y];n=this.getAttributeI(c,"rowSpan");m=this.getAttributeI(c,"colSpan");if(n>1){c.setAttribute("rowSpan",n-1);if(d.rowIndex===c.parentNode.rowIndex){var o=null;if(p+m<this.tableCells.length){o=this.tableCells[p+m][a.y+1];if(this.getAttributeI(o,"rowSpan")>1){o=null}}d.nextSibling.insertBefore(c,o)}}else{c.parentNode.removeChild(c)}p+=m}do{if(d.cells.length===0){d.parentNode.removeChild(d);break}}while(d=d.nextSibling)}else{d.parentNode.removeChild(d)}}for(var f=0;f<e.length;f++){h.apply(this,[e[f]])}this.undoRecord();this.setTableCells();this.selectList=[]};TableEditor.prototype.deleteColumn=function(){if(this.selectList.length===0){return}this.selectArea={};this.unmarkSelectCell();var f=[];var j=[];for(var g=0;g<this.selectList.length;g++){var h=this.selectList[g].cellIndex;if(f.indexOf(h)===-1){f.push(h);j.push(this.selectList[g])}}function k(l){var a=this.getCellPosition(l);for(var b=0;b<this.tableCells[0].length;){var c=this.tableCells[a.x][b];var d=this.getAttributeI(c,"colSpan");if(d>1){c.setAttribute("colSpan",d-1)}else{c.parentNode.removeChild(c)}var e=this.getAttributeI(c,"rowSpan");b+=e}}for(var g=0;g<j.length;g++){k.apply(this,[j[g]]);this.setTableCells()}this.undoRecord();this.selectList=[]};TableEditor.prototype.removeTable=function(){var b=this.selectedTable.parentNode;b.removeChild(this.selectedTable);this.undoRecord(b)};var inc=0;TableEditor.prototype.mousemove4CellResizing=function(j){if(this.tableResize.type>0){if(this.tableResize.type===1){damoUtil.setStyle(this.gripper,{left:(j.pageX)+C_PX})}else{damoUtil.setStyle(this.gripper,{top:(j.pageY)+C_PX})}return false}if(j.target.nodeName!=="TD"&&j.target.parentNode.nodeName!=="TD"){return false}var h=j.target;if(j.target.nodeName!=="TD"){if(j.target.offsetTop>5){return false}h=j.target.parentNode}this.mouseMoveAction=0;var f=rangeUtil.findTagInPath(h,"TD");if(!f||f.className.indexOf("tablePacker")>-1){damoUtil.setStyle(this.gripper,{display:"none"});return false}if(!rangeUtil.findTagInPathByClass(f,"editor")){return}this.tableResize.targetCell=f;var k=f.clientWidth+this.getStyleI(f,"border-left-width")+this.getStyleI(f,"border-right-width"),g=f.clientHeight+this.getStyleI(f,"border-top-width")+this.getStyleI(f,"border-bottom-width");if(j.offsetY<=3){if(f.parentNode.rowIndex===0){return false}this.setGriperPositionOfRow(f,j,1)}else{if(g-j.offsetY<=3){this.setGriperPositionOfRow(f,j,2)}else{if(k-j.offsetX<=3){this.setGriperPositionOfColumn(f,j,3)}else{if(j.offsetX<=3){if(f.cellIndex==0){return false}this.setGriperPositionOfColumn(f,j,4)}else{this.hideGripper()}}}}return false};TableEditor.prototype.hideGripper=function(){damoUtil.setStyle(this.gripper,{display:"none",cursor:"default",top:"-1px",height:"1px"})};TableEditor.prototype.getBeforeRow=function(c){this.selectedTable=this.tableResize.table;this.setTableCells();var d=this.getCellPosition(c);return this.tableCells[d.x][d.y-1]};TableEditor.prototype.getBeforeColumn=function(h){var j=this.getCellPosition(h);var g=this.tableCells[j.x-1][j.y];var f=this.getAttributeI(g,"colSpan");if(f===1){return g}var k=this.getBeforeColumnInOther(g,j.x-1,j.y);if(k){return k}return g};TableEditor.prototype.getBeforeColumnInOther=function(j,h,l){var m=null,g=1;for(var k=l+1;k<this.tableCells[0].length;k++){m=this.tableCells[h][k];g=this.getAttributeI(m,"colSpan");if(g===1){return m}}for(var k=l-1;k>=0;k--){m=this.tableCells[h][k];g=this.getAttributeI(m,"colSpan");if(g===1){return m}}return j};TableEditor.prototype.resizeTableColumnWidth=function(s,v){this.selectedTable=this.tableResize.table;this.setTableCells();if(this.mouseMoveAction===4){s=this.getBeforeColumn(s)}var n=this.getCellPosition(s);var u=this.getAttributeI(s,"colSpan");if(u>1){s=this.getBeforeColumnInOther(s,n.x+u-1,n.y);n=this.getCellPosition(s)}var y=(this.getStyleI(s,"width")+v)+C_PX;var m=s.parentNode;var p=s.cellIndex;var q=((p<m.cells.length-1)?(this.getStyleI(m.cells[p+1],"width")-v)+C_PX:null);this.selectedTable.removeAttribute("width");var r=null;if(m.lastElementChild===s){r=this.selectedTable.style.width;if(!r){r=damoUtil.getStyle(this.selectedTable,"width")}}for(var o=0;o<this.tableCells[0].length;){var t=this.tableCells[n.x][o];var w=null;if(n.x<this.tableCells.length-1){w=this.tableCells[n.x+1][o]}if(t!==w){damoUtil.setStyleNremoveA(t,{width:y});if(q&&w){damoUtil.setStyleNremoveA(w,{width:q})}}o+=this.getAttributeI(t,"rowSpan")}if(r){r=parseInt(r)+v;damoUtil.setStyle(this.selectedTable,{width:r+C_PX})}this.hideGripper();this.undoRecord()};TableEditor.prototype.resizeTableRowHeight=function(j,l){if(this.mouseMoveAction===1){j=this.getBeforeRow(j)}var k=j.parentNode;var m=[];for(var g=0;g<k.cells.length;g++){m.push(this.getStyleI(k.cells[g],"height"))}for(var g=0;g<k.cells.length;g++){var h=(m[g]+l)+C_PX;damoUtil.setStyleNremoveA(k.cells[g],{height:h})}this.undoRecord(k)};TableEditor.prototype.setGriperPositionOfColumn=function(j,h,o){this.mouseMoveAction=o;this.editor=damoEditors.findDamoEditorInPath(j);if(!this.editor){return}this.tableResize.table=rangeUtil.findTagInPath(j,"TABLE");var k=3;var l=damoUtil.getStyleI(this.editor.editor,"height");if(damoUtil.detectIE()||!damoUtil.isBootstrap(this.editor.editor)){l+=damoUtil.getStyleI(this.editor.editor,"padding-top")+damoUtil.getStyleI(this.editor.editor,"padding-bottom")}var m=damoUtil.getElementPosition2(this.editor.editor).top;var n=h.clientX-h.offsetX-k;if(this.mouseMoveAction===3){n+=j.clientWidth}damoUtil.setStyle(this.gripper,{width:(k*2)+C_PX,height:l+"px",left:n+C_PX,top:m+C_PX,display:"block",cursor:"col-resize"})};TableEditor.prototype.setGriperPositionOfRow=function(h,g,l){this.mouseMoveAction=l;this.editor=damoEditors.findDamoEditorInPath(h);if(!this.editor){return}this.tableResize.table=rangeUtil.findTagInPath(h,"TABLE");var m=damoUtil.getStyleI(this.editor.editor,"width");if(damoUtil.detectIE()||!damoUtil.isBootstrap(this.editor.editor)){m+=damoUtil.getStyleI(this.editor.editor,"padding-left")+damoUtil.getStyleI(this.editor.editor,"padding-right")}var j=g.clientY+document.documentElement.scrollTop+document.body.scrollTop-this.getStyleI(this.gripper,"height")/2;var k=this.editor.position.left;damoUtil.setStyle(this.gripper,{width:m+C_PX,height:(3*2)+C_PX,left:k+C_PX,top:j+C_PX,display:"block",cursor:"row-resize"})};TableEditor.prototype.gripperMousedown=function(b){if(b.button!==0||this.mouseMoveAction===0){return true}damoUtil.addClass(this.gripper,"gripperShow");if(this.mouseMoveAction>2){this.tableResize.type=1;this.tableResize.position=b.pageX}else{if(this.mouseMoveAction<3){this.tableResize.type=2;this.tableResize.position=b.pageY}}b.preventDefault();return false};TableEditor.prototype.selectTable=function(){this.ribbonMgr.setRibbon(this.selectedTable)};TableEditor.prototype.modifyTable=function(){this.unmarkSelectCell();this.selectList=[];var b=new DamoDialogTable().init(damoEditors.findDamoEditorInPath(this.selectedTable));b.open(this.selectedTable)};TableEditor.prototype.modifyCell=function(){this.unmarkSelectCell();var b=new DamoDialogTableCell().init(damoEditors.findDamoEditorInPath(this.selectedTable));b.open(this)};TableEditor.prototype.resetSelectList=function(b){this.selectList=b;this.markSelectCell()};TableEditor.prototype.damoTableLayout=function(){var b=new DamoDialogTableLayout().init(this.editor);b.open(this.selectedTable)};var damoMenuItems=[{icon:31,command:"addUp",text:"addUp",action:function(b){b.insertRow("over")}},{icon:32,command:"addDown",text:"addDown",action:function(b){b.insertRow("below")}},{icon:40,command:"splitRow",text:"splitRow",action:function(b){b.splitRow()}},{icon:36,command:"delRow",text:"delRow",action:function(b){b.deleteRow()}},{command:"seperate"},{icon:33,command:"addLeft",text:"addLeft",action:function(b){b.insertColumn("left")}},{icon:34,command:"addRight",text:"addRight",action:function(b){b.insertColumn("right")}},{icon:39,command:"splitCol",text:"splitCol",action:function(b){b.splitColumn()}},{icon:35,command:"delColumn",text:"delColumn",action:function(b){b.deleteColumn()}},{command:"seperate"},{icon:57,command:"sameHeight",text:"sameHeight",action:function(b){b.sameHeight()}},{icon:56,command:"sameWidth",text:"sameWidth",action:function(b){b.sameWidth()}},{command:"seperate"},{icon:41,command:"merge",text:"merge",action:function(b){b.cellMerge()}},{icon:43,command:"propCell",text:"propCell",action:function(b){b.modifyCell()}},{command:"seperate"},{icon:42,command:"propTable",text:"propTable",action:function(b){b.modifyTable()}},{command:"ie",text:"selectTable",action:function(b){b.selectTable()}},{icon:37,command:"delTable",text:"delTable",action:function(b){b.removeTable()}},{command:"seperate"},{icon:11,command:"delTable",text:"tableLayout",action:function(b){b.damoTableLayout()}}];var damoImageMenuItems=[{icon:38,command:"delete",text:"delete",action:function(b){b.editor.removeElement()}},{icon:9,command:"property",text:"property",action:damoModifyImage},{icon:49,command:"edit",text:"edit",action:damoEditImage}];function damoEditImage(e,f){var d=f.tableEditor.editor;d.options.onEditImage(d.activeElement)}function damoEditImage4Popup(){if(damoEditors.activeEditor.activeElement.nodeName!=="IMG"){return null}return damoEditors.activeEditor.activeElement}function damoModifyImage(d,c){c.tableEditor.editor.executeClick("image")}function DamoContextMenu(b){this.isshow=false;this.init=function(a){document.oncontextmenu=function(){return true};this.menuItems=null;this.tableEditor=a;this.contextMenu=damoUtil.createElement("div",document.body,"damoContextMenu");this.hide();damoUtil.addEvent(document.body,"mouseup",this.mouseup.closureListener(this))};this.show=function(m,h){var k=damoUtil.getStyleI(this.tableEditor.editor.toolbar,"width");var l=damoUtil.getStyleI(this.contextMenu,"width");if(l+m>k){m-=l}var a=damoUtil.getStyleI(this.contextMenu,"height");if(isNaN(a)){a=428}var j=document.documentElement.scrollTop+document.body.scrollTop;h-=80;if(h<j){h=j+10}else{if(h+a>j+window.innerHeight){h=j+window.innerHeight-10-a}}damoUtil.setStyle(this.contextMenu,{display:"",top:h+"px",left:m+"px"});this.isshow=true};this.hide=function(){damoUtil.setStyle(this.contextMenu,{display:"none"});this.isshow=false};this.itemClick=function(a){this.hide();a(this.targetNode?this.targetNode:this.tableEditor,this)};this.setMenuItem=function(p,k){this.menuItems=p;var l=this.contextMenu;while(l.firstChild){l.removeChild(l.firstChild)}for(var q in p){var o=p[q];if(o.command==="ie"&&!(damoUtil.detectIE()||damoUtil.isChrome)){continue}var n=damoUtil.createElement("div",l);if("seperate"===o.command){damoUtil.addClass(n,"damoContextMenuSeperate");continue}damoUtil.addClass(n,"damoContextMenuItem");damoUtil.addEvent(n,"click",this.itemClick.closure(this,o.action));var m=damoUtil.createElement("div",n,"damoContextMenuItemHead");if(o.icon){damoUtil.setStyle(m,{backgroundPosition:(o.icon*-editorConfig.iconsize)+"px 0px"})}else{damoUtil.setStyle(m,{"background-image":"none"})}var a=damoUtil.createElement("div",n,"damoContextMenuItemBody");a.innerHTML=k[o.text]}}}DamoContextMenu.prototype.mouseup=function(j){if(j.button!==2){if(this.isshow){this.hide()}return}this.tableEditor.editor=damoEditors.findDamoEditorInPath(j.target);if(!this.tableEditor.editor){return}this.targetNode=null;if(j.target.nodeName==="IMG"){var h=damoUtil.getSelection();h.removeAllRanges();var f=damoImageMenuItems.slice();if(!this.tableEditor.editor.options.onEditImage){f.splice(2,1)}this.setMenuItem(f,this.tableEditor.editor.DamoMessage.imageMenu);this.show(j.pageX,j.pageY);return}var g=rangeUtil.findTagInPath(j.target,"TABLE");if(!g){if(this.isshow){this.hide()}return}if(this.tableEditor.selectList.length===0){this.tableEditor.selectList=[rangeUtil.findTagInPath(j.target,"TD")]}else{var k=rangeUtil.findTagInPath(this.tableEditor.selectList[0],"TABLE");if(g!==k){this.tableEditor.unmarkSelectCell();this.tableEditor.selectList=[rangeUtil.findTagInPath(j.target,"TD")]}}this.setMenuItem(damoMenuItems,this.tableEditor.editor.DamoMessage.tableMenu);this.show(j.pageX,j.pageY)};function DamoDialogTableLayout(){this.open=function(d){this.selectedTable=d;var r="<div id='damoDialogMain' class='damoDialogMain'></div><div id='damoDialogBottom' class='damoDialogBottom'><a href='#' class='damoCancelBtn'>"+this.editor.DamoMessage.dialog.closeBtn+"</a></div>";this.width="340";this.title=this.editor.DamoMessage.tableMenu.tableLayout;this.show(r);var b=damoUtil.getElm("damoDialogMain");this.borderColor=damoMakeUtil.makeSelectBox(b,this.editor.DamoMessage.table.borderColor,damoSelectBoxLineColor4Dialog,this.editor);this.bgColor=damoMakeUtil.makeSelectBox(b,this.editor.DamoMessage.table.bgColor,damoSelectBoxLineColor4Dialog,this.editor);this.borderColor.selectedItemEvent("#000000");this.bgColor.selectedItemEvent("#EAEAEA");var a=damoUtil.createElement("table",b,"damoLayoutDialog");for(var s=0;s<4;s++){var e=damoUtil.createElement("tr",a);for(var t=0;t<4;t++){var u=s*4+t;var v=damoUtil.createElement("td",e,null,"click",this.LayoutClick.closureListener(this,u));var c=damoUtil.createElement("span",v,"tableLayoutItem");damoUtil.setStyle(c,{backgroundPosition:(u*-62)+"px 0px"})}}};this.LayoutClick=function(e,s,v){var r=parseInt(v/4);v=v%4;k(this.selectedTable,this.borderColor.selectedValue);var d=this.bgColor.selectedValue;if(v===1){var b=this.selectedTable.rows[0];for(var t=0;t<b.cells.length;t++){b.cells[t].style.backgroundColor=d}}else{if(v>1){var a=this.selectedTable.rows;var c=v===2;for(var t=0;t<a.length;t++){if(c&(t%2)!==1){continue}for(var u=0;u<a[t].cells.length;u++){a[t].cells[u].style.backgroundColor=d}}}}h(this.selectedTable,r)};function h(a,b){if(b===1){f(a.rows[0])}else{if(b===2){f(a.rows[0]);j(a)}else{if(b===3){g(a)}}}}function k(c,a){var b={"border-collapse":"collapse","border-color":a};damoUtil.setStyle(c,b);var p=c.rows;var d={"background-color":"",border:"1px solid "+a};for(var e=0;e<p.length;e++){for(var o=0;o<p[e].cells.length;o++){damoUtil.setStyle(p[e].cells[o],d)}}}function f(a){var b={"border-bottom-width":"3px","border-bottom-style":"solid"};for(var c=0;c<a.cells.length;c++){damoUtil.setStyle(a.cells[c],b)}}function j(c){damoUtil.setStyle(c,{"border-left-width":"0px","border-right-width":"0px"});var a=c.rows;var e={"border-left-width":"0px"};var b={"border-right-width":"0px"};for(var d=0;d<a.length;d++){damoUtil.setStyle(a[d].cells[0],e);damoUtil.setStyle(a[d].cells[a[0].cells.length-1],b)}}function g(b){damoUtil.setStyle(b,{"border-left-width":"0px","border-right-width":"0px"});var a=b.rows;var c={"border-left-width":"0px","border-right-width":"0px"};for(var d=0;d<a.length;d++){for(var e=0;e<a[d].cells.length;e++){damoUtil.setStyle(a[d].cells[e],c)}}}}DamoDialogTableLayout.prototype=new DamoDialogBasic4Table();function DamoRibbon(e){this.tableEditor=e;this.ribbons=[];this.isRibbonActivate=false;var h=["nw-resize","n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize"];for(var f=0;f<h.length;f++){var g=damoUtil.createElement("div",document.body,"damoRibbon","mousedown",this.mousedown.closureListener(this));damoUtil.setStyle(g,{cursor:h[f]});this.ribbons.push(g);damoUtil.addEvent(g,"dragover",damoUtil.preventDefault);damoUtil.addEvent(g,"drop",damoUtil.preventDefault)}this.imageProperty=damoUtil.createElement("div",document.body,"damoImageProperty");this.imageProperty1=damoUtil.createElement("div",this.imageProperty,"damoImagePropertyMenu1","mousedown",this.imagePropertyClick1.closureListener(this));this.imageProperty2=damoUtil.createElement("div",this.imageProperty,"damoImagePropertyMenu2","mousedown",this.imagePropertyClick2.closureListener(this))}DamoRibbon.prototype.imagePropertyClick1=function(b){this.tableEditor.editor.executeClick("image")};DamoRibbon.prototype.imagePropertyClick2=function(c){var d=this.tableEditor.editor;d.options.onEditImage(this.targetElement)};var damoRibbonSize=8;DamoRibbon.prototype.setRibbon=function(f){if(f){this.targetElement=f}if(damoUtil.getStyle(this.targetElement,"width")<50||this.targetElement.width<50){return}var g=this.targetElement.getBoundingClientRect();if(damoUtil.isBootstrap(this.targetElement)&&damoUtil.isChrome){this.borderWidth=0;this.borderHeight=0}else{this.borderWidth=damoUtil.getStyleF(this.targetElement,"border-left-width");if(this.borderWidth<1){this.borderWidth+=damoUtil.getStyleF(this.targetElement,"border-right-width")}this.borderHeight=damoUtil.getStyleF(this.targetElement,"border-top-width");if(this.borderHeight<1){this.borderHeight+=damoUtil.getStyleF(this.targetElement,"border-bottom-width")}}var h=damoUtil.getElementPosition2(this.tableEditor.editor.editor);var k=document.documentElement.scrollTop+document.body.scrollTop;var j=document.documentElement.scrollLeft+document.body.scrollLeft;damoUtil.setStyle(this.ribbons[0],{left:(g.left+j-damoRibbonSize)+C_PX,top:(g.top+k-damoRibbonSize)+C_PX});damoUtil.setStyle(this.ribbons[1],{left:(g.left+j-damoRibbonSize/2+(g.right-g.left)/2)+C_PX,top:(g.top+k-damoRibbonSize)+C_PX});damoUtil.setStyle(this.ribbons[2],{left:(g.right+j)+C_PX,top:(g.top+k-damoRibbonSize)+C_PX});damoUtil.setStyle(this.ribbons[3],{left:(g.right+j)+C_PX,top:(g.top+k-damoRibbonSize/2+(g.bottom-g.top)/2)+C_PX});damoUtil.setStyle(this.ribbons[4],{left:(g.right+j)+C_PX,top:(g.bottom+k)+C_PX});damoUtil.setStyle(this.ribbons[5],{left:(g.left+j-damoRibbonSize/2+(g.right-g.left)/2)+C_PX,top:(g.bottom+k)+C_PX});damoUtil.setStyle(this.ribbons[6],{left:(g.left+j-damoRibbonSize)+C_PX,top:(g.bottom+k)+C_PX});damoUtil.setStyle(this.ribbons[7],{left:(g.left+j-damoRibbonSize)+C_PX,top:(g.top+k-damoRibbonSize/2+(g.bottom-g.top)/2)+C_PX});this.displayRibbon("inline-block");this.isRibbonActivate=true;if(this.targetElement.nodeName==="IMG"&&this.tableEditor.editor.options.onEditImage){damoUtil.setStyle(this.imageProperty,{display:"inline-block",left:(g.left+j+(g.right-g.left)/2-32)+C_PX,top:(g.top+k+(g.bottom-g.top)/2-16)+C_PX})}};DamoRibbon.prototype.isRibbon=function(d){var c=damoUtil.getStyle(d,"cursor");return c.indexOf("resize")>0};DamoRibbon.prototype.hide=function(){this.displayRibbon("none")};DamoRibbon.prototype.deActivate=function(){this.isRibbonActivate=false;this.displayRibbon("none")};DamoRibbon.prototype.displayRibbon=function(c){for(var d=0;d<this.ribbons.length;d++){damoUtil.setStyle(this.ribbons[d],{display:c})}if(this.tableEditor.editor.options.onEditImage){damoUtil.setStyle(this.imageProperty,{display:c})}};DamoRibbon.prototype.mousedown=function(b){this.displayRibbon("none");this.isResizing=true;this.pos={x:event.pageX,y:event.pageY};this.cursor=damoUtil.getStyle(b.target,"cursor");this.clickedRibbon=b.target;damoUtil.setStyle(this.clickedRibbon,{display:"inline-block"});b.preventDefault();return false};DamoRibbon.prototype.mouseup=function(b){if(!this.isResizing){return}this.isResizing=false;if(this.targetElement.nodeName==="TABLE"){this.reCalcTableSize()}this.setRibbon(this.targetElement);this.tableEditor.editor.undoRecord();this.displayRibbon("inline-block")};DamoRibbon.prototype.reCalcTableSize=function(){var j=this.targetElement;var h=j.rows[0];for(var f=0;f<h.cells.length;f++){var k=damoUtil.getStyle(h.cells[f],"width");for(var g=0;g<j.rows.length;g++){damoUtil.setStyle(j.rows[g].cells[f],{width:k})}}};DamoRibbon.prototype.mousemove=function(b){if(this.isResizing){switch(this.cursor){case"s-resize":damoUtil.setStyle(this.clickedRibbon,{top:(b.pageY-3)+C_PX});case"n-resize":damoUtil.setStyle(this.targetElement,{height:(damoUtil.getStyleI(this.targetElement,"height")+b.pageY-this.pos.y+this.borderHeight)+C_PX});break;case"ne-resize":damoUtil.setStyle(this.clickedRibbon,{left:(b.pageX-3)+C_PX});damoUtil.setStyle(this.targetElement,{width:(damoUtil.getStyleI(this.targetElement,"width")+b.pageX-this.pos.x+this.borderWidth)+C_PX,height:(damoUtil.getStyleI(this.targetElement,"height")+b.pageY-this.pos.y+this.borderHeight)+C_PX});break;case"e-resize":damoUtil.setStyle(this.clickedRibbon,{left:(b.pageX-3)+C_PX});case"w-resize":damoUtil.setStyle(this.targetElement,{width:(damoUtil.getStyleI(this.targetElement,"width")+b.pageX-this.pos.x+this.borderWidth)+C_PX});break;case"se-resize":damoUtil.setStyle(this.clickedRibbon,{left:(b.pageX-3)+C_PX,top:(b.pageY-3)+C_PX});case"nw-resize":damoUtil.setStyle(this.targetElement,{width:(damoUtil.getStyleI(this.targetElement,"width")+b.pageX-this.pos.x+this.borderWidth)+C_PX,height:(damoUtil.getStyleI(this.targetElement,"height")+b.pageY-this.pos.y+this.borderHeight)+C_PX});break;case"sw-resize":damoUtil.setStyle(this.clickedRibbon,{top:(b.pageY-3)+C_PX});damoUtil.setStyle(this.targetElement,{width:(damoUtil.getStyleI(this.targetElement,"width")+b.pageX-this.pos.x+this.borderWidth)+C_PX,height:(damoUtil.getStyleI(this.targetElement,"height")+b.pageY-this.pos.y+this.borderHeight)+C_PX});break;default:}this.pos={x:b.pageX,y:b.pageY};return}};
if(!String.fromCodePoint){(function(c){var a=function(i){var j=[],f=0,e="";for(var h=0,d=arguments.length;h!==d;++h){var g=+arguments[h];if(!(g<1114111&&(g>>>0)===g)){throw RangeError("Invalid code point: "+g)}if(g<=65535){f=j.push(g)}else{g-=65536;f=j.push((g>>10)+55296,(g%1024)+56320)}if(f>=16383){e+=c.apply(null,j);j.length=0}}return e+c.apply(null,j)};try{Object.defineProperty(String,"fromCodePoint",{value:a,configurable:true,writable:true})}catch(b){String.fromCodePoint=a}}(String.fromCharCode))};

